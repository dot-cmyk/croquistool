(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{45:function(e,t,n){},53:function(e,t,n){e.exports=n(72)},72:function(e,t,n){"use strict";n.r(t);var a=n(4),i=n.n(a),r=n(46),o=n.n(r),s=n(12),c=n(27),l=(n(60),n(74),n(73),c.a.initializeApp({apiKey:"AIzaSyDH6rySddl7QAoqkwATwz7CgXrPe7LQis8",authDomain:"croquistool.firebaseapp.com",projectId:"croquistool",storageBucket:"croquistool.appspot.com",messagingSenderId:"843301254465",appId:"1:843301254465:web:046d03ff7cf7e8619f9dc0",measurementId:"G-JT9C23VQFT"})),u=c.a.auth(),h=c.a.firestore(),d=(c.a.storage(),n(18)),f=n(28),m=n(16),p=n(0),v=n.n(p),g=n(2),b=n(14),w=n(1),y=n(3),S=n(11),E=n(7),O=n(10),x=n(15),j=n(47),D=n(48),C=n(49),R=Object.freeze({x:0,y:0,untransformedX:0,untransformedY:0}),P=Object.freeze({canvasWidth:0,canvasHeight:0,left:0,top:0,right:0,bottom:0,viewMin:R,viewMax:R}),M=Object.freeze({a:1,b:0,c:0,d:1,e:0,f:0});var T=function(){function e(t){var n=this,a=t.scaleExtents,i=t.documentSize;Object(w.a)(this,e),this._canvas=null,this._view={scale:1,x:0,y:0},this._viewChangeListeners=new Set,this.setScale=function(e){n.setView({scale:e})},this.clampView=function(e){var t=e.scale,a=e.x,i=e.y,r=n.scaleExtents,o=r.min,s=r.max,c=n.documentSize,l=c.width,u=c.height,h=n.canvasRect||P,d=h.left,f=h.top,m=h.right-d,p=h.bottom-f,v=m/2,g=-(l*n._view.scale-m/2),b=p/2,w=-(u*n._view.scale-p/2);return{scale:Math.min(Math.max(t,o),s),x:Math.min(Math.max(a,g),v),y:Math.min(Math.max(i,w),b)}},this.resetView=function(){n.setView({scale:1,x:0,y:0})},this.setView=function(e){var t=n.clampView(Object(m.a)({},n._view,e||{})),a=n._view,i=a.scale,r=a.x,o=a.y;return t.scale===i&&t.x===r&&t.y===o||(n._view=t,n._viewChangeListeners.forEach(function(e){return e&&e(t)})),Object(m.a)({},n._view)},this.scaleAtClientPoint=function(e,t){var a=n.clientPointToViewPoint(t),i=n.clampView(Object(m.a)({},n._view,{scale:n._view.scale+e})),r=n.viewPointToClientPoint(a,i);return i.x=n._view.x-(r.clientX-t.clientX),i.y=n._view.y-(r.clientY-t.clientY),n.setView(i)},this.clientPointToViewPoint=function(e){var t=e.clientX,a=e.clientY,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n._view,r=n.canvasRect||P,o=t-r.left,s=a-r.top;return{x:(o-i.x)/i.scale,y:(s-i.y)/i.scale,relativeClientX:o,relativeClientY:s}},this.viewPointToClientPoint=function(e){var t=e.x,a=e.y,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n._view,r=n.canvasRect||P,o=r.left,s=r.top,c=t*i.scale+i.x,l=a*i.scale+i.y,u=c+o,h=l+s;return{clientX:u,clientY:h,relativeX:c,relativeY:l,x:u,y:h}},this.attachViewChangeListener=function(e){n._viewChangeListeners.add(e)},this._scaleExtents=a,this._documentSize=i}return Object(y.a)(e,[{key:"canvas",get:function(){return this._canvas},set:function(e){this._canvas=e,this.setView()}},{key:"scale",get:function(){return this._view.scale}},{key:"x",get:function(){return this._view.x},set:function(e){this.setView({x:e})}},{key:"y",get:function(){return this._view.y},set:function(e){this.setView({y:e})}},{key:"view",get:function(){return Object(m.a)({},this._view)}},{key:"scaleExtents",get:function(){return Object(m.a)({},this._scaleExtents)},set:function(e){var t=e.min,n=e.max;this._scaleExtents={min:t,max:n},this.setView()}},{key:"documentSize",get:function(){return Object(m.a)({},this._documentSize)},set:function(e){var t=e.width,n=e.height;this._documentSize={width:t,height:n},this.setView()}},{key:"transformMatrix",get:function(){return{a:this._view.scale,b:0,c:0,d:this._view.scale,e:this._view.x,f:this._view.y}}},{key:"canvasBounds",get:function(){if(this._canvas){var e=this._canvas.getBoundingClientRect(),t=e.left,n=e.top,a=e.right,i=e.bottom;return{viewMin:this.clientPointToViewPoint({clientX:t,clientY:n}),viewMax:this.clientPointToViewPoint({clientX:a,clientY:i}),left:t,top:n,right:a,bottom:i,canvasWidth:this._canvas.width,canvasHeight:this._canvas.height}}}},{key:"canvasRect",get:function(){return this.canvas?this.canvas.getBoundingClientRect():void 0}}]),e}();var z=function(e){e.preventDefault()},k=function e(){var t=this;Object(w.a)(this,e),this.handleMouseWheel=function(e,n){var a=n.props,i=a.disabled,r=a.enablePanAndZoom,o=a.mouseZoomFactor;return i?new L:(r&&e.ctrlKey&&(e.preventDefault(),n.coordSystem.scaleAtClientPoint(o*e.deltaY,B(e))),t)},this.handleDrawStart=function(e,t){return t.props.disabled?new L:e.ctrlKey&&t.props.enablePanAndZoom?(new I).handleDrawStart(e,t):(new A).handleDrawStart(e,t)},this.handleDrawMove=function(e,n){if(n.props.disabled)return new L;var a=U(n.coordSystem,e),i=a.x,r=a.y;return n.lazy.update({x:i,y:r}),t},this.handleDrawEnd=function(e,n){return n.props.disabled?new L:t}},L=function e(){var t=this;Object(w.a)(this,e),this.handleMouseWheel=function(e,n){return n.props.disabled?t:(new k).handleMouseWheel(e,n)},this.handleDrawStart=function(e,n){return n.props.disabled?t:(new k).handleDrawStart(e,n)},this.handleDrawMove=function(e,n){return n.props.disabled?t:(new k).handleDrawMove(e,n)},this.handleDrawEnd=function(e,n){return n.props.disabled?t:(new k).handleDrawEnd(e,n)}},I=function e(){var t=this;Object(w.a)(this,e),this.handleMouseWheel=z.bind(this),this.handleDrawStart=function(e,n){return e.preventDefault(),t.dragStart=B(e),t.panStart={x:n.coordSystem.x,y:n.coordSystem.y},t},this.handleDrawMove=function(e,n){e.preventDefault();var a=B(e),i=a.clientX,r=a.clientY,o=i-t.dragStart.clientX,s=r-t.dragStart.clientY;return n.coordSystem.setView({x:t.panStart.x+o,y:t.panStart.y+s}),t},this.handleDrawEnd=function(){return new k}},A=function e(){var t=this;Object(w.a)(this,e),this.handleMouseWheel=z.bind(this),this.handleDrawStart=function(e,n){var a=n.props.enablePanAndZoom;return e.preventDefault(),e.touches&&e.touches.length&&a?a&&e.touches&&e.touches.length>=2?(new W).handleDrawStart(e,n):t.handleDrawMove(e,n):(new V).handleDrawStart(e,n)},this.handleDrawMove=function(e,n){if(e.preventDefault(),e.touches&&e.touches.length>=2)return(new W).handleDrawStart(e,n);var a=B(e);if((t.deferredPoints.push(a),(new Date).valueOf()-t.startTimestamp<250)&&(null===t.startClientPoint&&(t.startClientPoint=a),Math.abs(a.clientX-t.startClientPoint.clientX)+Math.abs(a.clientY-t.startClientPoint.clientY)<10))return t;return t.issueDeferredPoints(n)},this.handleDrawEnd=function(e,n){return t.issueDeferredPoints(n).handleDrawEnd(e,n)},this.issueDeferredPoints=function(e){for(var n=new V,a=0;a<t.deferredPoints.length;a++){var i=t.deferredPoints[a],r=new X(i);n=(0===a?n.handleDrawStart:n.handleDrawMove)(r,e)}return n},this.startClientPoint=null,this.startTimestamp=(new Date).valueOf(),this.deferredPoints=[]},W=function e(){var t=this;Object(w.a)(this,e),this.handleMouseWheel=z.bind(this),this.handleDrawStart=function(e,n){return e.preventDefault(),!e.touches||e.touches.length<2?new k:(t.start=t.getTouchMetrics(e),t.panStart={x:n.coordSystem.x,y:n.coordSystem.y},t.scaleStart=n.coordSystem.scale,t)},this.handleDrawMove=function(e,n){if(e.preventDefault(),!e.touches||e.touches.length<2)return new k;var a=t.recentMetrics=t.getTouchMetrics(e),i=a.centroid,r=a.distance;if(Math.abs(r-t.start.distance)>=10)return new _(t).handleDrawMove(e,n);var o=i.clientX-t.start.centroid.clientX,s=i.clientY-t.start.centroid.clientY;return Math.abs(o)+Math.abs(s)>=10?new Y(t).handleDrawMove(e,n):t},this.handleDrawEnd=function(){return new k},this.getTouchMetrics=function(e){var t=B(e.touches[0]),n=t.clientX,a=t.clientY,i=B(e.touches[1]),r=i.clientX,o=i.clientY,s=r-n,c=o-a;return{t1:{clientX:n,clientY:a},t2:{clientX:r,clientY:o},distance:Math.sqrt(s*s+c*c),centroid:{clientX:(n+r)/2,clientY:(a+o)/2}}}},Y=function e(t){var n=this;Object(w.a)(this,e),this.handleMouseWheel=z.bind(this),this.handleDrawStart=function(){return n},this.handleDrawMove=function(e,t){if(e.preventDefault(),!e.touches||e.touches.length<2)return new k;var a=n.scaleOrPanState,i=a.recentMetrics=a.getTouchMetrics(e),r=i.centroid,o=(i.distance,r.clientX-a.start.centroid.clientX),s=r.clientY-a.start.centroid.clientY;return t.setView({x:a.panStart.x+o,y:a.panStart.y+s}),n},this.handleDrawEnd=function(){return new k},this.scaleOrPanState=t},_=function e(t){var n=this;Object(w.a)(this,e),this.handleMouseWheel=z.bind(this),this.handleDrawStart=function(){return n},this.handleDrawMove=function(e,t){if(e.preventDefault(),!e.touches||e.touches.length<2)return new k;var a=n.scaleOrPanState,i=a.recentMetrics=a.getTouchMetrics(e),r=i.centroid,o=i.distance,s=a.scaleStart*(o/a.start.distance)-t.coordSystem.scale;return t.coordSystem.scaleAtClientPoint(s,r),n},this.handleDrawEnd=function(){return new k},this.scaleOrPanState=t},V=function e(){var t=this;Object(w.a)(this,e),this.handleMouseWheel=z.bind(this),this.handleDrawStart=function(e,n){if(e.preventDefault(),e.touches&&e.touches.length){var a=U(n.coordSystem,e),i=a.x,r=a.y;n.lazy.update({x:i,y:r},{both:!0})}return t.handleDrawMove(e,n)},this.handleDrawMove=function(e,n){e.preventDefault();var a=U(n.coordSystem,e),i=a.x,r=a.y;n.lazy.update({x:i,y:r});var o=!n.lazy.isEnabled();return t.isDrawing&&!o||(n.points.push(n.clampPointToDocument(n.lazy.brush.toObject())),t.isDrawing=!0),n.points.push(n.clampPointToDocument(n.lazy.brush.toObject())),n.drawPoints({points:n.points,brushColor:n.props.brushColor,brushRadius:n.props.brushRadius}),t},this.handleDrawEnd=function(e,n){return e.preventDefault(),t.handleDrawMove(e,n),n.saveLine(),new k},this.isDrawing=!1},X=function e(t){var n=t.clientX,a=t.clientY;Object(w.a)(this,e),this.preventDefault=function(){},this.clientX=n,this.clientY=a,this.touches=[{clientX:n,clientY:a}]};function B(e){var t=e.clientX,n=e.clientY;return e.changedTouches&&e.changedTouches.length>0&&(t=e.changedTouches[0].clientX,n=e.changedTouches[0].clientY),{clientX:t,clientY:n}}function U(e,t){return e.clientPointToViewPoint(B(t))}var H=!1;try{var F={get passive(){return H=!0,!1}};window.addEventListener("test",F,F),window.removeEventListener("test",F,F)}catch(Ye){H=!1}function q(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return N(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return N(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,i=function(){};return{s:i,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,r=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw r}}}}function N(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function Z(e,t){return{x:e.x+(t.x-e.x)/2,y:e.y+(t.y-e.y)/2}}var G={display:"block",position:"absolute"},J=["grid","drawing","temp","interface"],Q=function(e){function t(e){var n;return Object(w.a)(this,t),(n=Object(S.a)(this,Object(E.a)(t).call(this,e))).undo=function(){var e=[];n.lines.length?e=n.lines.slice(0,-1):n.erasedLines.length&&(e=n.erasedLines.pop()),n.clearExceptErasedLines(),n.simulateDrawingLines({lines:e,immediate:!0}),n.triggerOnChange()},n.eraseAll=function(){n.erasedLines.push(Object(b.a)(n.lines)),n.clearExceptErasedLines(),n.triggerOnChange()},n.clear=function(){n.erasedLines=[],n.clearExceptErasedLines(),n.resetView()},n.resetView=function(){return n.coordSystem.resetView()},n.setView=function(e){return n.coordSystem.setView(e)},n.getSaveData=function(){return JSON.stringify({lines:n.lines,width:n.props.canvasWidth,height:n.props.canvasHeight})},n.getDataURL=function(e,t,a){var i=n.canvas.drawing,r=i.getContext("2d"),o=i.width,s=i.height,c=r.getImageData(0,0,o,s),l=r.globalCompositeOperation;if(r.globalCompositeOperation="destination-over",t){if(!n.props.imgSrc)return"Background image source not set";n.drawImage()}else null!=a&&(r.fillStyle=a,r.fillRect(0,0,o,s));e||(e="png");var u=i.toDataURL("image/".concat(e));return r.clearRect(0,0,o,s),r.putImageData(c,0,0),r.globalCompositeOperation=l,u},n.loadSaveData=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.props.immediateLoading;if("string"!==typeof e)throw new Error("saveData needs to be of type string!");var a=JSON.parse(e),i=a.lines,r=a.width,o=a.height;if(!i||"function"!==typeof i.push)throw new Error("saveData.lines needs to be an array!");if(n.clear(),r===n.props.canvasWidth&&o===n.props.canvasHeight)n.simulateDrawingLines({lines:i,immediate:t});else{var s=n.props.canvasWidth/r,c=n.props.canvasHeight/o,l=(s+c)/2;n.simulateDrawingLines({lines:i.map(function(e){return Object(m.a)({},e,{points:e.points.map(function(e){return{x:e.x*s,y:e.y*c}}),brushRadius:e.brushRadius*l})}),immediate:t})}},n.componentWillUnmount=function(){n.canvasObserver.unobserve(n.canvasContainer),n.canvas.interface&&n.canvas.interface.removeEventListener("wheel",n.handleWheel)},n.handleWheel=function(e){n.interactionSM=n.interactionSM.handleMouseWheel(e,Object(x.a)(Object(x.a)(n)))},n.handleDrawStart=function(e){"all"!=n.props.allowOnlyPointerType&&e.pointerType!=n.props.allowOnlyPointerType||(n.interactionSM=n.interactionSM.handleDrawStart(e,Object(x.a)(Object(x.a)(n))),n.mouseHasMoved=!0)},n.handleDrawMove=function(e){"all"!=n.props.allowOnlyPointerType&&e.pointerType!=n.props.allowOnlyPointerType||(n.interactionSM=n.interactionSM.handleDrawMove(e,Object(x.a)(Object(x.a)(n))),n.mouseHasMoved=!0)},n.handleDrawEnd=function(e){"all"!=n.props.allowOnlyPointerType&&e.pointerType!=n.props.allowOnlyPointerType||(n.interactionSM=n.interactionSM.handleDrawEnd(e,Object(x.a)(Object(x.a)(n))),n.mouseHasMoved=!0)},n.applyView=function(){if(n.ctx.drawing&&(J.map(function(e){return n.ctx[e]}).forEach(function(e){n.clearWindow(e);var t=n.coordSystem.transformMatrix;e.setTransform(t.a,t.b,t.c,t.d,t.e,t.f)}),!n.deferRedrawOnViewChange)){n.drawGrid(n.ctx.grid),n.redrawImage(),n.loop({once:!0});var e=n.lines;n.lines=[],n.simulateDrawingLines({lines:e,immediate:!0})}},n.handleCanvasResize=function(e){var t=n.getSaveData();n.deferRedrawOnViewChange=!0;try{var a,i=q(e);try{for(i.s();!(a=i.n()).done;){var r=a.value.contentRect,o=r.width,s=r.height;n.setCanvasSize(n.canvas.interface,o,s),n.setCanvasSize(n.canvas.drawing,o,s),n.setCanvasSize(n.canvas.temp,o,s),n.setCanvasSize(n.canvas.grid,o,s),n.coordSystem.documentSize={width:o,height:s},n.drawGrid(n.ctx.grid),n.drawImage(),n.loop({once:!0})}}catch(c){i.e(c)}finally{i.f()}n.loadSaveData(t,!0)}finally{n.deferRedrawOnViewChange=!1}},n.clampPointToDocument=function(e){return n.props.clampLinesToDocument?{x:Math.max(Math.min(e.x,n.props.canvasWidth),0),y:Math.max(Math.min(e.y,n.props.canvasHeight),0)}:e},n.redrawImage=function(){n.image&&n.image.complete&&function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.ctx,n=e.img,a=e.x,i=e.y,r=e.w,o=e.h,s=e.offsetX,c=e.offsetY;"number"!==typeof a&&(a=0),"number"!==typeof i&&(i=0),"number"!==typeof r&&(r=t.canvas.width),"number"!==typeof o&&(o=t.canvas.height),"number"!==typeof s&&(s=.5),"number"!==typeof c&&(c=.5),s<0&&(s=0),c<0&&(c=0),s>1&&(s=1),c>1&&(c=1);var l,u,h,d,f=n.width,m=n.height,p=Math.min(r/f,o/m),v=f*p,g=m*p,b=1;v<r&&(b=r/v),Math.abs(b-1)<1e-14&&g<o&&(b=o/g),(l=(f-(h=f/((v*=b)/r)))*s)<0&&(l=0),(u=(m-(d=m/((g*=b)/o)))*c)<0&&(u=0),h>f&&(h=f),d>m&&(d=m),t.drawImage(n,l,u,h,d,a,i,r,o)}({ctx:n.ctx.grid,img:n.image})},n.simulateDrawingLines=function(e){var t=e.lines,a=e.immediate,i=0,r=a?0:n.props.loadTimeOffset;t.forEach(function(e){var t=e.points,o=e.brushColor,s=e.brushRadius;if(a)return n.drawPoints({points:t,brushColor:o,brushRadius:s}),n.points=t,void n.saveLine({brushColor:o,brushRadius:s});for(var c=function(e){i+=r,window.setTimeout(function(){n.drawPoints({points:t.slice(0,e+1),brushColor:o,brushRadius:s})},i)},l=1;l<t.length;l++)c(l);i+=r,window.setTimeout(function(){n.points=t,n.saveLine({brushColor:o,brushRadius:s})},i)})},n.setCanvasSize=function(e,t,n){e.width=t,e.height=n,e.style.width=t,e.style.height=n},n.drawPoints=function(e){var t=e.points,a=e.brushColor,i=e.brushRadius;n.ctx.temp.lineJoin="round",n.ctx.temp.lineCap="round",n.ctx.temp.strokeStyle=a,n.clearWindow(n.ctx.temp),n.ctx.temp.lineWidth=2*i;var r=t[0],o=t[1];n.ctx.temp.moveTo(o.x,o.y),n.ctx.temp.beginPath();for(var s=1,c=t.length;s<c;s++){var l=Z(r,o);n.ctx.temp.quadraticCurveTo(r.x,r.y,l.x,l.y),r=t[s],o=t[s+1]}n.ctx.temp.lineTo(r.x,r.y),n.ctx.temp.stroke()},n.saveLine=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.brushColor,a=e.brushRadius;n.points.length<2||(n.lines.push({points:Object(b.a)(n.points),brushColor:t||n.props.brushColor,brushRadius:a||n.props.brushRadius}),n.points.length=0,n.inClientSpace([n.ctx.drawing,n.ctx.temp],function(){n.ctx.drawing.drawImage(n.canvas.temp,0,0,n.canvas.drawing.width,n.canvas.drawing.height)}),n.clearWindow(n.ctx.temp),n.triggerOnChange())},n.triggerOnChange=function(){n.props.onChange&&n.props.onChange(Object(x.a)(Object(x.a)(n)))},n.clearWindow=function(e){n.inClientSpace([e],function(){return e.clearRect(0,0,e.canvas.width,e.canvas.height)})},n.clearExceptErasedLines=function(){n.lines=[],n.valuesChanged=!0,n.clearWindow(n.ctx.drawing),n.clearWindow(n.ctx.temp)},n.loop=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).once,t=void 0!==e&&e;if(n.mouseHasMoved||n.valuesChanged){var a=n.lazy.getPointerCoordinates(),i=n.lazy.getBrushCoordinates();n.drawInterface(n.ctx.interface,a,i),n.mouseHasMoved=!1,n.valuesChanged=!1}t||window.requestAnimationFrame(function(){n.loop()})},n.inClientSpace=function(e,t){e.forEach(function(e){e.save(),e.setTransform(M.a,M.b,M.c,M.d,M.e,M.f)});try{t()}finally{e.forEach(function(e){return e.restore()})}},n.drawImage=function(){n.props.imgSrc&&(n.image=new Image,n.image.crossOrigin="anonymous",n.image.onload=n.redrawImage,n.image.src=n.props.imgSrc)},n.drawGrid=function(e){if(!n.props.hideGrid){n.clearWindow(e);var t=n.coordSystem.canvasBounds,a=t.viewMin,i=t.viewMax,r=25*Math.floor(a.x/25-1),o=25*Math.floor(a.y/25-1),s=i.x+25,c=i.y+25;if(e.beginPath(),e.setLineDash([5,1]),e.setLineDash([]),e.strokeStyle=n.props.gridColor,e.lineWidth=n.props.gridLineWidth,!n.props.hideGridX){for(var l=r,u=n.props.gridSizeX;l<s;)l+=u,e.moveTo(l,o),e.lineTo(l,c);e.stroke()}if(!n.props.hideGridY){for(var h=o,d=n.props.gridSizeY;h<c;)h+=d,e.moveTo(r,h),e.lineTo(s,h);e.stroke()}}},n.drawInterface=function(e,t,a){n.props.hideInterface||(n.clearWindow(e),e.beginPath(),e.fillStyle=n.props.brushColor,e.arc(a.x,a.y,n.props.brushRadius,0,2*Math.PI,!0),e.fill(),e.beginPath(),e.fillStyle=n.props.catenaryColor,e.arc(t.x,t.y,2,0,2*Math.PI,!0),e.fill(),e.beginPath(),e.fillStyle=n.props.catenaryColor,e.arc(a.x,a.y,1,0,2*Math.PI,!0),e.fill())},n.canvas={},n.ctx={},n.catenary=new D.Catenary,n.points=[],n.lines=[],n.erasedLines=[],n.mouseHasMoved=!0,n.valuesChanged=!0,n.isDrawing=!1,n.isPressing=!1,n.deferRedrawOnViewChange=!1,n.interactionSM=new k,n.coordSystem=new T({scaleExtents:e.zoomExtents,documentSize:{width:e.canvasWidth,height:e.canvasHeight}}),n.coordSystem.attachViewChangeListener(n.applyView.bind(Object(x.a)(Object(x.a)(n)))),n}return Object(O.a)(t,e),Object(y.a)(t,[{key:"componentDidMount",value:function(){var e,t=this;this.lazy=new j.LazyBrush({radius:this.props.lazyRadius*window.devicePixelRatio,enabled:!0,initialPoint:{x:window.innerWidth/2,y:window.innerHeight/2}}),this.chainLength=this.props.lazyRadius*window.devicePixelRatio,this.canvasObserver=new C.a(function(e,n){return t.handleCanvasResize(e,n)}),this.canvasObserver.observe(this.canvasContainer),this.drawImage(),this.loop(),window.setTimeout(function(){var e=window.innerWidth/2,n=window.innerHeight/2;t.lazy.update({x:e-t.chainLength/4,y:n},{both:!0}),t.lazy.update({x:e+t.chainLength/4,y:n},{both:!1}),t.mouseHasMoved=!0,t.valuesChanged=!0,t.clearExceptErasedLines(),t.props.saveData&&t.loadSaveData(t.props.saveData)},100),this.canvas.interface&&this.canvas.interface.addEventListener("wheel",this.handleWheel,H?{passive:e}:e)}},{key:"componentDidUpdate",value:function(e){e.lazyRadius!==this.props.lazyRadius&&(this.chainLength=this.props.lazyRadius*window.devicePixelRatio,this.lazy.setRadius(this.props.lazyRadius*window.devicePixelRatio)),e.saveData!==this.props.saveData&&this.loadSaveData(this.props.saveData),JSON.stringify(e)!==JSON.stringify(this.props)&&(this.valuesChanged=!0),this.coordSystem.scaleExtents=this.props.zoomExtents,this.props.enablePanAndZoom||this.coordSystem.resetView(),e.imgSrc!==this.props.imgSrc&&this.drawImage()}},{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:this.props.className,style:Object(m.a)({display:"block",background:this.props.backgroundColor,touchAction:"none",width:this.props.canvasWidth,height:this.props.canvasHeight},this.props.style),ref:function(t){t&&(e.canvasContainer=t)}},J.map(function(t){var n="interface"===t;return i.a.createElement("canvas",{key:t,ref:function(a){a&&(e.canvas[t]=a,e.ctx[t]=a.getContext("2d"),n&&(e.coordSystem.canvas=a))},style:Object(m.a)({},G),onPointerDown:n?e.handleDrawStart:void 0,onPointerMove:n?e.handleDrawMove:void 0,onPointerUp:n?e.handleDrawEnd:void 0,onPointerOut:n?e.handleDrawEnd:void 0})}))}}]),t}(a.PureComponent);Q.defaultProps={onChange:null,loadTimeOffset:5,lazyRadius:12,allowOnlyPointerType:"pen",brushRadius:10,brushColor:"#444",catenaryColor:"#0a0302",gridColor:"rgba(150,150,150,0.17)",backgroundColor:"#FFF",hideGrid:!1,canvasWidth:400,canvasHeight:400,disabled:!1,imgSrc:"",saveData:"",immediateLoading:!1,hideInterface:!1,gridSizeX:25,gridSizeY:25,gridLineWidth:.5,hideGridX:!1,hideGridY:!1,enablePanAndZoom:!1,mouseZoomFactor:.01,zoomExtents:{min:.33,max:3},clampLinesToDocument:!1};var K=function(e){var t=e.CsubmitObj,n=e.isOwner,r=(e.viewDeleyToggle,Object(a.useState)(!1)),o=Object(s.a)(r,2),c=o[0],l=o[1],u=Object(a.useState)(t.text),d=Object(s.a)(u,2),f=(d[0],d[1],Object(a.useRef)()),m=Object(a.useState)(!0),p=Object(s.a)(m,2),b=(p[0],p[1]),w=new Date(t.createdAt),y=Object(a.useState)(!1),S=Object(s.a)(y,2),E=S[0],O=S[1],x=function(){var e=Object(g.a)(v.a.mark(function e(){return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return b(function(e){return!e}),e.next=3,h.doc("Csubmit/".concat(t.id)).update({heart:1+t.heart});case 3:console.log(t.heart);case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();return i.a.createElement("div",{style:{float:"left",border:"10px solid rgba(0, 0, 0, 0.05)",width:"420px"}},c?i.a.createElement(i.a.Fragment,null,i.a.createElement("div",null,i.a.createElement(Q,{style:{touchAction:"auto"},ref:f,disabled:!0,hideInterface:!0,loadTimeOffset:5})),i.a.createElement("button",{onClick:function(){f.current.clear(),f.current.loadSaveData(t.text)}},"Rewind"),i.a.createElement("button",{onClick:function(){l(!1)}},"Cancel")):i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{style:{margin:"0 auto"}},i.a.createElement("img",{src:t.dataUrl,height:"400px"})),n?i.a.createElement(i.a.Fragment,null,i.a.createElement("button",{onClick:x},"\u2764",t.heart),i.a.createElement("button",{onClick:function(){window.confirm("wanna delete this?")&&h.doc("Csubmit/".concat(t.id)).delete()}},"Delete"),i.a.createElement("button",{onClick:function(){l(!0),setTimeout(function(){f.current.loadSaveData(t.text)},5)}},"Review")):i.a.createElement(i.a.Fragment,null,i.a.createElement("button",{onClick:x},"\u2764 ",t.heart))),i.a.createElement("button",{onClick:function(){O(function(e){return!e})}},"Ref Pin"),"   ","  ",w.toLocaleString(navigator.language||navigator.userLanguage),E?i.a.createElement(i.a.Fragment,null,i.a.createElement("div",null,i.a.createElement("iframe",{src:"https://assets.pinterest.com/ext/embed.html?id="+t.refPinUrl,height:"600",width:"300",frameBorder:0,scrolling:"no"}))):i.a.createElement(i.a.Fragment,null))},$=function(e){var t=e.userObj,n=Object(a.useState)([]),r=Object(s.a)(n,2),o=r[0],c=r[1],l=Object(a.useState)(!1),d=Object(s.a)(l,2),f=(d[0],d[1],Object(a.useState)(!1)),p=Object(s.a)(f,2),v=p[0];p[1];return Object(a.useEffect)(function(){h.collection("Csubmit").where("creatorId","==",t.uid).orderBy("createdAt","desc").onSnapshot(function(e){var t=e.docs.map(function(e){return Object(m.a)({id:e.id},e.data())});c(t)})},[]),i.a.createElement(i.a.Fragment,null,i.a.createElement("span",null,"Profile"),i.a.createElement("button",{onClick:function(){return u.signOut()}},"Log Out"),i.a.createElement("div",null,o.map(function(e){return i.a.createElement(K,{CsubmitObj:e,isOwner:e.creatorId===t.uid,viewsToggle:v})})))},ee=function(){var e=Object(a.useState)(""),t=Object(s.a)(e,2),n=t[0],r=t[1],o=Object(a.useState)(""),c=Object(s.a)(o,2),l=c[0],h=c[1],d=Object(a.useState)(!0),f=Object(s.a)(d,2),m=f[0],p=f[1],b=Object(a.useState)(""),w=Object(s.a)(b,2),y=w[0],S=w[1],E=function(e){var t=e.target,n=t.name,a=t.value;"email"===n?r(a):"password"===n&&h(a)},O=function(){var e=Object(g.a)(v.a.mark(function e(t){var a;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),e.prev=1,!m){e.next=8;break}return e.next=5,u.createUserWithEmailAndPassword(n,l);case 5:a=e.sent,e.next=11;break;case 8:return e.next=10,u.signInWithEmailAndPassword(n,l);case 10:a=e.sent;case 11:console.log(a),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(1),S(e.t0.message);case 17:case"end":return e.stop()}},e,null,[[1,14]])}));return function(t){return e.apply(this,arguments)}}();return i.a.createElement("div",null,i.a.createElement("form",{onSubmit:O},i.a.createElement("input",{name:"email",type:"email",placeholder:"Email",required:!0,value:n,onChange:E}),i.a.createElement("input",{name:"password",type:"password",placeholder:"Password",required:!0,value:l,onChange:E}),i.a.createElement("input",{type:"submit",value:m?"Create Account":"Log In"}),y),i.a.createElement("span",{onClick:function(){return p(function(e){return!e})}},m?"Sign In":"Create Account"),i.a.createElement("div",null,i.a.createElement("button",null,"Continue with Google"),i.a.createElement("button",null,"Continue with Github")))},te=function(e){var t=e.userObj,n=Object(a.useState)(""),r=Object(s.a)(n,2),o=(r[0],r[1]),l=Object(a.useState)([]),u=Object(s.a)(l,2),d=(u[0],u[1],Object(a.useState)([])),f=Object(s.a)(d,2),p=(f[0],f[1],Object(a.useRef)()),v=Object(a.useState)(""),g=Object(s.a)(v,2),b=g[0],w=g[1],y=Object(a.useState)([]),S=Object(s.a)(y,2),E=S[0],O=S[1],x=Object(a.useState)(0),j=Object(s.a)(x,2),D=j[0],C=j[1],R=Object(a.useState)(0),P=Object(s.a)(R,2),M=P[0],T=P[1],z=Object(a.useState)(60),k=Object(s.a)(z,2),L=k[0],I=k[1],A=Object(a.useState)(3),W=Object(s.a)(A,2),Y=W[0],_=(W[1],Object(a.useState)(0)),V=Object(s.a)(_,2),X=V[0],B=V[1],U=Object(a.useState)(0),H=Object(s.a)(U,2),F=H[0],q=H[1],N=Object(a.useRef)(L),Z=Object(a.useRef)(null),G=Object(a.useState)({croquisTimeDB:L,brushRadius:1,lazyRadius:1}),J=Object(s.a)(G,2),K=J[0],$=J[1],ee=Object(a.useState)(!1),te=Object(s.a)(ee,2),ne=te[0],ae=te[1],ie=function(){C(D+1),T(M+1),N.current=L;var e=p.current.getSaveData(),n=p.current.getDataURL();p.current.clear(),h.collection("Csubmit").add({text:e,createdAt:Date.now(),creatorId:t.uid,drawingTime:L-60*X-F,heart:0,dataUrl:n,refPinUrl:E[M]}),o("")};Object(a.useEffect)(function(){return Z.current=setInterval(function(){B(parseInt(N.current/60)),q(N.current%60),N.current-=1},1e3),function(){return clearInterval(Z.current)}},[]),Object(a.useEffect)(function(){N.current<=-1&&ie()},[F]),Object(a.useEffect)(function(){h.doc("RefDB/refStrings").get().then(function(e){if(e.exists){var t=e.data().refUrl.sort(function(){return Math.random()-.5});O(t)}else console.log("No such document!")}).catch(function(e){console.log("Error getting document:",e)}),h.doc("usersetting/"+t.uid).get().then(function(e){e.exists?($({brushRadius:e.data().brushRadius,lazyRadius:e.data().lazyRadius}),I(e.data().croquisTimeDB),console.log(e.data())):console.log("No such setting document!")}).catch(function(e){console.log("Error getting document:",e)})},[]);var re;return i.a.createElement("div",null,i.a.createElement("div",{style:{float:"right"}},ne?i.a.createElement(i.a.Fragment,null,i.a.createElement("form",{onSubmit:function(e){e.preventDefault(),ae(!1)}},i.a.createElement("input",{value:L,onChange:function(e){var t=e.target.value;I(t),$(function(t){return Object(m.a)({},t,{croquisTimeDB:e.target.value})})},type:"number",placeholder:"Input Croquis Time"}),i.a.createElement("input",{type:"submit",value:"Set Time"}))):i.a.createElement(i.a.Fragment,null,function(e){var t=e%10,n=e%100;return 1==t&&11!=n?e+"st":2==t&&12!=n?e+"nd":3==t&&13!=n?e+"rd":e+"th"}(M+1),i.a.createElement("button",{onClick:function(e){ae(!0)}},"Set Croquis Time")),i.a.createElement("button",{onClick:function(e){h.collection("usersetting").doc(t.uid).update({brushRadius:K.brushRadius,lazyRadius:K.lazyRadius,croquisTimeDB:K.croquisTimeDB})}},"Update Setting")),i.a.createElement("div",{style:{position:"absolute",left:"50%",transform:"translateX(-50%)",width:"70px",textAlign:"center",background:"linear-gradient(to left,#FFC365 "+100*(60*X+F)/L+"%,#E8E8E8 "+100*(60*X+F)/L+"%)"}},X," : ",(re=F)<=9?"0"+re:re),i.a.createElement("div",null,i.a.createElement("form",{onSubmit:function(e){if(e.preventDefault(),b.match(",")){var t=h.doc("RefDB/refStrings");b.split(",").forEach(function(e){console.log(e),t.update({refUrl:c.a.firestore.FieldValue.arrayUnion(e)})})}else h.doc("RefDB/refStrings").update({refUrl:c.a.firestore.FieldValue.arrayUnion(b)});w("")}},i.a.createElement("input",{value:b,onChange:function(e){var t=e.target.value;w(t)},type:"text",placeholder:"You Can Upload Pinterst Pin By Url Number"}),i.a.createElement("input",{type:"submit",value:"Upload Pin"}))),i.a.createElement("div",{style:{float:"left"}},i.a.createElement("iframe",{key:D,src:"https://assets.pinterest.com/ext/embed.html?id="+E[M],height:770,width:400,frameBorder:0,scrolling:"no"})),i.a.createElement("div",{style:{float:"left"}},i.a.createElement("div",null,i.a.createElement("div",{style:{float:"right"}},i.a.createElement("label",null,"Lazy-Radius:"),i.a.createElement("input",{type:"number",min:"0",max:"100",style:{width:"30px"},value:K.lazyRadius,onChange:function(e){return $(function(t){return Object(m.a)({},t,{lazyRadius:e.target.value})})}})),i.a.createElement("div",{style:{float:"right"}},i.a.createElement("label",null,"Brush-Radius:"),i.a.createElement("input",{type:"number",min:"1",max:"100",style:{width:"30px"},value:K.brushRadius,onChange:function(e){return $(function(t){return Object(m.a)({},t,{brushRadius:e.target.value})})}})),i.a.createElement("div",{style:{float:"right"}},i.a.createElement("button",{onClick:function(){p.current.clear()}},"Clear Canvas")),i.a.createElement("div",{style:{float:"right"}},i.a.createElement("form",{onSubmit:function(e){e.preventDefault(),ie()}},i.a.createElement("input",{type:"submit",value:"Upload Drawing"})))),i.a.createElement("div",{style:{float:"right"}},i.a.createElement(Q,{canvasWidth:600,canvasHeight:600,brushRadius:K.brushRadius,lazyRadius:K.lazyRadius,ref:p,allowOnlyPointerType:["all","mouse","touch","pen"][Y]}))))},ne=function(){return i.a.createElement("nav",null,i.a.createElement("ul",null,i.a.createElement("li",{style:{display:"inline",borderLeft:"1px solid #999",padding:"0 10px"}},i.a.createElement(f.b,{to:"/"},"Home")),i.a.createElement("li",{style:{display:"inline",borderLeft:"1px solid #999",padding:"0 10px"}},i.a.createElement(f.b,{to:"/profile"},"My Drawings")),i.a.createElement("li",{style:{display:"inline",borderLeft:"1px solid #999",padding:"0 10px"}},i.a.createElement(f.b,{to:"/doProko"},"Do Proko")),i.a.createElement("li",{style:{display:"inline",borderLeft:"1px solid #999",padding:"0 10px"}},i.a.createElement(f.b,{to:"/doSoty"},"Do Soty"))))},ae=function(e){var t=e.userObj,n=Object(a.useState)(""),r=Object(s.a)(n,2),o=(r[0],r[1]),c=Object(a.useState)([]),l=Object(s.a)(c,2),u=(l[0],l[1],Object(a.useState)(0)),d=Object(s.a)(u,2),f=d[0],p=d[1],v=Object(a.useRef)(),g=Object(a.useState)({brushRadius:1,lazyRadius:0}),b=Object(s.a)(g,2),w=b[0],y=b[1],S=Object(a.useState)(0),E=Object(s.a)(S,2),O=E[0],x=E[1],j=Object(a.useState)(["PLtG4P3lq8RHGuMuprDarMz_Y9Fbw_d2ws","PLTY4AtphBe8NS7WFIMIhHIBJVk3xQvi-q","PLTY4AtphBe8PSqfXT4qfxwdbLgSK0XZ9v","PLTY4AtphBe8P3zIOlyr7gEt176af-pp5R","PLtG4P3lq8RHFBeVaruf2JjyQmZJH4__Zv"]),D=Object(s.a)(j,2),C=D[0];D[1];return i.a.createElement("div",null,i.a.createElement("div",{style:{float:"right"}}),i.a.createElement("div",null,i.a.createElement("label",null,"videos:"),i.a.createElement("input",{type:"number",min:"0",max:C.length-1,style:{width:"30px"},value:O,onChange:function(e){x(e.target.value),p(f+1)}})),i.a.createElement("div",{style:{float:"left"}},i.a.createElement("iframe",{key:f,src:"https://www.youtube.com/embed/videoseries?list="+C[O]+"&cc_load_policy=1&cc_lang_pref=ko",height:450,width:450,frameBorder:0,scrolling:"no"})),i.a.createElement("div",{style:{float:"left"}},i.a.createElement("div",null,i.a.createElement("div",{style:{float:"right"}},i.a.createElement("label",null,"Lazy-Radius:"),i.a.createElement("input",{type:"number",min:"0",max:"100",style:{width:"30px"},value:w.lazyRadius,onChange:function(e){return y(function(t){return Object(m.a)({},t,{lazyRadius:e.target.value})})}})),i.a.createElement("div",{style:{float:"right"}},i.a.createElement("label",null,"Brush-Radius:"),i.a.createElement("input",{type:"number",min:"1",max:"100",style:{width:"30px"},value:w.brushRadius,onChange:function(e){return y(function(t){return Object(m.a)({},t,{brushRadius:e.target.value})})}})),i.a.createElement("div",{style:{float:"right"}},i.a.createElement("button",{onClick:function(){v.current.clear()}},"Clear Canvas")),i.a.createElement("div",{style:{float:"right"}},i.a.createElement("form",{onSubmit:function(e){e.preventDefault(),function(){var e=v.current.getSaveData(),n=v.current.getDataURL();v.current.clear(),h.collection("Csubmit").add({text:e,createdAt:Date.now(),creatorId:t.uid,drawingTime:0,heart:0,dataUrl:n,refPinUrl:""}),o("")}()}},i.a.createElement("input",{type:"submit",value:"Upload Drawing"})))),i.a.createElement("div",{style:{float:"right"}},i.a.createElement(Q,{canvasWidth:600,canvasHeight:600,brushRadius:w.brushRadius,lazyRadius:w.lazyRadius,ref:v}))))},ie=n(32),re=n(35),oe=n.n(re),se=(n(45),{position:"absolute",zIndex:1e3}),ce=function(e){e.scale,e.minScale,e.maxScale,e.onZoomInClick,e.onZoomOutClick;return i.a.createElement("div",{style:se})},le={position:"absolute",marginTop:"40px",marginLeft:"5px",backgroundColor:"rgba(0,0,0,0)",zIndex:"1000",color:"white"},ue=function(e){var t=e.top,n=e.left,a=e.scale,r=e.overflow,o=[r.top>0?"top":"",r.right>0?"right":"",r.bottom>0?"bottom":"",r.left>0?"left":""].filter(function(e){return e.length}).join(", ")||"none";return i.a.createElement("div",{style:le},i.a.createElement("div",null,"top: ".concat(t)),i.a.createElement("div",null,"left: ".concat(n)),i.a.createElement("div",null,"scale: ".concat(a)),i.a.createElement("div",null,"overflow: ".concat(o)))},he=function(e,t,n){return Math.abs(t-e)<n?t:e},de=function(e,t,n){return Math.min(t,Math.max(e,n))},fe=function(e){return-1*e},me=function(e,t){var n=e.clientX,a=e.clientY,i=t.getBoundingClientRect();return{x:n-i.left,y:a-i.top}},pe=function(e){var t=Object(s.a)(e,2),n=t[0],a=t[1];return Math.sqrt(Math.pow(n.clientY-a.clientY,2)+Math.pow(n.clientX-a.clientX,2))};var ve=function(e,t){return e===t===void 0||void 0!==e&&void 0!==t&&(e.width===t.width&&e.height===t.height)},ge=function(e){if(void 0!==e)return{width:e.offsetWidth||e.width,height:e.offsetHeight||e.height}},be=function(e,t){return e===t===void 0||void 0!==e&&void 0!==t&&(Se(e.top,5)===Se(t.top,5)&&Se(e.left,5)===Se(t.left,5)&&Se(e.scale,5)===Se(t.scale,5))},we=function(e,t){var n=t||{},a=n.width,i=n.height;return a>0&&i>0?Math.min(e.width/a,e.height/i,1):1},ye=Object(ie.a)(function(e){return e.containerDimensions},function(e){return e.imageDimensions},function(e,t){return t.minScale},function(e,t,n){return"auto"===String(n).toLowerCase()?we(e,t):n||1});function Se(e,t){if(t&&null!==e&&void 0!==e){var n=(String(e)+"e").split("e"),a=Math.round(n[0]+"e"+(+n[1]+t));return+((n=(String(a)+"e").split("e"))[0]+"e"+(+n[1]-t))}return Math.round(e)}var Ee=function(e){return!1!==e.cancelable&&(e.preventDefault(),!0)};function Oe(e,t,n,a){var i=fe(e);return i>0?i:0}function xe(e,t,n,a){var i=fe(e);return i>0?i:0}function je(e,t,n,a){var i=Math.max(0,t*n.width-a.width);return i>0?i-fe(e):0}function De(e,t,n,a){var i=Math.max(0,t*n.height-a.height);return i>0?i-fe(e):0}var Ce=function(e,t,n,a,i){return{top:xe(e),right:je(t,n,a,i),bottom:De(e,n,a,i),left:Oe(t)}},Re=250,Pe=.1,Me=function(e,t,n){return void 0!==n&&void 0!==t&&void 0!==e},Te=Object(ie.a)(function(e){return e.top},function(e){return e.left},function(e){return e.scale},function(e,t,n){var a={cursor:"pointer"};return Me(e,t,n)?Object(m.a)({},a,{transform:"translate3d(".concat(t,"px, ").concat(e,"px, 0) scale(").concat(n,")"),transformOrigin:"0 0"}):a}),ze=Object(ie.a)(function(e){return e.top},function(e){return e.left},function(e){return e.scale},function(e){return e.imageDimensions},function(e){return e.containerDimensions},function(e,t,n,a,i){return Me(e,t,n)?Ce(e,t,n,a,i):""}),ke=Object(ie.a)(ze,function(e){return[e.left||e.right?e.left?e.right?"":"pan-right":"pan-left":"pan-x",e.top||e.bottom?e.top?e.bottom?"":"pan-down":"pan-up":"pan-y"].join(" ").trim()}),Le=function(e){function t(){var e,n;Object(w.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(S.a)(this,(e=Object(E.a)(t)).call.apply(e,[this].concat(r)))).state={},n.handleTouchStart=function(e){n.cancelAnimation();var t=e.touches;2===t.length?(n.lastPinchLength=pe(t),n.lastPanPointerPosition=null):1===t.length&&(n.lastPinchLength=null,n.pointerDown(t[0]),Ee(e))},n.handleTouchMove=function(e){var t=e.touches;if(2===t.length)n.pinchChange(t),Ee(e);else if(1===t.length){var a=n.pan(t[0]);if(!n.controlOverscrollViaCss){var i=ze(n.state),r=a.left&&i.left>0||a.right&&i.right>0,o=a.up&&i.top>0||a.down&&i.bottom>0;if(!r&&!o)return;var s=a.left||a.right,c=a.up||a.down;if(c>2*s&&!o)return;if(s>2*c&&!r)return;Ee(e)}}},n.handleTouchEnd=function(e){if(n.cancelAnimation(),0===e.touches.length&&1===e.changedTouches.length){if(n.lastPointerUpTimeStamp&&n.lastPointerUpTimeStamp+Re>e.timeStamp){var t=me(e.changedTouches[0],n.imageRef.parentNode);n.doubleClick(t)}n.lastPointerUpTimeStamp=e.timeStamp,Ee(e)}n.maybeAdjustCurrentTransform(Pe)},n.handleMouseDown=function(e){n.cancelAnimation(),n.pointerDown(e)},n.handleMouseMove=function(e){if(!e.buttons)return null;n.pan(e)},n.handleMouseDoubleClick=function(e){n.cancelAnimation();var t=me(e,n.imageRef.parentNode);n.doubleClick(t)},n.handleMouseWheel=function(e){n.cancelAnimation();var t=me(e,n.imageRef.parentNode);e.deltaY>0?n.state.scale>ye(n.state,n.props)&&(n.zoomOut(t),Ee(e)):e.deltaY<0&&n.state.scale<n.props.maxScale&&(n.zoomIn(t),Ee(e))},n.handleImageLoad=function(e){n.debug("handleImageLoad"),n.isImageLoaded=!0,n.maybeHandleDimensionsChanged();var t=i.a.Children.only(n.props.children).props.onLoad;"function"===typeof t&&t(e)},n.handleZoomInClick=function(){n.cancelAnimation(),n.zoomIn()},n.handleZoomOutClick=function(){n.cancelAnimation(),n.zoomOut()},n.handleWindowResize=function(){return n.maybeHandleDimensionsChanged()},n.handleRefImage=function(e){n.imageRef&&(n.cancelAnimation(),n.imageRef.removeEventListener("touchmove",n.handleTouchMove)),n.imageRef=e,e&&n.imageRef.addEventListener("touchmove",n.handleTouchMove,{passive:!1}),function(e,t){"function"===typeof e?e(t):e&&(e.current=t)}(i.a.Children.only(n.props.children).ref,e)},n}return Object(O.a)(t,e),Object(y.a)(t,[{key:"pointerDown",value:function(e){this.lastPanPointerPosition=me(e,this.imageRef.parentNode)}},{key:"pan",value:function(e){if(this.isTransformInitialized){if(!this.lastPanPointerPosition)return this.pointerDown(e),0;var t=me(e,this.imageRef.parentNode),n=t.x-this.lastPanPointerPosition.x,a=t.y-this.lastPanPointerPosition.y;this.lastPanPointerPosition=t;var i=this.state.top+a,r=this.state.left+n;return this.constrainAndApplyTransform(i,r,this.state.scale,0,0),{up:a>0?a:0,down:a<0?fe(a):0,right:n<0?fe(n):0,left:n>0?n:0}}}},{key:"doubleClick",value:function(e){"zoom"===String(this.props.doubleTapBehavior).toLowerCase()&&1.05*this.state.scale<this.props.maxScale?this.zoomIn(e,Pe,.3):this.applyInitialTransform(Pe)}},{key:"pinchChange",value:function(e){var t=pe(e),n=function(e){var t=Object(s.a)(e,2),n=t[0],a=t[1];return{x:(n.clientX+a.clientX)/2,y:(n.clientY+a.clientY)/2}}(e),a=this.lastPinchLength?this.state.scale*t/this.lastPinchLength:this.state.scale;this.zoom(a,n,.05),this.lastPinchLength=t}},{key:"zoomIn",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1;e=e||{x:this.state.containerDimensions.width/2,y:this.state.containerDimensions.height/2},this.zoom(this.state.scale*(1+n),e,0,t)}},{key:"zoomOut",value:function(e){e=e||{x:this.state.containerDimensions.width/2,y:this.state.containerDimensions.height/2},this.zoom(.9*this.state.scale,e,0)}},{key:"zoom",value:function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(this.isTransformInitialized){var i=this.state,r=i.scale,o=i.top,s=i.left,c=t.y-o,l=t.x-s,u=this.getConstrainedScale(e,n),h=(u-r)/r,d=o-c*h,f=s-l*h;this.constrainAndApplyTransform(d,f,u,n,a)}}},{key:"maybeHandleDimensionsChanged",value:function(){var e,t=this;if(this.isImageReady){var n={width:(e=this.imageRef).parentNode.offsetWidth,height:e.parentNode.offsetHeight},a=ge(this.imageRef);ve(n,ge(this.state.containerDimensions))&&ve(a,ge(this.state.imageDimensions))||(this.cancelAnimation(),this.setState({containerDimensions:n,imageDimensions:a},function(){t.isTransformInitialized?t.maybeAdjustCurrentTransform():t.applyInitialTransform()}),this.debug("Dimensions changed: Container: ".concat(n.width,", ").concat(n.height,", Image: ").concat(a.width,", ").concat(a.height)))}else this.debug("Image not loaded")}},{key:"constrainAndApplyTransform",value:function(e,t,n,a){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r={top:e,left:t,scale:n};this.debug("Requesting transform: left ".concat(t,", top ").concat(e,", scale ").concat(n));var o=this.getCorrectedTransform(r,a)||r;return this.debug("Applying transform: left ".concat(o.left,", top ").concat(o.top,", scale ").concat(o.scale)),!be(o,this.state)&&(this.applyTransform(o,i),!0)}},{key:"applyTransform",value:function(e,t){var n=this,a=e.top,i=e.left,r=e.scale;if(t>0){this.animation=requestAnimationFrame(function e(){var o=a-n.state.top,s=i-n.state.left,c=r-n.state.scale,l={top:he(n.state.top+t*o,a,1),left:he(n.state.left+t*s,i,1),scale:he(n.state.scale+t*c,r,.001)};be(l,n.state)||n.setState(l,function(){return n.animation=requestAnimationFrame(e)})})}else this.setState({top:a,left:i,scale:r})}},{key:"getConstrainedScale",value:function(e,t){var n=1-t,a=1+t;return de(ye(this.state,this.props)*n,this.props.maxScale*a,e)}},{key:"getCorrectedTransform",value:function(e,t){var n=this.getConstrainedScale(e.scale,t),a=this.calculateNegativeSpace(n),i={width:Math.max(0,fe(a.width)),height:Math.max(0,fe(a.height))},r=this.props,o=r.position,s=r.initialTop,c=r.initialLeft,l=this.state,u=l.imageDimensions,h=l.containerDimensions,d=1+t,f={top:i.height?de(fe(i.height)*d,i.height*d-i.height,e.top):"center"===o?(h.height-u.height*n)/2:s||0,left:i.width?de(fe(i.width)*d,i.width*d-i.width,e.left):"center"===o?(h.width-u.width*n)/2:c||0,scale:n};return be(f,e)?null:f}},{key:"maybeAdjustCurrentTransform",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;(e=this.getCorrectedTransform(this.state,0))&&this.applyTransform(e,t)}},{key:"applyInitialTransform",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=this.state,a=n.imageDimensions,i=n.containerDimensions,r=this.props,o=r.position,s=r.initialScale,c=r.maxScale,l=r.initialTop,u=r.initialLeft,h="auto"===String(s).toLowerCase()?we(i,a):s,d=ye(this.state,this.props);d>c?oe()(!1,"minScale cannot exceed maxScale."):h<d||h>c?oe()(!1,"initialScale must be between minScale and maxScale."):("center"===o?(oe()(void 0===l,"initialTop prop should not be supplied with position=center. It was ignored."),oe()(void 0===u,"initialLeft prop should not be supplied with position=center. It was ignored."),e={top:(i.width-a.width*h)/2,left:(i.height-a.height*h)/2}):e={top:l||0,left:u||0},this.constrainAndApplyTransform(e.top,e.left,h,0,t))}},{key:"render",value:function(){var e=i.a.Children.only(this.props.children),t=this.props,n=t.zoomButtons,a=t.maxScale,r=t.debug,o=this.state.scale,s={width:"100%",height:"100%",overflow:"hidden",touchAction:this.controlOverscrollViaCss?ke(this.state)||"none":void 0};return i.a.createElement("div",{style:s},n&&this.isImageReady&&this.isTransformInitialized&&i.a.createElement(ce,{scale:o,minScale:ye(this.state,this.props),maxScale:a,onZoomOutClick:this.handleZoomOutClick,onZoomInClick:this.handleZoomInClick}),r&&i.a.createElement(ue,Object.assign({},this.state,{overflow:ze(this.state)})),i.a.cloneElement(e,{onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onMouseDown:this.handleMouseDown,onMouseMove:this.handleMouseMove,onDoubleClick:this.handleMouseDoubleClick,onWheel:this.handleMouseWheel,onDragStart:Ee,onLoad:this.handleImageLoad,onContextMenu:Ee,ref:this.handleRefImage,style:Te(this.state)}))}},{key:"componentDidMount",value:function(){window.addEventListener("resize",this.handleWindowResize),this.maybeHandleDimensionsChanged()}},{key:"componentDidUpdate",value:function(e,t){this.maybeHandleDimensionsChanged()}},{key:"componentWillUnmount",value:function(){this.cancelAnimation(),this.imageRef.removeEventListener("touchmove",this.handleTouchMove),window.removeEventListener("resize",this.handleWindowResize)}},{key:"calculateNegativeSpace",value:function(e){var t=this.state,n=t.containerDimensions,a=t.imageDimensions;return{width:n.width-e*a.width,height:n.height-e*a.height}}},{key:"cancelAnimation",value:function(){this.animation&&cancelAnimationFrame(this.animation)}},{key:"debug",value:function(e){this.props.debug&&console.log(e)}},{key:"isImageReady",get:function(){return this.isImageLoaded||this.imageRef&&"IMG"!==this.imageRef.tagName}},{key:"isTransformInitialized",get:function(){return Me(this.state.top,this.state.left,this.state.scale)}},{key:"controlOverscrollViaCss",get:function(){return window.CSS&&window.CSS.supports("touch-action","pan-up")}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.initialTop!==t.initialTop||e.initialLeft!==t.initialLeft||e.initialScale!==t.initialScale||e.position!==t.position?{position:e.position,initialScale:e.initialScale,initialTop:e.initialTop,initialLeft:e.initialLeft}:null}}]),t}(i.a.Component);Le.defaultProps={initialScale:"auto",minScale:"auto",maxScale:1,position:"topLeft",zoomButtons:!0,doubleTapBehavior:"reset"};var Ie=function(e){var t=e.userObj,n=Object(a.useState)(""),r=Object(s.a)(n,2),o=(r[0],r[1]),c=Object(a.useState)([]),l=Object(s.a)(c,2),u=(l[0],l[1],Object(a.useState)(0)),d=Object(s.a)(u,2),f=d[0],p=d[1],v=Object(a.useRef)(),g=Object(a.useState)({brushRadius:1,lazyRadius:0}),b=Object(s.a)(g,2),w=b[0],y=b[1],S=Object(a.useState)([]),E=Object(s.a)(S,2),O=(E[0],E[1],Object(a.useState)([])),x=Object(s.a)(O,2),j=(x[0],x[1],Object(a.useState)(0)),D=Object(s.a)(j,2),C=D[0],R=D[1],P=Object(a.useState)([]),M=Object(s.a)(P,2),T=M[0],z=M[1];Object(a.useEffect)(function(){h.doc("usersetting/"+t.uid).get().then(function(e){e.exists?(y({brushRadius:e.data().brushRadius,lazyRadius:e.data().lazyRadius,sotyIndex:e.data().sotyIndex}),R(e.data().sotyIndex),console.log(e.data())):console.log("No such setting document!")}).catch(function(e){console.log("Error getting document:",e)}),h.doc("RefDB/soty").get().then(function(e){if(e.exists){var t=e.data().refUrl;z(t)}else console.log("No such document!")}).catch(function(e){console.log("Error getting document:",e)})},[]);return i.a.createElement("div",null,i.a.createElement("div",{style:{float:"right"}}),i.a.createElement("div",null,i.a.createElement("label",null,"pages:"),i.a.createElement("input",{type:"number",min:"0",max:T.length-1,style:{width:"30px"},value:C,onChange:function(e){R(e.target.value),p(f+1)}})),i.a.createElement("div",{style:{float:"left"}},i.a.createElement("div",{style:{width:"450px",height:"620px"}},i.a.createElement(Le,null,i.a.createElement("img",{alt:"Test Image",src:T[C]})))),i.a.createElement("div",{style:{float:"left"}},i.a.createElement("div",null,i.a.createElement("div",{style:{float:"right"}},i.a.createElement("label",null,"Lazy-Radius:"),i.a.createElement("input",{type:"number",min:"0",max:"100",style:{width:"30px"},value:w.lazyRadius,onChange:function(e){return y(function(t){return Object(m.a)({},t,{lazyRadius:e.target.value})})}})),i.a.createElement("div",{style:{float:"right"}},i.a.createElement("label",null,"Brush-Radius:"),i.a.createElement("input",{type:"number",min:"1",max:"100",style:{width:"30px"},value:w.brushRadius,onChange:function(e){return y(function(t){return Object(m.a)({},t,{brushRadius:e.target.value})})}})),i.a.createElement("div",{style:{float:"right"}},i.a.createElement("button",{onClick:function(){v.current.clear()}},"Clear Canvas")),i.a.createElement("div",{style:{float:"right"}},i.a.createElement("form",{onSubmit:function(e){e.preventDefault(),function(){h.collection("usersetting").doc(t.uid).update({sotyIndex:C});var e=v.current.getSaveData(),n=v.current.getDataURL();v.current.clear(),h.collection("Csubmit").add({text:e,createdAt:Date.now(),creatorId:t.uid,drawingTime:0,heart:0,dataUrl:n,refPinUrl:"",sotyIndex:C}),o("")}()}},i.a.createElement("input",{type:"submit",value:"Upload Drawing"})))),i.a.createElement("div",{style:{float:"right"}},i.a.createElement(Q,{canvasWidth:600,canvasHeight:600,brushRadius:w.brushRadius,lazyRadius:w.lazyRadius,ref:v}))))},Ae=function(e){var t=e.isLoggedIn,n=e.userObj;return i.a.createElement(f.a,null,t&&i.a.createElement(ne,null),i.a.createElement(d.d,null,t?i.a.createElement(i.a.Fragment,null,i.a.createElement(d.b,{exact:!0,path:"/"},i.a.createElement(te,{userObj:n})),i.a.createElement(d.b,{exact:!0,path:"/profile"},i.a.createElement($,{userObj:n})),i.a.createElement(d.b,{exact:!0,path:"/doProko"},i.a.createElement(ae,{userObj:n})),i.a.createElement(d.b,{exact:!0,path:"/doSoty"},i.a.createElement(Ie,{userObj:n})),i.a.createElement(d.a,{from:"*",to:"/"})):i.a.createElement(i.a.Fragment,null,i.a.createElement(d.b,{exact:!0,path:"/"},i.a.createElement(ee,null)),i.a.createElement(d.a,{from:"*",to:"/"}))))};var We=function(){var e=Object(a.useState)(!1),t=Object(s.a)(e,2),n=t[0],r=t[1],o=Object(a.useState)(!1),c=Object(s.a)(o,2),l=c[0],h=c[1],d=Object(a.useState)(null),f=Object(s.a)(d,2),m=f[0],p=f[1];return Object(a.useEffect)(function(){u.onAuthStateChanged(function(e){e?(h(!0),p(e)):h(!1),r(!0)})},[]),i.a.createElement(i.a.Fragment,null,n?i.a.createElement(Ae,{isLoggedIn:l,userObj:m}):"Inisializing..")};console.log(l),o.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(We,null)),document.getElementById("root"))}},[[53,1,2]]]);
//# sourceMappingURL=main.cf60a863.chunk.js.map