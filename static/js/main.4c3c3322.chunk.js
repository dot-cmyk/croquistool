(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{118:function(e,t){},134:function(e,t,a){},135:function(e){e.exports={}},143:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(63),o=a.n(l),c=a(4),i=a(19),u=(a(106),a(145),a(144),i.a.initializeApp({apiKey:"AIzaSyDH6rySddl7QAoqkwATwz7CgXrPe7LQis8",authDomain:"croquistool.firebaseapp.com",projectId:"croquistool",storageBucket:"croquistool.appspot.com",messagingSenderId:"843301254465",appId:"1:843301254465:web:046d03ff7cf7e8619f9dc0",measurementId:"G-JT9C23VQFT"})),s=i.a.auth(),m=i.a.firestore(),d=i.a.storage(),f=a(29),g=a(25),p=a(18),h=a(1),b=a.n(h),v=a(3),E=a(23),y=a(2),w=a(5),O=a(14),j=a(11),S=a(13),x=a(24),C=a(81),k=a(82),R=a(83),D=Object.freeze({x:0,y:0,untransformedX:0,untransformedY:0}),I=Object.freeze({canvasWidth:0,canvasHeight:0,left:0,top:0,right:0,bottom:0,viewMin:D,viewMax:D}),F=Object.freeze({a:1,b:0,c:0,d:1,e:0,f:0});var T=function(){function e(t){var a=this,n=t.scaleExtents,r=t.documentSize;Object(y.a)(this,e),this._canvas=null,this._view={scale:1,x:0,y:0},this._viewChangeListeners=new Set,this.setScale=function(e){a.setView({scale:e})},this.clampView=function(e){var t=e.scale,n=e.x,r=e.y,l=a.scaleExtents,o=l.min,c=l.max,i=a.documentSize,u=i.width,s=i.height,m=a.canvasRect||I,d=m.left,f=m.top,g=m.right-d,p=m.bottom-f,h=g/2,b=-(u*a._view.scale-g/2),v=p/2,E=-(s*a._view.scale-p/2);return{scale:Math.min(Math.max(t,o),c),x:Math.min(Math.max(n,b),h),y:Math.min(Math.max(r,E),v)}},this.resetView=function(){a.setView({scale:1,x:0,y:0})},this.setView=function(e){var t=a.clampView(Object(p.a)({},a._view,e||{})),n=a._view,r=n.scale,l=n.x,o=n.y;return t.scale===r&&t.x===l&&t.y===o||(a._view=t,a._viewChangeListeners.forEach(function(e){return e&&e(t)})),Object(p.a)({},a._view)},this.scaleAtClientPoint=function(e,t){var n=a.clientPointToViewPoint(t),r=a.clampView(Object(p.a)({},a._view,{scale:a._view.scale+e})),l=a.viewPointToClientPoint(n,r);return r.x=a._view.x-(l.clientX-t.clientX),r.y=a._view.y-(l.clientY-t.clientY),a.setView(r)},this.clientPointToViewPoint=function(e){var t=e.clientX,n=e.clientY,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a._view,l=a.canvasRect||I,o=t-l.left,c=n-l.top;return{x:(o-r.x)/r.scale,y:(c-r.y)/r.scale,relativeClientX:o,relativeClientY:c}},this.viewPointToClientPoint=function(e){var t=e.x,n=e.y,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a._view,l=a.canvasRect||I,o=l.left,c=l.top,i=t*r.scale+r.x,u=n*r.scale+r.y,s=i+o,m=u+c;return{clientX:s,clientY:m,relativeX:i,relativeY:u,x:s,y:m}},this.attachViewChangeListener=function(e){a._viewChangeListeners.add(e)},this._scaleExtents=n,this._documentSize=r}return Object(w.a)(e,[{key:"canvas",get:function(){return this._canvas},set:function(e){this._canvas=e,this.setView()}},{key:"scale",get:function(){return this._view.scale}},{key:"x",get:function(){return this._view.x},set:function(e){this.setView({x:e})}},{key:"y",get:function(){return this._view.y},set:function(e){this.setView({y:e})}},{key:"view",get:function(){return Object(p.a)({},this._view)}},{key:"scaleExtents",get:function(){return Object(p.a)({},this._scaleExtents)},set:function(e){var t=e.min,a=e.max;this._scaleExtents={min:t,max:a},this.setView()}},{key:"documentSize",get:function(){return Object(p.a)({},this._documentSize)},set:function(e){var t=e.width,a=e.height;this._documentSize={width:t,height:a},this.setView()}},{key:"transformMatrix",get:function(){return{a:this._view.scale,b:0,c:0,d:this._view.scale,e:this._view.x,f:this._view.y}}},{key:"canvasBounds",get:function(){if(this._canvas){var e=this._canvas.getBoundingClientRect(),t=e.left,a=e.top,n=e.right,r=e.bottom;return{viewMin:this.clientPointToViewPoint({clientX:t,clientY:a}),viewMax:this.clientPointToViewPoint({clientX:n,clientY:r}),left:t,top:a,right:n,bottom:r,canvasWidth:this._canvas.width,canvasHeight:this._canvas.height}}}},{key:"canvasRect",get:function(){return this.canvas?this.canvas.getBoundingClientRect():void 0}}]),e}();var P=function(e){e.preventDefault()},z=function e(){var t=this;Object(y.a)(this,e),this.handleMouseWheel=function(e,a){var n=a.props,r=n.disabled;n.enablePanAndZoom,n.mouseZoomFactor;return r?new U:t},this.handleDrawStart=function(e,t){return console.log(t.controlPan),t.props.disabled?new U:t.controlPan&&t.props.enablePanAndZoom?(new L).handleDrawStart(e,t):(new B).handleDrawStart(e,t)},this.handleDrawMove=function(e,a){if(a.props.disabled)return new U;var n=W(a.coordSystem,e),r=n.x,l=n.y;return a.lazy.update({x:r,y:l}),t},this.handleDrawEnd=function(e,a){return a.props.disabled?new U:t}},U=function e(){var t=this;Object(y.a)(this,e),this.handleMouseWheel=function(e,a){return a.props.disabled?t:(new z).handleMouseWheel(e,a)},this.handleDrawStart=function(e,a){return a.props.disabled?t:(new z).handleDrawStart(e,a)},this.handleDrawMove=function(e,a){return a.props.disabled?t:(new z).handleDrawMove(e,a)},this.handleDrawEnd=function(e,a){return a.props.disabled?t:(new z).handleDrawEnd(e,a)}},L=function e(){var t=this;Object(y.a)(this,e),this.handleMouseWheel=P.bind(this),this.handleDrawStart=function(e,a){return e.preventDefault(),t.dragStart=_(e),t.panStart={x:a.coordSystem.x,y:a.coordSystem.y},t},this.handleDrawMove=function(e,a){e.preventDefault();var n=_(e),r=n.clientX,l=n.clientY,o=r-t.dragStart.clientX,c=l-t.dragStart.clientY;return a.coordSystem.setView({x:t.panStart.x+o,y:t.panStart.y+c}),t},this.handleDrawEnd=function(){return new z}},B=function e(){var t=this;Object(y.a)(this,e),this.handleMouseWheel=P.bind(this),this.handleDrawStart=function(e,a){var n=a.props.enablePanAndZoom;return e.preventDefault(),e.touches&&e.touches.length&&n?n&&e.touches&&e.touches.length>=2?(new A).handleDrawStart(e,a):t.handleDrawMove(e,a):(new q).handleDrawStart(e,a)},this.handleDrawMove=function(e,a){if(e.preventDefault(),e.touches&&e.touches.length>=2)return(new A).handleDrawStart(e,a);var n=_(e);if((t.deferredPoints.push(n),(new Date).valueOf()-t.startTimestamp<250)&&(null===t.startClientPoint&&(t.startClientPoint=n),Math.abs(n.clientX-t.startClientPoint.clientX)+Math.abs(n.clientY-t.startClientPoint.clientY)<10))return t;return t.issueDeferredPoints(a)},this.handleDrawEnd=function(e,a){return t.issueDeferredPoints(a).handleDrawEnd(e,a)},this.issueDeferredPoints=function(e){for(var a=new q,n=0;n<t.deferredPoints.length;n++){var r=t.deferredPoints[n],l=new V(r);a=(0===n?a.handleDrawStart:a.handleDrawMove)(l,e)}return a},this.startClientPoint=null,this.startTimestamp=(new Date).valueOf(),this.deferredPoints=[]},A=function e(){var t=this;Object(y.a)(this,e),this.handleMouseWheel=P.bind(this),this.handleDrawStart=function(e,a){return e.preventDefault(),!e.touches||e.touches.length<2?new z:(t.start=t.getTouchMetrics(e),t.panStart={x:a.coordSystem.x,y:a.coordSystem.y},t.scaleStart=a.coordSystem.scale,t)},this.handleDrawMove=function(e,a){if(e.preventDefault(),!e.touches||e.touches.length<2)return new z;var n=t.recentMetrics=t.getTouchMetrics(e),r=n.centroid,l=n.distance;if(Math.abs(l-t.start.distance)>=10)return new N(t).handleDrawMove(e,a);var o=r.clientX-t.start.centroid.clientX,c=r.clientY-t.start.centroid.clientY;return Math.abs(o)+Math.abs(c)>=10?new M(t).handleDrawMove(e,a):t},this.handleDrawEnd=function(){return new z},this.getTouchMetrics=function(e){var t=_(e.touches[0]),a=t.clientX,n=t.clientY,r=_(e.touches[1]),l=r.clientX,o=r.clientY,c=l-a,i=o-n;return{t1:{clientX:a,clientY:n},t2:{clientX:l,clientY:o},distance:Math.sqrt(c*c+i*i),centroid:{clientX:(a+l)/2,clientY:(n+o)/2}}}},M=function e(t){var a=this;Object(y.a)(this,e),this.handleMouseWheel=P.bind(this),this.handleDrawStart=function(){return a},this.handleDrawMove=function(e,t){if(e.preventDefault(),!e.touches||e.touches.length<2)return new z;var n=a.scaleOrPanState,r=n.recentMetrics=n.getTouchMetrics(e),l=r.centroid,o=(r.distance,l.clientX-n.start.centroid.clientX),c=l.clientY-n.start.centroid.clientY;return t.setView({x:n.panStart.x+o,y:n.panStart.y+c}),a},this.handleDrawEnd=function(){return new z},this.scaleOrPanState=t},N=function e(t){var a=this;Object(y.a)(this,e),this.handleMouseWheel=P.bind(this),this.handleDrawStart=function(){return a},this.handleDrawMove=function(e,t){if(e.preventDefault(),!e.touches||e.touches.length<2)return new z;var n=a.scaleOrPanState,r=n.recentMetrics=n.getTouchMetrics(e),l=r.centroid,o=r.distance,c=n.scaleStart*(o/n.start.distance)-t.coordSystem.scale;return t.coordSystem.scaleAtClientPoint(c,l),a},this.handleDrawEnd=function(){return new z},this.scaleOrPanState=t},q=function e(){var t=this;Object(y.a)(this,e),this.handleMouseWheel=P.bind(this),this.handleDrawStart=function(e,a){if(e.preventDefault(),e.touches&&e.touches.length){var n=W(a.coordSystem,e),r=n.x,l=n.y;a.lazy.update({x:r,y:l},{both:!0})}return t.handleDrawMove(e,a)},this.handleDrawMove=function(e,a){e.preventDefault();var n=W(a.coordSystem,e),r=n.x,l=n.y;a.lazy.update({x:r,y:l});var o=!a.lazy.isEnabled();return t.isDrawing&&!o||(a.points.push(a.clampPointToDocument(a.lazy.brush.toObject())),t.isDrawing=!0),a.points.push(a.clampPointToDocument(a.lazy.brush.toObject())),a.drawPoints({points:a.points,brushColor:a.props.brushColor,brushRadius:a.props.brushRadius}),t},this.handleDrawEnd=function(e,a){return e.preventDefault(),t.handleDrawMove(e,a),a.saveLine(),new z},this.isDrawing=!1},V=function e(t){var a=t.clientX,n=t.clientY;Object(y.a)(this,e),this.preventDefault=function(){},this.clientX=a,this.clientY=n,this.touches=[{clientX:a,clientY:n}]};function _(e){var t=e.clientX,a=e.clientY;return e.changedTouches&&e.changedTouches.length>0&&(t=e.changedTouches[0].clientX,a=e.changedTouches[0].clientY),{clientX:t,clientY:a}}function W(e,t){return e.clientPointToViewPoint(_(t))}try{var H={get passive(){return!0,!1}};window.addEventListener("test",H,H),window.removeEventListener("test",H,H)}catch(yt){!1}function X(e,t){var a="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=function(e,t){if(!e)return;if("string"===typeof e)return Y(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Y(e,t)}(e))||t&&e&&"number"===typeof e.length){a&&(e=a);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,o=!0,c=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return o=e.done,e},e:function(e){c=!0,l=e},f:function(){try{o||null==a.return||a.return()}finally{if(c)throw l}}}}function Y(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}function J(e,t){return{x:e.x+(t.x-e.x)/2,y:e.y+(t.y-e.y)/2}}var G={display:"block",position:"absolute"},Z=["grid","drawing","temp","interface"],K="brush",Q=function(e){function t(e){var a;return Object(y.a)(this,t),(a=Object(O.a)(this,Object(j.a)(t).call(this,e))).undo=function(){var e=[];a.lines.length?e=a.lines.slice(0,-1):a.erasedLines.length&&(e=a.erasedLines.pop()),a.clearExceptErasedLines(),a.simulateDrawingLines({lines:e,immediate:!0}),a.triggerOnChange()},a.eraseAll=function(){a.erasedLines.push(Object(E.a)(a.lines)),a.clearExceptErasedLines(),a.triggerOnChange()},a.clear=function(){a.erasedLines=[],a.clearExceptErasedLines(),a.resetView()},a.resetView=function(){return a.coordSystem.resetView()},a.setView=function(e){return a.coordSystem.setView(e)},a.getSaveData=function(){return JSON.stringify({lines:a.lines,width:a.props.canvasWidth,height:a.props.canvasHeight})},a.getDataURL=function(e,t,n){var r=a.canvas.drawing,l=r.getContext("2d"),o=r.width,c=r.height,i=l.getImageData(0,0,o,c),u=l.globalCompositeOperation;if(l.globalCompositeOperation="destination-over",t){if(!a.props.imgSrc)return"Background image source not set";a.drawImage()}else null!=n&&(l.fillStyle=n,l.fillRect(0,0,o,c));e||(e="png");var s=r.toDataURL("image/".concat(e));return l.clearRect(0,0,o,c),l.putImageData(i,0,0),l.globalCompositeOperation=u,s},a.loadSaveData=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.props.immediateLoading;if("string"!==typeof e)throw new Error("saveData needs to be of type string!");var n=JSON.parse(e),r=n.lines,l=n.width,o=n.height;if(!r||"function"!==typeof r.push)throw new Error("saveData.lines needs to be an array!");if(a.clear(),l===a.props.canvasWidth&&o===a.props.canvasHeight)a.simulateDrawingLines({lines:r,immediate:t});else{var c=a.props.canvasWidth/l,i=a.props.canvasHeight/o,u=(c+i)/2;a.simulateDrawingLines({lines:r.map(function(e){return Object(p.a)({},e,{points:e.points.map(function(e){return{x:e.x*c,y:e.y*i}}),brushRadius:e.brushRadius*u})}),immediate:t})}},a.componentWillUnmount=function(){a.canvasObserver.unobserve(a.canvasContainer)},a.CustomKeyDown=function(e){console.log("\ud0a4",e.key),"z"===e.key&&(console.log("undo"),a.undo()),"c"===e.key&&(console.log("erase"),K="erase"!=K?"erase":"brush"),"x"===e.key&&(K="shadow"!=K?"shadow":"brush")},a.handleWheel=function(e){a.interactionSM=a.interactionSM.handleMouseWheel(e,Object(x.a)(Object(x.a)(a)))},a.handleDrawStart=function(e){"all"!=a.props.allowOnlyPointerType&&e.pointerType!=a.props.allowOnlyPointerType||(a.interactionSM=a.interactionSM.handleDrawStart(e,Object(x.a)(Object(x.a)(a))),a.mouseHasMoved=!0)},a.handleDrawMove=function(e){"all"!=a.props.allowOnlyPointerType&&e.pointerType!=a.props.allowOnlyPointerType||(a.interactionSM=a.interactionSM.handleDrawMove(e,Object(x.a)(Object(x.a)(a))),a.mouseHasMoved=!0)},a.handleDrawEnd=function(e){"all"!=a.props.allowOnlyPointerType&&e.pointerType!=a.props.allowOnlyPointerType||(a.interactionSM=a.interactionSM.handleDrawEnd(e,Object(x.a)(Object(x.a)(a))),a.mouseHasMoved=!0)},a.applyView=function(){if(a.ctx.drawing&&(Z.map(function(e){return a.ctx[e]}).forEach(function(e){a.clearWindow(e);var t=a.coordSystem.transformMatrix;e.setTransform(t.a,t.b,t.c,t.d,t.e,t.f)}),!a.deferRedrawOnViewChange)){a.drawGrid(a.ctx.grid),a.redrawImage(),a.loop({once:!0});var e=a.lines;a.lines=[],a.simulateDrawingLines({lines:e,immediate:!0})}},a.handleCanvasResize=function(e){var t=a.getSaveData();a.deferRedrawOnViewChange=!0;try{var n,r=X(e);try{for(r.s();!(n=r.n()).done;){var l=n.value.contentRect,o=l.width,c=l.height;a.setCanvasSize(a.canvas.interface,o,c),a.setCanvasSize(a.canvas.drawing,o,c),a.setCanvasSize(a.canvas.temp,o,c),a.setCanvasSize(a.canvas.grid,o,c),a.coordSystem.documentSize={width:o,height:c},a.drawGrid(a.ctx.grid),a.drawImage(),a.loop({once:!0})}}catch(i){r.e(i)}finally{r.f()}a.loadSaveData(t,!0)}finally{a.deferRedrawOnViewChange=!1}},a.clampPointToDocument=function(e){return a.props.clampLinesToDocument?{x:Math.max(Math.min(e.x,a.props.canvasWidth),0),y:Math.max(Math.min(e.y,a.props.canvasHeight),0)}:e},a.redrawImage=function(){a.image&&a.image.complete&&function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.ctx,a=e.img,n=e.x,r=e.y,l=e.w,o=e.h,c=e.offsetX,i=e.offsetY;"number"!==typeof n&&(n=0),"number"!==typeof r&&(r=0),"number"!==typeof l&&(l=t.canvas.width),"number"!==typeof o&&(o=t.canvas.height),"number"!==typeof c&&(c=.5),"number"!==typeof i&&(i=.5),c<0&&(c=0),i<0&&(i=0),c>1&&(c=1),i>1&&(i=1);var u,s,m,d,f=a.width,g=a.height,p=Math.min(l/f,o/g),h=f*p,b=g*p,v=1;h<l&&(v=l/h),Math.abs(v-1)<1e-14&&b<o&&(v=o/b),(u=(f-(m=f/((h*=v)/l)))*c)<0&&(u=0),(s=(g-(d=g/((b*=v)/o)))*i)<0&&(s=0),m>f&&(m=f),d>g&&(d=g),t.drawImage(a,u,s,m,d,n,r,l,o)}({ctx:a.ctx.grid,img:a.image})},a.simulateDrawingLines=function(e){var t=e.lines,n=e.immediate,r=0,l=n?0:a.props.loadTimeOffset;t.forEach(function(e){var t=e.points,o=e.brushColor,c=e.brushRadius;if(n)return a.drawPoints({points:t,brushColor:o,brushRadius:c}),a.points=t,void a.saveLine({brushColor:o,brushRadius:c});for(var i=function(e){r+=l,window.setTimeout(function(){a.drawPoints({points:t.slice(0,e+1),brushColor:o,brushRadius:c})},r)},u=1;u<t.length;u++)i(u);r+=l,window.setTimeout(function(){a.points=t,a.saveLine({brushColor:o,brushRadius:c})},r)})},a.setCanvasSize=function(e,t,a){e.width=t,e.height=a,e.style.width=t,e.style.height=a},a.drawPoints=function(e){var t=e.points,n=e.brushColor,r=e.brushRadius;a.ctx.temp.lineJoin="round",a.ctx.temp.lineCap="round",a.ctx.temp.strokeStyle="erase"===n?"#dbb7bb":n,a.ctx.drawing.globalCompositeOperation="erase"===n?"destination-out":"shadow"===n?"destination-over":"source-over",a.clearWindow(a.ctx.temp),a.ctx.temp.lineWidth=2*r;var l=t[0],o=t[1];a.ctx.temp.moveTo(o.x,o.y),a.ctx.temp.beginPath();for(var c=1,i=t.length;c<i;c++){var u=J(l,o);a.ctx.temp.quadraticCurveTo(l.x,l.y,u.x,u.y),l=t[c],o=t[c+1]}a.ctx.temp.lineTo(l.x,l.y),"shadow"==n?(a.ctx.temp.closePath(),a.ctx.temp.fillStyle="#DADADA",a.ctx.temp.fill()):a.ctx.temp.stroke()},a.saveLine=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.brushColor,n=e.brushRadius;a.points.length<2||(a.lines.push({points:Object(E.a)(a.points),brushColor:t||a.props.brushColor,brushRadius:n||a.props.brushRadius}),a.points.length=0,a.inClientSpace([a.ctx.drawing,a.ctx.temp],function(){a.ctx.drawing.drawImage(a.canvas.temp,0,0,a.canvas.drawing.width,a.canvas.drawing.height)}),a.clearWindow(a.ctx.temp),a.triggerOnChange())},a.triggerOnChange=function(){a.props.onChange&&a.props.onChange(Object(x.a)(Object(x.a)(a)))},a.clearWindow=function(e){a.inClientSpace([e],function(){return e.clearRect(0,0,e.canvas.width,e.canvas.height)})},a.clearExceptErasedLines=function(){a.lines=[],a.valuesChanged=!0,a.clearWindow(a.ctx.drawing),a.clearWindow(a.ctx.temp)},a.loop=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).once,t=void 0!==e&&e;if(a.mouseHasMoved||a.valuesChanged){var n=a.lazy.getPointerCoordinates(),r=a.lazy.getBrushCoordinates();a.drawInterface(a.ctx.interface,n,r),a.mouseHasMoved=!1,a.valuesChanged=!1}t||window.requestAnimationFrame(function(){a.loop()})},a.inClientSpace=function(e,t){e.forEach(function(e){e.save(),e.setTransform(F.a,F.b,F.c,F.d,F.e,F.f)});try{t()}finally{e.forEach(function(e){return e.restore()})}},a.drawImage=function(){a.props.imgSrc&&(a.image=new Image,a.image.crossOrigin="anonymous",a.image.onload=a.redrawImage,a.image.src=a.props.imgSrc)},a.drawGrid=function(e){if(!a.props.hideGrid){a.clearWindow(e);var t=a.coordSystem.canvasBounds,n=t.viewMin,r=t.viewMax,l=25*Math.floor(n.x/25-1),o=25*Math.floor(n.y/25-1),c=r.x+25,i=r.y+25;if(e.beginPath(),e.setLineDash([5,1]),e.setLineDash([]),e.strokeStyle=a.props.gridColor,e.lineWidth=a.props.gridLineWidth,!a.props.hideGridX){for(var u=l,s=a.props.gridSizeX;u<c;)u+=s,e.moveTo(u,o),e.lineTo(u,i);e.stroke()}if(!a.props.hideGridY){for(var m=o,d=a.props.gridSizeY;m<i;)m+=d,e.moveTo(l,m),e.lineTo(c,m);e.stroke()}}},a.drawInterface=function(e,t,n){a.props.hideInterface||(a.clearWindow(e),e.beginPath(),e.fillStyle=a.props.brushColor,e.arc(n.x,n.y,a.props.brushRadius,0,2*Math.PI,!0),e.fill(),e.beginPath(),e.fillStyle=a.props.catenaryColor,e.arc(t.x,t.y,2,0,2*Math.PI,!0),e.fill(),e.beginPath(),e.fillStyle=a.props.catenaryColor,e.arc(n.x,n.y,1,0,2*Math.PI,!0),e.fill())},a.controlPan=!1,a.state={controlPan2:!1,zoomscale:0},a.canvas={},a.ctx={},a.catenary=new k.Catenary,a.points=[],a.lines=[],a.erasedLines=[],a.mouseHasMoved=!0,a.valuesChanged=!0,a.isDrawing=!1,a.isPressing=!1,a.deferRedrawOnViewChange=!1,a.interactionSM=new z,a.coordSystem=new T({scaleExtents:e.zoomExtents,documentSize:{width:e.canvasWidth,height:e.canvasHeight}}),a.coordSystem.attachViewChangeListener(a.applyView.bind(Object(x.a)(Object(x.a)(a)))),a}return Object(S.a)(t,e),Object(w.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.lazy=new C.LazyBrush({radius:this.props.lazyRadius*window.devicePixelRatio,enabled:!0,initialPoint:{x:window.innerWidth/2,y:window.innerHeight/2}}),this.chainLength=this.props.lazyRadius*window.devicePixelRatio,this.canvasObserver=new R.a(function(t,a){return e.handleCanvasResize(t,a)}),this.canvasObserver.observe(this.canvasContainer),this.drawImage(),this.loop(),window.setTimeout(function(){var t=window.innerWidth/2,a=window.innerHeight/2;e.lazy.update({x:t-e.chainLength/4,y:a},{both:!0}),e.lazy.update({x:t+e.chainLength/4,y:a},{both:!1}),e.mouseHasMoved=!0,e.valuesChanged=!0,e.clearExceptErasedLines(),e.props.saveData&&e.loadSaveData(e.props.saveData)},100)}},{key:"componentDidUpdate",value:function(e){e.lazyRadius!==this.props.lazyRadius&&(this.chainLength=this.props.lazyRadius*window.devicePixelRatio,this.lazy.setRadius(this.props.lazyRadius*window.devicePixelRatio)),e.saveData!==this.props.saveData&&this.loadSaveData(this.props.saveData),JSON.stringify(e)!==JSON.stringify(this.props)&&(this.valuesChanged=!0),e.imgSrc!==this.props.imgSrc&&(this.drawImage(),this.clearWindow(this.ctx.grid),this.drawGrid(this.ctx.grid)),this.coordSystem.scaleExtents=this.props.zoomExtents,this.props.enablePanAndZoom||this.coordSystem.resetView(),e.imgSrc,this.props.imgSrc}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:this.props.className,style:Object(p.a)({display:"block",background:this.props.backgroundColor,touchAction:"none",width:this.props.canvasWidth,height:this.props.canvasHeight},this.props.style),ref:function(t){t&&(e.canvasContainer=t)}},Z.map(function(t){var a="interface"===t,n=G;return n="temp"===t?Object(p.a)({},n,{width:e.props.canvasWidth,opacity:"erase"===e.props.brushColor?"70%":"100%",zIndex:"shadow"===e.props.brushColor?0:1}):Object(p.a)({},n,{zIndex:1}),r.a.createElement("canvas",{key:t,ref:function(n){n&&(e.canvas[t]=n,e.ctx[t]=n.getContext("2d"),a&&(e.coordSystem.canvas=n))},style:Object(p.a)({},n),onPointerDown:a?e.handleDrawStart:void 0,onPointerMove:a?e.handleDrawMove:void 0,onPointerUp:a?e.handleDrawEnd:void 0,onPointerOut:a?e.handleDrawEnd:void 0})})),r.a.createElement("div",null,r.a.createElement("button",{onClick:function(){e.controlPan=!e.controlPan,console.log(e.controlPan),e.setState({controlPan2:!e.state.controlPan2})}},this.state.controlPan2?"Pan on":"Pan off"),r.a.createElement("button",{onClick:function(){e.resetView()}},"reset"),r.a.createElement("button",{onClick:function(){e.setState({zoomscale:e.state.zoomscale-.1}),e.coordSystem.scaleAtClientPoint(.1,{clientX:600,clientY:300})}},"+"),r.a.createElement("button",{onClick:function(){e.coordSystem.scaleAtClientPoint(e.state.zoomscale,{clientX:600,clientY:300}),e.setState({zoomscale:0})}},"o"),r.a.createElement("button",{onClick:function(){e.setState({zoomscale:e.state.zoomscale+.1}),e.coordSystem.scaleAtClientPoint(-.1,{clientX:600,clientY:300})}},"-")))}}]),t}(n.PureComponent);Q.defaultProps={onChange:null,loadTimeOffset:5,lazyRadius:12,allowOnlyPointerType:"pen",brushRadius:10,brushColor:"#444",catenaryColor:"#0a0302",gridColor:"rgba(150,150,150,0.17)",backgroundColor:"#FFF",hideGrid:!1,canvasWidth:400,canvasHeight:400,disabled:!1,imgSrc:"",saveData:"",immediateLoading:!1,hideInterface:!1,gridSizeX:25,gridSizeY:25,gridLineWidth:.5,hideGridX:!1,hideGridY:!1,enablePanAndZoom:!0,PanControl:!1,mouseZoomFactor:.01,zoomExtents:{min:.33,max:3},clampLinesToDocument:!1,refreshBackgroundImage:!1};var $=a(48),ee=function(e){var t=e.CsubmitObj,a=e.isOwner,l=(e.viewDeleyToggle,Object(n.useState)(!1)),o=Object(c.a)(l,2),u=o[0],s=o[1],d=Object(n.useState)(t.text),f=Object(c.a)(d,2),g=(f[0],f[1],Object(n.useRef)()),p=Object(n.useState)(!0),h=Object(c.a)(p,2),E=(h[0],h[1]),y=new Date(t.createdAt),w=Object(n.useState)(!1),O=Object(c.a)(w,2),j=O[0],S=O[1],x=Object(n.useState)(""),C=Object(c.a)(x,2),k=(C[0],C[1]),R=Object(n.useState)(""),D=Object(c.a)(R,2),I=D[0],F=D[1],T=Object(n.useState)(!1),P=Object(c.a)(T,2),z=P[0],U=P[1],L=Object(n.useState)("#df6161"),B=Object(c.a)(L,2),A=B[0],M=B[1],N=function(){var e=Object(v.a)(b.a.mark(function e(){return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return E(function(e){return!e}),e.next=3,m.doc("Csubmit/".concat(t.id)).update({heart:1+t.heart});case 3:console.log(t.heart),m.doc("RefDB/refStrings").update({heart:i.a.firestore.FieldValue.arrayUnion(t.refPinUrl)});case 6:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();return r.a.createElement("div",{style:{float:"left",border:"10px solid rgba(0, 0, 0, 0.05)",width:"420px"}},u?r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:function(e){if(e.preventDefault(),I.length>0){var a=g.current.props.canvasWidth,n=g.current.props.canvasHeight,r=g.current.canvasContainer.children[0],l=g.current.canvasContainer.children[1],o=document.createElement("canvas");o.width=a,o.height=n,o.getContext("2d").drawImage(r,0,0),o.getContext("2d").drawImage(l,0,0);var c=o.toDataURL("image/png");m.doc("Csubmit/".concat(t.id)).update({text:"",dataUrl:c}),s(!1)}else{var i=g.current.getSaveData(),u=g.current.getDataURL();m.doc("Csubmit/".concat(t.id)).update({text:i,dataUrl:u}),s(!1)}F("")}},"Up"),r.a.createElement("button",{onClick:function(e){F(t.dataUrl),U(!0)}},"img"),r.a.createElement("button",{onClick:function(e){g.current.undo()}},"\u25c0"),"erase"==A?r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:function(e){M("#df6161")}},"brush")):r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:function(e){M("erase")}},"erase")),r.a.createElement("div",null,r.a.createElement(Q,{ref:g,imgSrc:I,brushRadius:"erase"==A?5:.6,lazyRadius:.5,hideGrid:z,brushColor:A,allowOnlyPointerType:"pen",loadTimeOffset:5})),r.a.createElement("button",{onClick:function(){g.current.clear(),""!==t.text&&g.current.loadSaveData(t.text)}},"Rewind"),r.a.createElement("button",{onClick:function(){s(!1)}},"Cancel")):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{margin:"0 auto"}},r.a.createElement("img",{width:400,src:t.dataUrl})),a?r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:N,style:{padding:"0px 0px"}},0==t.heart?r.a.createElement(r.a.Fragment,null,"\u2764"):r.a.createElement(r.a.Fragment,null,"+",t.heart)),r.a.createElement("button",{onClick:function(){window.confirm("wanna delete this?")&&m.doc("Csubmit/".concat(t.id)).delete()}},"Delete"),r.a.createElement("button",{onClick:function(){s(!0),U(!1),setTimeout(function(){""!==t.text&&g.current.loadSaveData(t.text)},5)}},"Review")):r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:N},"\u2764 ",t.heart))),r.a.createElement("button",{onClick:function(){S(function(e){return!e}),k(t.refPinUrl)}},"Ref Pin"),"   ","  ",y.toLocaleString(navigator.language||navigator.userLanguage),j?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("button",{onClick:function(e){window.confirm("wanna redraw this?")&&("string"==typeof t.refPinUrl&&t.refPinUrl.includes("firebasestorage.googleapis.com")?localStorage.setItem("redraw",t.refPinUrl):localStorage.setItem("redraw","https://assets.pinterest.com/ext/embed.html?id="+t.refPinUrl))}},"redraw"),r.a.createElement("button",{onClick:function(e){window.confirm("wanna bookmark this?")&&(e.preventDefault(),m.collection("Csubmitbook").add({text:t.text,createdAt:t.createdAt,creatorId:t.creatorId,drawingTime:t.drawingTime,heart:t.heart,dataUrl:t.dataUrl,refPinUrl:t.refPinUrl}))}},"bookmark")),t.refPinUrl.startsWith("pot.com/o/")?r.a.createElement(r.a.Fragment,null,r.a.createElement("img",{src:t.refPinUrl.replace("pot.com/o/","https://firebasestorage.googleapis.com/v0/b/croquistool.appspot.com/o/"),width:415,frameBorder:0,scrolling:"no"})):r.a.createElement(r.a.Fragment,null,"string"==typeof t.refPinUrl&&t.refPinUrl.includes("firebasestorage.googleapis.com")?r.a.createElement(r.a.Fragment,null,r.a.createElement("img",{src:t.refPinUrl,width:415,frameBorder:0,scrolling:"no"})):r.a.createElement(r.a.Fragment,null,r.a.createElement("iframe",{src:"https://assets.pinterest.com/ext/embed.html?id="+t.refPinUrl,height:"600",width:"300",frameBorder:0,scrolling:"no"}))))):r.a.createElement(r.a.Fragment,null))},te=function(e){var t=e.CsubmitbookObj,a=e.isOwner,l=(e.viewDeleyToggle,Object(n.useState)(!1)),o=Object(c.a)(l,2),u=o[0],s=o[1],d=Object(n.useState)(t.text),f=Object(c.a)(d,2),g=(f[0],f[1],Object(n.useRef)()),p=Object(n.useState)(!0),h=Object(c.a)(p,2),E=(h[0],h[1]),y=new Date(t.createdAt),w=Object(n.useState)(!1),O=Object(c.a)(w,2),j=O[0],S=O[1],x=Object(n.useState)(""),C=Object(c.a)(x,2),k=(C[0],C[1]),R=function(){var e=Object(v.a)(b.a.mark(function e(){return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return E(function(e){return!e}),e.next=3,m.doc("Csubmitbook/".concat(t.id)).update({heart:1+t.heart});case 3:console.log(t.heart),m.doc("RefDB/refStrings").update({heart:i.a.firestore.FieldValue.arrayUnion(t.refPinUrl)});case 6:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();return r.a.createElement("div",{style:{float:"left",border:"10px solid rgb(0 97 255 / 7%)",width:"420px"}},u?r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:function(e){e.preventDefault();var a=g.current.getSaveData(),n=g.current.getDataURL();m.doc("Csubmitbook/".concat(t.id)).update({text:a,dataUrl:n}),s(!1)}},"Edit"),r.a.createElement("div",null,r.a.createElement(Q,{ref:g,brushRadius:.6,lazyRadius:.5,brushColor:"#df6161",allowOnlyPointerType:"pen",loadTimeOffset:5})),r.a.createElement("button",{onClick:function(){g.current.clear(),g.current.loadSaveData(t.text)}},"Rewind"),r.a.createElement("button",{onClick:function(){s(!1)}},"Cancel")):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{margin:"0 auto"}},r.a.createElement($.LazyLoadImage,{width:400,src:t.dataUrl})),a?r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:R,style:{padding:"0px 0px"}},0==t.heart?r.a.createElement(r.a.Fragment,null,"\u2764"):r.a.createElement(r.a.Fragment,null,"+",t.heart)),r.a.createElement("button",{onClick:function(){window.confirm("wanna delete this?")&&m.doc("Csubmitbook/".concat(t.id)).delete()}},"Delete"),r.a.createElement("button",{onClick:function(){s(!0),setTimeout(function(){g.current.loadSaveData(t.text)},5)}},"Review")):r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:R},"\u2764 ",t.heart))),r.a.createElement("button",{onClick:function(){S(function(e){return!e}),k(t.refPinUrl)}},"Ref Pin"),"   ","  ",y.toLocaleString(navigator.language||navigator.userLanguage),j?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("button",{onClick:function(e){window.confirm("wanna redraw this?")&&("string"==typeof t.refPinUrl&&t.refPinUrl.includes("firebasestorage.googleapis.com")?localStorage.setItem("redraw",t.refPinUrl):localStorage.setItem("redraw","https://assets.pinterest.com/ext/embed.html?id="+t.refPinUrl))}},"redraw")),t.refPinUrl.startsWith("pot.com/o/")?r.a.createElement(r.a.Fragment,null,r.a.createElement("img",{src:t.refPinUrl.replace("pot.com/o/","https://firebasestorage.googleapis.com/v0/b/croquistool.appspot.com/o/"),width:415,frameBorder:0,scrolling:"no"})):r.a.createElement(r.a.Fragment,null,"string"==typeof t.refPinUrl&&t.refPinUrl.includes("firebasestorage.googleapis.com")?r.a.createElement(r.a.Fragment,null,r.a.createElement("img",{src:t.refPinUrl,width:415,frameBorder:0,scrolling:"no"})):r.a.createElement(r.a.Fragment,null,r.a.createElement("iframe",{src:"https://assets.pinterest.com/ext/embed.html?id="+t.refPinUrl,height:"600",width:"300",frameBorder:0,scrolling:"no"}))))):r.a.createElement(r.a.Fragment,null))},ae=(a(53),a(59)),ne=(a(77),{_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_f:String.fromCharCode,compressToBase64:function(e){if(null==e)return"";var t,a,n,r,l,o,c,i="",u=0;for(e=ne.compress(e);u<2*e.length;)u%2==0?(t=e.charCodeAt(u/2)>>8,a=255&e.charCodeAt(u/2),n=u/2+1<e.length?e.charCodeAt(u/2+1)>>8:NaN):(t=255&e.charCodeAt((u-1)/2),(u+1)/2<e.length?(a=e.charCodeAt((u+1)/2)>>8,n=255&e.charCodeAt((u+1)/2)):a=n=NaN),u+=3,r=t>>2,l=(3&t)<<4|a>>4,o=(15&a)<<2|n>>6,c=63&n,isNaN(a)?o=c=64:isNaN(n)&&(c=64),i=i+ne._keyStr.charAt(r)+ne._keyStr.charAt(l)+ne._keyStr.charAt(o)+ne._keyStr.charAt(c);return i},decompressFromBase64:function(e){if(null==e)return"";var t,a,n,r,l,o,c,i="",u=0,s=0,m=ne._f;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");s<e.length;)a=ne._keyStr.indexOf(e.charAt(s++))<<2|(l=ne._keyStr.indexOf(e.charAt(s++)))>>4,n=(15&l)<<4|(o=ne._keyStr.indexOf(e.charAt(s++)))>>2,r=(3&o)<<6|(c=ne._keyStr.indexOf(e.charAt(s++))),u%2==0?(t=a<<8,64!=o&&(i+=m(t|n)),64!=c&&(t=r<<8)):(i+=m(t|a),64!=o&&(t=n<<8),64!=c&&(i+=m(t|r))),u+=3;return ne.decompress(i)},compressToUTF16:function(e){if(null==e)return"";var t,a,n,r="",l=0,o=ne._f;for(e=ne.compress(e),t=0;t<e.length;t++)switch(a=e.charCodeAt(t),l++){case 0:r+=o(32+(a>>1)),n=(1&a)<<14;break;case 1:r+=o(n+(a>>2)+32),n=(3&a)<<13;break;case 2:r+=o(n+(a>>3)+32),n=(7&a)<<12;break;case 3:r+=o(n+(a>>4)+32),n=(15&a)<<11;break;case 4:r+=o(n+(a>>5)+32),n=(31&a)<<10;break;case 5:r+=o(n+(a>>6)+32),n=(63&a)<<9;break;case 6:r+=o(n+(a>>7)+32),n=(127&a)<<8;break;case 7:r+=o(n+(a>>8)+32),n=(255&a)<<7;break;case 8:r+=o(n+(a>>9)+32),n=(511&a)<<6;break;case 9:r+=o(n+(a>>10)+32),n=(1023&a)<<5;break;case 10:r+=o(n+(a>>11)+32),n=(2047&a)<<4;break;case 11:r+=o(n+(a>>12)+32),n=(4095&a)<<3;break;case 12:r+=o(n+(a>>13)+32),n=(8191&a)<<2;break;case 13:r+=o(n+(a>>14)+32),n=(16383&a)<<1;break;case 14:r+=o(n+(a>>15)+32,32+(32767&a)),l=0}return r+o(n+32)},decompressFromUTF16:function(e){if(null==e)return"";for(var t,a,n="",r=0,l=0,o=ne._f;l<e.length;){switch(a=e.charCodeAt(l)-32,r++){case 0:t=a<<1;break;case 1:n+=o(t|a>>14),t=(16383&a)<<2;break;case 2:n+=o(t|a>>13),t=(8191&a)<<3;break;case 3:n+=o(t|a>>12),t=(4095&a)<<4;break;case 4:n+=o(t|a>>11),t=(2047&a)<<5;break;case 5:n+=o(t|a>>10),t=(1023&a)<<6;break;case 6:n+=o(t|a>>9),t=(511&a)<<7;break;case 7:n+=o(t|a>>8),t=(255&a)<<8;break;case 8:n+=o(t|a>>7),t=(127&a)<<9;break;case 9:n+=o(t|a>>6),t=(63&a)<<10;break;case 10:n+=o(t|a>>5),t=(31&a)<<11;break;case 11:n+=o(t|a>>4),t=(15&a)<<12;break;case 12:n+=o(t|a>>3),t=(7&a)<<13;break;case 13:n+=o(t|a>>2),t=(3&a)<<14;break;case 14:n+=o(t|a>>1),t=(1&a)<<15;break;case 15:n+=o(t|a),r=0}l++}return ne.decompress(n)},compress:function(e){if(null==e)return"";var t,a,n,r={},l={},o="",c="",i="",u=2,s=3,m=2,d="",f=0,g=0,p=ne._f;for(n=0;n<e.length;n+=1)if(o=e.charAt(n),Object.prototype.hasOwnProperty.call(r,o)||(r[o]=s++,l[o]=!0),c=i+o,Object.prototype.hasOwnProperty.call(r,c))i=c;else{if(Object.prototype.hasOwnProperty.call(l,i)){if(i.charCodeAt(0)<256){for(t=0;t<m;t++)f<<=1,15==g?(g=0,d+=p(f),f=0):g++;for(a=i.charCodeAt(0),t=0;t<8;t++)f=f<<1|1&a,15==g?(g=0,d+=p(f),f=0):g++,a>>=1}else{for(a=1,t=0;t<m;t++)f=f<<1|a,15==g?(g=0,d+=p(f),f=0):g++,a=0;for(a=i.charCodeAt(0),t=0;t<16;t++)f=f<<1|1&a,15==g?(g=0,d+=p(f),f=0):g++,a>>=1}0==--u&&(u=Math.pow(2,m),m++),delete l[i]}else for(a=r[i],t=0;t<m;t++)f=f<<1|1&a,15==g?(g=0,d+=p(f),f=0):g++,a>>=1;0==--u&&(u=Math.pow(2,m),m++),r[c]=s++,i=String(o)}if(""!==i){if(Object.prototype.hasOwnProperty.call(l,i)){if(i.charCodeAt(0)<256){for(t=0;t<m;t++)f<<=1,15==g?(g=0,d+=p(f),f=0):g++;for(a=i.charCodeAt(0),t=0;t<8;t++)f=f<<1|1&a,15==g?(g=0,d+=p(f),f=0):g++,a>>=1}else{for(a=1,t=0;t<m;t++)f=f<<1|a,15==g?(g=0,d+=p(f),f=0):g++,a=0;for(a=i.charCodeAt(0),t=0;t<16;t++)f=f<<1|1&a,15==g?(g=0,d+=p(f),f=0):g++,a>>=1}0==--u&&(u=Math.pow(2,m),m++),delete l[i]}else for(a=r[i],t=0;t<m;t++)f=f<<1|1&a,15==g?(g=0,d+=p(f),f=0):g++,a>>=1;0==--u&&(u=Math.pow(2,m),m++)}for(a=2,t=0;t<m;t++)f=f<<1|1&a,15==g?(g=0,d+=p(f),f=0):g++,a>>=1;for(;;){if(f<<=1,15==g){d+=p(f);break}g++}return d},decompress:function(e){if(null==e)return"";if(""==e)return null;var t,a,n,r,l,o,c,i=[],u=4,s=4,m=3,d="",f="",g=ne._f,p={string:e,val:e.charCodeAt(0),position:32768,index:1};for(t=0;t<3;t+=1)i[t]=t;for(n=0,l=Math.pow(2,2),o=1;o!=l;)r=p.val&p.position,p.position>>=1,0==p.position&&(p.position=32768,p.val=p.string.charCodeAt(p.index++)),n|=(r>0?1:0)*o,o<<=1;switch(n){case 0:for(n=0,l=Math.pow(2,8),o=1;o!=l;)r=p.val&p.position,p.position>>=1,0==p.position&&(p.position=32768,p.val=p.string.charCodeAt(p.index++)),n|=(r>0?1:0)*o,o<<=1;c=g(n);break;case 1:for(n=0,l=Math.pow(2,16),o=1;o!=l;)r=p.val&p.position,p.position>>=1,0==p.position&&(p.position=32768,p.val=p.string.charCodeAt(p.index++)),n|=(r>0?1:0)*o,o<<=1;c=g(n);break;case 2:return""}for(i[3]=c,a=f=c;;){if(p.index>p.string.length)return"";for(n=0,l=Math.pow(2,m),o=1;o!=l;)r=p.val&p.position,p.position>>=1,0==p.position&&(p.position=32768,p.val=p.string.charCodeAt(p.index++)),n|=(r>0?1:0)*o,o<<=1;switch(c=n){case 0:for(n=0,l=Math.pow(2,8),o=1;o!=l;)r=p.val&p.position,p.position>>=1,0==p.position&&(p.position=32768,p.val=p.string.charCodeAt(p.index++)),n|=(r>0?1:0)*o,o<<=1;i[s++]=g(n),c=s-1,u--;break;case 1:for(n=0,l=Math.pow(2,16),o=1;o!=l;)r=p.val&p.position,p.position>>=1,0==p.position&&(p.position=32768,p.val=p.string.charCodeAt(p.index++)),n|=(r>0?1:0)*o,o<<=1;i[s++]=g(n),c=s-1,u--;break;case 2:return f}if(0==u&&(u=Math.pow(2,m),m++),i[c])d=i[c];else{if(c!==s)return null;d=a+a.charAt(0)}f+=d,i[s++]=a+d.charAt(0),a=d,0==--u&&(u=Math.pow(2,m),m++)}}}),re=function(e){var t=e.userObj,a=Object(n.useState)([]),l=Object(c.a)(a,2),o=l[0],i=l[1],u=Object(n.useState)([]),d=Object(c.a)(u,2),f=d[0],g=d[1],h=Object(n.useState)(!1),b=Object(c.a)(h,2),v=(b[0],b[1],Object(n.useState)(!1)),E=Object(c.a)(v,2),y=E[0],w=(E[1],Object(n.useState)(new Date)),O=Object(c.a)(w,2),j=O[0],S=(O[1],Object(n.useState)(!1)),x=Object(c.a)(S,2),C=x[0],k=x[1],R=Object(n.useState)(!1),D=Object(c.a)(R,2),I=D[0],F=D[1],T=Object(n.useState)(26586748e5),P=Object(c.a)(T,2),z=P[0],U=P[1],L=Object(n.useState)(100),B=Object(c.a)(L,2),A=B[0],M=B[1],N=Object(n.useState)(100),q=Object(c.a)(N,2),V=q[0],_=q[1],W=Object(n.useState)(!1),H=Object(c.a)(W,2),X=H[0],Y=H[1],J=Object(n.useState)(!1),G=Object(c.a)(J,2),Z=G[0],K=G[1],Q=Object(n.useState)(!1),$=Object(c.a)(Q,2),ne=$[0],re=$[1],le=Object(n.useState)("test"),oe=Object(c.a)(le,2),ce=oe[0],ie=oe[1];Object(n.useEffect)(function(){m.doc("usersetting/"+t.uid).get().then(function(e){e.exists?ie(e.data().Cmemo):console.log("No such setting document!")}).catch(function(e){console.log("Error getting document:",e)})},[]);Object(n.useEffect)(function(){m.collection("Csubmit").where("creatorId","==",t.uid).orderBy("createdAt","desc").where("createdAt","<",z+864e5).limit(V).onSnapshot(function(e){var t=e.docs.map(function(e){return Object(p.a)({id:e.id},e.data())});i(t)})},[z]);Object(n.useEffect)(function(){m.collection("Csubmitbook").where("creatorId","==",t.uid).orderBy("createdAt","desc").where("createdAt","<",z+864e5).limit(A).onSnapshot(function(e){var t=e.docs.map(function(e){return Object(p.a)({id:e.id},e.data())});g(t),console.log("bookmark loaded!")})},[I]);return r.a.createElement(r.a.Fragment,null,r.a.createElement("span",null,"Profile"),r.a.createElement("button",{onClick:function(){window.confirm("wanna logout?")&&s.signOut()}},"Log Out"),r.a.createElement("button",{onClick:function(){Y(function(e){return!e})}},"Calender"),X?r.a.createElement(r.a.Fragment,null,r.a.createElement(ae.a,{value:j,onClickDay:function(e){U(e.getTime()),console.log(e.getTime())},calendarType:"US"})):r.a.createElement(r.a.Fragment,null),r.a.createElement("input",{value:V,onChange:function(e){var t=e.target.value;_(t),console.log("ddd")},type:"number",placeholder:"Input Croquis Time"}),r.a.createElement("button",{onClick:function(){K(function(e){return!e})}},"Memo"),r.a.createElement("button",{onClick:function(){k(function(e){return!e}),I||F(!0)}},"Bookmark"),Z?r.a.createElement(r.a.Fragment,null,ne?r.a.createElement(r.a.Fragment,null,r.a.createElement("form",null,r.a.createElement("p",null,r.a.createElement("textarea",{onChange:function(e){var t=e.target.value;ie(t)},cols:"50",rows:"10"},ce)),r.a.createElement("p",null,r.a.createElement("input",{type:"submit",value:"Submit",onClick:function(e){e.preventDefault(),m.collection("usersetting").doc(t.uid).update({Cmemo:ce}),re(!1)}})))):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{whiteSpace:"pre-line",border:"10px solid rgba(0, 0, 0, 0.05)",padding:"10px"}},ce)),r.a.createElement("button",{onClick:function(){re(function(e){return!e})}},"edit")):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{whiteSpace:"pre-line",border:"10px solid rgba(0, 0, 0, 0.05)",padding:"10px"}},ce.substring(0,70))),C?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,f.map(function(e){return r.a.createElement(te,{CsubmitbookObj:e,isOwner:e.creatorId===t.uid,viewsToggle:y})})),r.a.createElement("div",null,r.a.createElement("button",{style:{float:"right",margin:"10px",marginRight:"500px",padding:"15px 30px"},onClick:function(){M(function(e){return e+100})}},"Next Page"))):r.a.createElement(r.a.Fragment,null),r.a.createElement("div",null,o.map(function(e){return r.a.createElement(ee,{CsubmitObj:e,isOwner:e.creatorId===t.uid,viewsToggle:y})})),r.a.createElement("div",null,r.a.createElement("button",{style:{float:"right",margin:"10px",marginRight:"500px",padding:"15px 30px"},onClick:function(){_(function(e){return e+100})}},"Next Page")))},le=function(){var e=Object(n.useState)(""),t=Object(c.a)(e,2),a=t[0],l=t[1],o=Object(n.useState)(""),i=Object(c.a)(o,2),u=i[0],m=i[1],d=Object(n.useState)(!1),f=Object(c.a)(d,2),g=f[0],p=(f[1],Object(n.useState)("")),h=Object(c.a)(p,2),E=h[0],y=h[1],w=function(e){var t=e.target,a=t.name,n=t.value;"email"===a?l(n):"password"===a&&m(n)},O=function(){var e=Object(v.a)(b.a.mark(function e(t){var n;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),e.prev=1,!g){e.next=5;break}e.next=8;break;case 5:return e.next=7,s.signInWithEmailAndPassword(a,u);case 7:n=e.sent;case 8:console.log(n),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),y(e.t0.message);case 14:case"end":return e.stop()}},e,null,[[1,11]])}));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",null,r.a.createElement("form",{onSubmit:O},r.a.createElement("input",{name:"email",type:"email",placeholder:"Email",required:!0,value:a,onChange:w}),r.a.createElement("input",{name:"password",type:"password",placeholder:"Password",required:!0,value:u,onChange:w}),r.a.createElement("input",{type:"submit",value:g?"Create Account":"Log In"}),E))},oe=a(27),ce=function(e){var t=e.userObj,a=e.isAndroid,l=(e.penType,Object(n.useState)("")),o=Object(c.a)(l,2),u=(o[0],o[1],Object(n.useState)([])),s=Object(c.a)(u,2),d=(s[0],s[1],Object(n.useState)([])),f=Object(c.a)(d,2),g=(f[0],f[1],Object(n.useRef)()),h=Object(n.useState)(""),b=Object(c.a)(h,2),v=b[0],E=b[1],y=Object(n.useState)([]),w=Object(c.a)(y,2),O=w[0],j=w[1],S=Object(n.useState)(0),x=Object(c.a)(S,2),C=x[0],k=x[1],R=Object(n.useState)(0),D=Object(c.a)(R,2),I=D[0],F=D[1],T=Object(n.useState)(0),P=Object(c.a)(T,2),z=P[0],U=P[1],L=Object(n.useState)(60),B=Object(c.a)(L,2),A=B[0],M=B[1],N=["all","mouse","touch","pen"],q=Object(n.useState)(3),V=Object(c.a)(q,2),_=V[0],W=V[1],H=Object(n.useState)(0),X=Object(c.a)(H,2),Y=X[0],J=X[1],G=Object(n.useState)(0),Z=Object(c.a)(G,2),K=Z[0],$=Z[1],ee=Object(n.useRef)(A),te=Object(n.useRef)(null),ae=Object(n.useState)({croquisTimeDB:60,brushRadius:1,lazyRadius:1,eraseRadius:10}),ne=Object(c.a)(ae,2),re=ne[0],le=ne[1],ce=Object(n.useState)(!1),ie=Object(c.a)(ce,2),ue=ie[0],se=ie[1],me=Object(n.useState)("#444"),de=Object(c.a)(me,2),fe=de[0],ge=de[1],pe=Object(n.useState)(!1),he=Object(c.a)(pe,2),be=he[0],ve=he[1],Ee=Object(n.useState)(!1),ye=Object(c.a)(Ee,2),we=ye[0],Oe=ye[1],je=Object(n.useState)(10),Se=Object(c.a)(je,2),xe=Se[0],Ce=Se[1],ke=Object(n.useState)(0),Re=Object(c.a)(ke,2),De=Re[0],Ie=Re[1],Fe=Object(n.useState)(!1),Te=Object(c.a)(Fe,2),Pe=Te[0],ze=Te[1],Ue=Object(n.useState)(1),Le=Object(c.a)(Ue,2),Be=Le[0],Ae=(Le[1],function(e){e.preventDefault(),k(C+1),F(I+1),Ie(0),ee.current=A}),Me=function(e){var t=_e(O);j(t)},Ne=function(e){m.collection("usersetting").doc(t.uid).update({brushRadius:re.brushRadius,lazyRadius:re.lazyRadius,croquisTimeDB:re.croquisTimeDB,eraseRadius:re.eraseRadius})},qe=function(){k(C+1);var e=0;void 0==localStorage.getItem("drawNum")?localStorage.setItem("drawNum",parseInt(0)):e=localStorage.getItem("drawNum"),localStorage.setItem("drawNum",parseInt(e)+1),U(parseInt(e)+1),localStorage.setItem("lastdrawtime",parseInt(Date.now())),F(I+1),ee.current=A;var a=g.current.getSaveData(),n=g.current.getDataURL();g.current.clear(),localStorage.setItem("redraw",""),m.collection("Csubmit").add({text:a,createdAt:Date.now(),creatorId:t.uid,drawingTime:A-60*Y-K,heart:0,dataUrl:n,refPinUrl:O[I]})},Ve=function(){var e=0;void 0==localStorage.getItem("drawNum")?localStorage.setItem("drawNum",parseInt(0)):e=localStorage.getItem("drawNum"),localStorage.setItem("drawNum",parseInt(e)+1),U(parseInt(e)+1),localStorage.setItem("lastdrawtime",parseInt(Date.now())),ee.current=A;var a=g.current.getSaveData(),n=g.current.getDataURL();g.current.clear(),m.collection("Csubmit").add({text:a,createdAt:Date.now(),creatorId:t.uid,drawingTime:A-60*Y-K,heart:0,dataUrl:n,refPinUrl:O[I]})};function _e(e){for(var t=e.length-1;t>0;t--){var a=Math.floor(Math.random()*(t+1)),n=[e[a],e[t]];e[t]=n[0],e[a]=n[1]}return e}Object(n.useEffect)(function(){return void 0==localStorage.getItem("drawNum")?(localStorage.setItem("drawNum",parseInt(0)),U(parseInt(0))):U(parseInt(localStorage.getItem("drawNum"))),void 0==localStorage.getItem("drawrepeat")?localStorage.setItem("drawrepeat",!1):ve(JSON.parse(localStorage.getItem("drawrepeat"))),void 0==localStorage.getItem("hidedraw")?localStorage.setItem("hidedraw",!1):Oe(JSON.parse(localStorage.getItem("hidedraw"))),void 0==localStorage.getItem("hidedrawsec")?localStorage.setItem("hidedrawsec",10):Ce(JSON.parse(localStorage.getItem("hidedrawsec"))),void 0!=localStorage.getItem("lastdrawtime")&&parseInt(Date.now())-parseInt(localStorage.getItem("lastdrawtime"))>216e5&&(localStorage.setItem("drawNum",parseInt(0)),U(parseInt(0))),m.doc("usersetting/"+t.uid).get().then(function(e){e.exists?(le({brushRadius:e.data().brushRadius,lazyRadius:e.data().lazyRadius,eraseRadius:e.data().eraseRadius,croquisTimeDB:e.data().croquisTimeDB}),M(e.data().croquisTimeDB),console.log(e.data()),console.log(A),ee.current+=e.data().croquisTimeDB-60):console.log("No such setting document!")}).catch(function(e){console.log("Error getting document:",e)}),W(parseInt(localStorage.getItem("penType"))),te.current=setInterval(function(){J(parseInt(ee.current/60)),$(ee.current%60),ee.current-=1},1e3),function(){return clearInterval(te.current)}},[]),Object(n.useEffect)(function(){ee.current<=-1&&qe(),ee.current==300-xe&&1==we&&ze(!0)},[K]),Object(n.useEffect)(function(){m.doc("RefDB/refStrings").get().then(function(e){if(e.exists){var t=_e(e.data().refUrl),a=localStorage.getItem("redraw");0!=a.length&&(a.includes("https://assets.pinterest.com/ext/embed.html?id=")?t.unshift(a.substring(47)):a.includes("https://firebasestorage.googleapis.com")&&t.unshift(a)),j(t)}else console.log("No such document!")}).catch(function(e){console.log("Error getting document:",e)})},[]);var We=function(e){e.preventDefault(),Ve()},He=function(e){e.preventDefault(),0==De&&1==be?(Ve(),Ie(function(e){return e+1}),ze(!0)):De==Be&&1==be?(qe(),Ie(0),ze(!1)):(qe(),ze(!1))},Xe=function(e){var t=e.target.value;M(t),le(function(t){return Object(p.a)({},t,{croquisTimeDB:e.target.value})})},Ye=function(e){e.preventDefault(),se(!1)},Je=function(e){e.preventDefault(),0==be?localStorage.setItem("drawrepeat",!0):localStorage.setItem("drawrepeat",!1),ve(function(e){return!e})},Ge=function(e){e.preventDefault(),0==we?localStorage.setItem("hidedraw",!0):localStorage.setItem("hidedraw",!1),Oe(function(e){return!e})},Ze=function(){m.doc("RefDB/refStrings").update({refUrl:i.a.firestore.FieldValue.arrayRemove(O[I])}),k(C+1),F(I+1)},Ke=function(){window.confirm("wanna clear this?")&&g.current.clear()},Qe=function(){g.current.undo()},$e=function(){ge("erase")},et=function(){ge("shadow")},tt=function(){ge("#444")};function at(e){var t=e%10,a=e%100;return 1==t&&11!=a?e+"st":2==t&&12!=a?e+"nd":3==t&&13!=a?e+"rd":e+"th"}function nt(e){return e<=9?"0"+e:e}return r.a.createElement(r.a.Fragment,null,r.a.createElement(oe.a,{keyName:"ctrl+z,c,x",onKeyDown:function(e,t,a){"ctrl+z"==e&&Qe(),"c"==e&&("erase"!=fe?$e():"erase"==fe&&tt()),"x"==e&&("shadow"!=fe?et():"shadow"==fe&&tt())}}),r.a.createElement("div",null,a?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{float:"right"}},ue?r.a.createElement(r.a.Fragment,null,r.a.createElement("form",{onSubmit:Ye},r.a.createElement("input",{value:A,onChange:Xe,type:"number",placeholder:"Input Croquis Time"}),r.a.createElement("input",{type:"submit",value:"Set Time"})),r.a.createElement("button",{onClick:Me},"random!"),r.a.createElement("button",{onClick:Ze},"Delete Pin"),r.a.createElement("button",{onClick:function(e){0==_?(W(3),localStorage.setItem("penType",parseInt(3))):3==_&&(W(0),localStorage.setItem("penType",parseInt(0)))}},N[_])):r.a.createElement(r.a.Fragment,null,at(z+1),r.a.createElement("button",{onClick:function(e){se(!0)}},"Set Time")),r.a.createElement("button",{onClick:Ne},"Update Setting"))):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{width:"1000px"}},r.a.createElement("div",{style:{float:"right"}},ue?r.a.createElement(r.a.Fragment,null,r.a.createElement("form",{onSubmit:Ye},r.a.createElement("input",{value:A,onChange:Xe,type:"number",placeholder:"Input Croquis Time"}),r.a.createElement("input",{type:"submit",value:"Set Time"})),r.a.createElement("button",{onClick:Me},"random!"),r.a.createElement("button",{onClick:Ze},"Delete Pin"),r.a.createElement("button",{onClick:function(e){0==_?(W(3),localStorage.setItem("penType",parseInt(3))):3==_&&(W(0),localStorage.setItem("penType",parseInt(0)))}},N[_])):r.a.createElement(r.a.Fragment,null,at(z+1),r.a.createElement("button",{onClick:function(e){se(!0)}},"Set Time")),r.a.createElement("button",{onClick:Ne},"Update Setting")))),a?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{float:"left",opacity:Pe?"0":"1"}},"string"==typeof O[I]&&O[I].includes("firebasestorage.googleapis.com")?r.a.createElement(r.a.Fragment,null,r.a.createElement("img",{src:O[I],width:300,frameBorder:0,scrolling:"no"})):r.a.createElement(r.a.Fragment,null,r.a.createElement("iframe",{key:C,src:"https://assets.pinterest.com/ext/embed.html?id="+O[I],height:450,width:300,frameBorder:0,scrolling:"no"}))),r.a.createElement("div",{style:{float:"left"}},r.a.createElement("button",{onClick:Je},"\ud83d\udd02",1==be&&r.a.createElement(r.a.Fragment,null,"\u2764")),r.a.createElement("button",{onClick:Ge},"\u23eb",1==be&&r.a.createElement(r.a.Fragment,null,"\u2764")),r.a.createElement("button",{onClick:function(e){ze(function(e){return!e})}},"\ud83d\udc41\ufe0f"))):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{float:"right"}},r.a.createElement("button",{onClick:Ke},"Clear Canvas")),r.a.createElement("div",{style:{float:"right"}},r.a.createElement("button",{onClick:We},"Upload&Redraw")),r.a.createElement("div",{style:{float:"right"}},r.a.createElement("button",{onClick:He},"Upload"),r.a.createElement("div",{style:{float:"left"}},r.a.createElement("button",{onClick:Ae},"Next"))),r.a.createElement("div",{style:{position:"absolute",left:"30%",transform:"translateX(-50%)",width:"70px",textAlign:"center",background:"linear-gradient(to left,#FFC365 "+100*(60*Y+K)/A+"%,#E8E8E8 "+100*(60*Y+K)/A+"%)"}},Y,": ",nt(K)),r.a.createElement("div",{style:{position:"absolute",left:"19%"}},r.a.createElement("button",{onClick:Je},"\ud83d\udd02",1==be&&r.a.createElement(r.a.Fragment,null,"\u2764")),r.a.createElement("button",{onClick:Ge},"\u23eb",1==we&&r.a.createElement(r.a.Fragment,null,"\u2764")),r.a.createElement("button",{onClick:function(e){ze(function(e){return!e})}},"\ud83d\udc41\ufe0f")),r.a.createElement("div",null,r.a.createElement("form",{onSubmit:function(e){if(e.preventDefault(),v.match(",")){var t=m.doc("RefDB/refStrings");v.split(",").forEach(function(e){console.log(e),t.update({refUrl:i.a.firestore.FieldValue.arrayUnion(e)})})}else v.length>1&&m.doc("RefDB/refStrings").update({refUrl:i.a.firestore.FieldValue.arrayUnion(v)});E("")}},r.a.createElement("input",{value:v,onChange:function(e){var t=e.target.value;E(t)},type:"text",placeholder:"You Can Upload Pinterst Pin By Url Number"}),r.a.createElement("input",{type:"submit",value:"Upload Pin"}))),r.a.createElement("div",{style:{float:"left",opacity:Pe?"0":"1"}},"string"==typeof O[I]&&O[I].includes("firebasestorage.googleapis.com")?r.a.createElement(r.a.Fragment,null,r.a.createElement("img",{src:O[I],width:400,frameBorder:0,scrolling:"no"})):r.a.createElement(r.a.Fragment,null,r.a.createElement("iframe",{key:C,src:"https://assets.pinterest.com/ext/embed.html?id="+O[I],height:770,width:400,frameBorder:0,scrolling:"no"})))),r.a.createElement("div",{style:{float:"left"}},r.a.createElement("div",null,a?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{float:"right"}},r.a.createElement("button",{onClick:Ke},"Clear")),r.a.createElement("div",{style:{float:"right"}},r.a.createElement("form",{onSubmit:We},r.a.createElement("input",{type:"submit",value:"Up&Re"}))),r.a.createElement("div",{style:{float:"right"}},r.a.createElement("form",{onSubmit:He},r.a.createElement("input",{type:"submit",value:"Up"}))),r.a.createElement("div",{style:{float:"right"}},r.a.createElement("button",{onClick:Ae},"\u21a6")),r.a.createElement("div",{style:{float:"right"}},Y,": ",nt(K))):r.a.createElement(r.a.Fragment,null),r.a.createElement("div",{style:{float:"right"}},r.a.createElement("label",null,"Lazy:"),r.a.createElement("input",{type:"number",min:"0",max:"100",style:{width:"30px"},value:re.lazyRadius,onChange:function(e){return le(function(t){return Object(p.a)({},t,{lazyRadius:e.target.value})})}})),r.a.createElement("div",{style:{float:"right"}},"erase"==fe?r.a.createElement(r.a.Fragment,null,r.a.createElement("label",null,"Erase Size:"),r.a.createElement("input",{type:"number",min:"1",max:"100",style:{width:"30px"},value:re.eraseRadius,onChange:function(e){return le(function(t){return Object(p.a)({},t,{eraseRadius:e.target.value})})}})):r.a.createElement(r.a.Fragment,null,r.a.createElement("label",null,"Brush Size:"),r.a.createElement("input",{type:"number",min:"1",max:"100",style:{width:"30px"},value:re.brushRadius,onChange:function(e){return le(function(t){return Object(p.a)({},t,{brushRadius:e.target.value})})}}))),r.a.createElement("div",{style:{float:"left"}},a?r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{style:{padding:"15px"},onClick:Qe},"\u25c0")):r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:Qe},"\u25c0"))),r.a.createElement("div",{style:{float:"left"}},"erase"==fe?r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:tt},"brush")):r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:$e},"erase"))),r.a.createElement("div",{style:{float:"left"}},"shadow"==fe?r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:tt},"brush")):r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:et},"shadow")),fe)),r.a.createElement("div",{style:{float:"right"}},r.a.createElement(Q,{canvasWidth:600,canvasHeight:600,brushRadius:"erase"==fe?re.eraseRadius:re.brushRadius,lazyRadius:re.lazyRadius,ref:g,brushColor:fe,allowOnlyPointerType:N[_]})))))},ie=function(e){var t=e.isAndroid;return r.a.createElement("nav",null,r.a.createElement("ul",null,t?r.a.createElement(r.a.Fragment,null,r.a.createElement("li",{style:{display:"inline",borderLeft:"1px solid #999",padding:"0 10px"}},r.a.createElement(g.b,{to:"/"},"Home")),r.a.createElement("li",{style:{display:"inline",borderLeft:"1px solid #999",padding:"0 10px"}},r.a.createElement(g.b,{to:"/profile"},"Draw")),r.a.createElement("li",{style:{display:"inline",borderLeft:"1px solid #999",padding:"0 10px"}},r.a.createElement(g.b,{to:"/doProko"},"Proko")),r.a.createElement("li",{style:{display:"inline",borderLeft:"1px solid #999",padding:"0 10px"}},r.a.createElement(g.b,{to:"/doSoty"},"Soty")),r.a.createElement("li",{style:{display:"inline",borderLeft:"1px solid #999",padding:"0 10px"}},r.a.createElement(g.b,{to:"/doManga"},"Manga")),r.a.createElement("li",{style:{display:"inline",borderLeft:"1px solid #999",padding:"0 10px"}},r.a.createElement(g.b,{to:"/doSakugaBooru"},"Sakuga")),r.a.createElement("li",{style:{display:"inline",borderLeft:"1px solid #999",padding:"0 10px"}},r.a.createElement(g.b,{to:"/special"},"Sp1")),r.a.createElement("li",{style:{display:"inline",borderLeft:"1px solid #999",padding:"0 10px"}},r.a.createElement(g.b,{to:"/special2"},"Sp2")),r.a.createElement("li",{style:{display:"inline",borderLeft:"1px solid #999",padding:"0 10px"}},r.a.createElement(g.b,{to:"/specialcopy"},"SC")),r.a.createElement("li",{style:{display:"inline",borderLeft:"1px solid #999",padding:"0 10px"}},r.a.createElement(g.b,{to:"/adorka"},"A")),r.a.createElement("li",{style:{display:"inline",borderLeft:"1px solid #999",padding:"0 10px"}},r.a.createElement(g.b,{to:"/lineofaction"},"L")),r.a.createElement("li",{style:{display:"inline",borderLeft:"1px solid #999",padding:"0 10px"}},r.a.createElement(g.b,{to:"/twitter"},"Twit")),r.a.createElement("li",{style:{display:"inline",borderLeft:"1px solid #999",padding:"0 10px"}},r.a.createElement(g.b,{to:"/chadesign"},"De")),r.a.createElement("li",{style:{display:"inline",borderLeft:"1px solid #999",padding:"0 10px"}},r.a.createElement(g.b,{to:"/chadesigndraw"},"DDraw")),r.a.createElement("li",{style:{display:"inline",borderLeft:"1px solid #999",padding:"0 10px"}},r.a.createElement(g.b,{to:"/360"},"360"))):r.a.createElement(r.a.Fragment,null,r.a.createElement("li",{style:{display:"inline",borderLeft:"1px solid #999",padding:"0 10px"}},r.a.createElement(g.b,{to:"/"},"Home")),r.a.createElement("li",{style:{display:"inline",borderLeft:"1px solid #999",padding:"0 10px"}},r.a.createElement(g.b,{to:"/profile"},"My Drawings")),r.a.createElement("li",{style:{display:"inline",borderLeft:"1px solid #999",padding:"0 10px"}},r.a.createElement(g.b,{to:"/doProko"},"Proko")),r.a.createElement("li",{style:{display:"inline",borderLeft:"1px solid #999",padding:"0 10px"}},r.a.createElement(g.b,{to:"/doSoty"},"Soty")),r.a.createElement("li",{style:{display:"inline",borderLeft:"1px solid #999",padding:"0 10px"}},r.a.createElement(g.b,{to:"/doManga"},"Manga")),r.a.createElement("li",{style:{display:"inline",borderLeft:"1px solid #999",padding:"0 10px"}},r.a.createElement(g.b,{to:"/doSakugaBooru"},"Sakuga")),r.a.createElement("li",{style:{display:"inline",borderLeft:"1px solid #999",padding:"0 10px"}},r.a.createElement(g.b,{to:"/special"},"Sp1")),r.a.createElement("li",{style:{display:"inline",borderLeft:"1px solid #999",padding:"0 10px"}},r.a.createElement(g.b,{to:"/special2"},"Sp2")),r.a.createElement("li",{style:{display:"inline",borderLeft:"1px solid #999",padding:"0 10px"}},r.a.createElement(g.b,{to:"/specialcopy"},"SC")),r.a.createElement("li",{style:{display:"inline",borderLeft:"1px solid #999",padding:"0 10px"}},r.a.createElement(g.b,{to:"/adorka"},"Adorka")),r.a.createElement("li",{style:{display:"inline",borderLeft:"1px solid #999",padding:"0 10px"}},r.a.createElement(g.b,{to:"/lineofaction"},"LineOfAction")),r.a.createElement("li",{style:{display:"inline",borderLeft:"1px solid #999",padding:"0 10px"}},r.a.createElement(g.b,{to:"/twitter"},"Twitter")),r.a.createElement("li",{style:{display:"inline",borderLeft:"1px solid #999",padding:"0 10px"}},r.a.createElement(g.b,{to:"/chadesign"},"Design")),r.a.createElement("li",{style:{display:"inline",borderLeft:"1px solid #999",padding:"0 10px"}},r.a.createElement(g.b,{to:"/chadesigndraw"},"DesignDraw")),r.a.createElement("li",{style:{display:"inline",borderLeft:"1px solid #999",padding:"0 10px"}},r.a.createElement(g.b,{to:"/360"},"360")))))},ue=function(e){var t=e.userObj,a=e.isAndroid,l=(e.penType,Object(n.useState)("")),o=Object(c.a)(l,2),i=(o[0],o[1]),u=Object(n.useState)([]),s=Object(c.a)(u,2),d=(s[0],s[1],Object(n.useState)(0)),f=Object(c.a)(d,2),g=f[0],h=f[1],b=Object(n.useRef)(),v=Object(n.useState)({brushRadius:.8,lazyRadius:0}),E=Object(c.a)(v,2),y=E[0],w=E[1],O=Object(n.useState)(0),j=Object(c.a)(O,2),S=j[0],x=j[1],C=Object(n.useState)(3),k=Object(c.a)(C,2),R=k[0],D=k[1],I=Object(n.useState)(["PLtG4P3lq8RHGuMuprDarMz_Y9Fbw_d2ws","PLTY4AtphBe8NS7WFIMIhHIBJVk3xQvi-q","PLTY4AtphBe8PSqfXT4qfxwdbLgSK0XZ9v","PLTY4AtphBe8P3zIOlyr7gEt176af-pp5R","PLtG4P3lq8RHFBeVaruf2JjyQmZJH4__Zv","PLHYRqaApAQGGCUm1mPME4HVOzay3OcTgH","PLVK1154-DZLrCyXFSobZ2SVisLGmmNapd","PLCjbbuVu6JIXNHzSp1G4a0rXd_r2wZTba","PLq1DbqqC6xIufAQUeYrC3ycbLcHIAxkWJ","PLCjbbuVu6JIVddbH_99oQFSQde_bpxWjc"]),F=Object(c.a)(I,2),T=F[0],P=(F[1],Object(n.useState)(["Proko","Hide 1","Hide 2","Hide 3","Proko anatomy","GES DRAW Party","Draw This","Saito naoki","Saito Croquis","Char Design"])),z=Object(c.a)(P,2),U=z[0],L=(z[1],Object(n.useState)([{name:"Proko",url:"PLtG4P3lq8RHGuMuprDarMz_Y9Fbw_d2ws"},{name:"Hide 1",url:"PLTY4AtphBe8NS7WFIMIhHIBJVk3xQvi"},{name:"Hide 2",url:"PLTY4AtphBe8PSqfXT4qfxwdbLgSK0XZ9v"},{name:"Hide 3",url:"PLTY4AtphBe8P3zIOlyr7gEt176af"},{name:"Proko anatomy",url:"PLtG4P3lq8RHFBeVaruf2JjyQmZJH4__Zv"},{name:"GES DRAW Party",url:"PLHYRqaApAQGGCUm1mPME4HVOzay3OcTgH"},{name:"Draw This",url:"DZLrCyXFSobZ2SVisLGmmNapd"},{name:"Saito naoki",url:"PLCjbbuVu6JIXNHzSp1G4a0rXd_r2wZTba"},{name:"Saito Croquis",url:"PLq1DbqqC6xIufAQUeYrC3ycbLcHIAxkWJ"},{name:"Char Design",url:"PLCjbbuVu6JIVddbH_99oQFSQde_bpxWjc"}])),B=Object(c.a)(L,2),A=B[0],M=(B[1],Object(n.useState)("#444")),N=Object(c.a)(M,2),q=N[0],V=N[1];Object(n.useEffect)(function(){m.doc("usersetting/"+t.uid).get().then(function(e){e.exists?w({brushRadius:e.data().brushRadius,lazyRadius:e.data().lazyRadius}):console.log("No such setting document!")}).catch(function(e){console.log("Error getting document:",e)}),D(parseInt(localStorage.getItem("penType")))},[]);var _=function(){b.current.undo()},W=function(){V("erase")},H=function(){V("#444")},X=function(){V("shadow")};return r.a.createElement(r.a.Fragment,null,r.a.createElement(oe.a,{keyName:"ctrl+z,c,x",onKeyDown:function(e,t,a){"ctrl+z"==e&&_(),"c"==e&&("erase"!=q?W():"erase"==q&&H()),"x"==e&&("shadow"!=q?X():"shadow"==q&&H())}}),r.a.createElement("div",null,r.a.createElement("div",{style:{float:"right"}}),r.a.createElement("div",null,r.a.createElement("label",null,"videos:"),r.a.createElement("input",{type:"number",min:"0",max:T.length-1,style:{width:"30px"},value:S,onChange:function(e){h(g+1),x(e.target.value)}}),r.a.createElement("button",{onClick:function(e){x(function(e){return e-1})}},"<"),r.a.createElement("button",{onClick:function(e){x(function(e){return e+1})}},">"),r.a.createElement("button",{onClick:function(e){h(g+1)}},"refresh"),U[S],r.a.createElement("select",{defaultValue:0,onChange:function(e){x(e.target.value),h(g+1)}},A.map(function(e,t){return r.a.createElement("option",{key:e.name,value:t},e.name)}))),r.a.createElement("div",{style:{float:"left"}},a?r.a.createElement(r.a.Fragment,null,r.a.createElement("iframe",{key:g,src:"https://www.youtube.com/embed/videoseries?list="+T[S]+"&cc_load_policy=1&cc_lang_pref=ko",height:450,width:600,frameBorder:0,scrolling:"no"})):r.a.createElement(r.a.Fragment,null,r.a.createElement("iframe",{key:g,src:"https://www.youtube.com/embed/videoseries?list="+T[S]+"&cc_load_policy=1&cc_lang_pref=ko",height:450,width:450,frameBorder:0,scrolling:"no"}))),r.a.createElement("div",{style:{float:"left"}},r.a.createElement("div",null,r.a.createElement("div",{style:{float:"right"}},r.a.createElement("label",null,"Lazy:"),r.a.createElement("input",{type:"number",min:"0",max:"100",style:{width:"30px"},value:y.lazyRadius,onChange:function(e){return w(function(t){return Object(p.a)({},t,{lazyRadius:e.target.value})})}})),r.a.createElement("div",{style:{float:"right"}},"erase"==q?r.a.createElement(r.a.Fragment,null,r.a.createElement("label",null,"Erase Size:"),r.a.createElement("input",{type:"number",min:"1",max:"100",style:{width:"30px"},value:y.eraseRadius,onChange:function(e){return w(function(t){return Object(p.a)({},t,{eraseRadius:e.target.value})})}})):r.a.createElement(r.a.Fragment,null,r.a.createElement("label",null,"Brush Size:"),r.a.createElement("input",{type:"number",min:"1",max:"100",style:{width:"30px"},value:y.brushRadius,onChange:function(e){return w(function(t){return Object(p.a)({},t,{brushRadius:e.target.value})})}}))),r.a.createElement("div",{style:{float:"right"}},r.a.createElement("button",{onClick:function(){window.confirm("wanna clear this?")&&b.current.clear()}},"Clear Canvas")),r.a.createElement("div",{style:{float:"right"}},a?r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{style:{padding:"15px"},onClick:_},"\u25c0")):r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:_},"\u25c0"))),r.a.createElement("div",{style:{float:"right"}},"erase"==q?r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:H},"brush")):r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:W},"erase")),r.a.createElement("div",{style:{float:"right"}},"shadow"==q?r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:H},"brush")):r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:X},"shadow")),q)),r.a.createElement("div",{style:{float:"right"}},r.a.createElement("button",{onClick:function(e){e.preventDefault(),function(){var e=b.current.getSaveData(),a=b.current.getDataURL();b.current.clear(),m.collection("Csubmit").add({text:e,createdAt:Date.now(),creatorId:t.uid,drawingTime:0,heart:0,dataUrl:a,refPinUrl:""}),i("")}()}},"Upload Drawing"))),r.a.createElement("div",{style:{float:"right"}},r.a.createElement(Q,{canvasWidth:600,canvasHeight:600,brushRadius:"erase"==q?y.eraseRadius:y.brushRadius,lazyRadius:y.lazyRadius,ref:b,brushColor:q,allowOnlyPointerType:["all","mouse","touch","pen"][R]})))))},se=a(47),me=a(50),de=a.n(me),fe=(a(78),{position:"absolute",zIndex:1e3}),ge=function(e){e.scale,e.minScale,e.maxScale,e.onZoomInClick,e.onZoomOutClick;return r.a.createElement("div",{style:fe})},pe={position:"absolute",marginTop:"40px",marginLeft:"5px",backgroundColor:"rgba(0,0,0,0)",zIndex:"1000",color:"white"},he=function(e){var t=e.top,a=e.left,n=e.scale,l=e.overflow,o=[l.top>0?"top":"",l.right>0?"right":"",l.bottom>0?"bottom":"",l.left>0?"left":""].filter(function(e){return e.length}).join(", ")||"none";return r.a.createElement("div",{style:pe},r.a.createElement("div",null,"top: ".concat(t)),r.a.createElement("div",null,"left: ".concat(a)),r.a.createElement("div",null,"scale: ".concat(n)),r.a.createElement("div",null,"overflow: ".concat(o)))},be=function(e,t,a){return Math.abs(t-e)<a?t:e},ve=function(e,t,a){return Math.min(t,Math.max(e,a))},Ee=function(e){return-1*e},ye=function(e,t){var a=e.clientX,n=e.clientY,r=t.getBoundingClientRect();return{x:a-r.left,y:n-r.top}},we=function(e){var t=Object(c.a)(e,2),a=t[0],n=t[1];return Math.sqrt(Math.pow(a.clientY-n.clientY,2)+Math.pow(a.clientX-n.clientX,2))};var Oe=function(e,t){return e===t===void 0||void 0!==e&&void 0!==t&&(e.width===t.width&&e.height===t.height)},je=function(e){if(void 0!==e)return{width:e.offsetWidth||e.width,height:e.offsetHeight||e.height}},Se=function(e,t){return e===t===void 0||void 0!==e&&void 0!==t&&(ke(e.top,5)===ke(t.top,5)&&ke(e.left,5)===ke(t.left,5)&&ke(e.scale,5)===ke(t.scale,5))},xe=function(e,t){var a=t||{},n=a.width,r=a.height;return n>0&&r>0?Math.min(e.width/n,e.height/r,1):1},Ce=Object(se.a)(function(e){return e.containerDimensions},function(e){return e.imageDimensions},function(e,t){return t.minScale},function(e,t,a){return"auto"===String(a).toLowerCase()?xe(e,t):a||1});function ke(e,t){if(t&&null!==e&&void 0!==e){var a=(String(e)+"e").split("e"),n=Math.round(a[0]+"e"+(+a[1]+t));return+((a=(String(n)+"e").split("e"))[0]+"e"+(+a[1]-t))}return Math.round(e)}var Re=function(e){return!1!==e.cancelable&&(e.preventDefault(),!0)};function De(e,t,a,n){var r=Ee(e);return r>0?r:0}function Ie(e,t,a,n){var r=Ee(e);return r>0?r:0}function Fe(e,t,a,n){var r=Math.max(0,t*a.width-n.width);return r>0?r-Ee(e):0}function Te(e,t,a,n){var r=Math.max(0,t*a.height-n.height);return r>0?r-Ee(e):0}var Pe=function(e,t,a,n,r){return{top:Ie(e),right:Fe(t,a,n,r),bottom:Te(e,a,n,r),left:De(t)}},ze=250,Ue=.1,Le=function(e,t,a){return void 0!==a&&void 0!==t&&void 0!==e},Be=Object(se.a)(function(e){return e.top},function(e){return e.left},function(e){return e.scale},function(e,t,a){var n={cursor:"pointer"};return Le(e,t,a)?Object(p.a)({},n,{transform:"translate3d(".concat(t,"px, ").concat(e,"px, 0) scale(").concat(a,")"),transformOrigin:"0 0"}):n}),Ae=Object(se.a)(function(e){return e.top},function(e){return e.left},function(e){return e.scale},function(e){return e.imageDimensions},function(e){return e.containerDimensions},function(e,t,a,n,r){return Le(e,t,a)?Pe(e,t,a,n,r):""}),Me=Object(se.a)(Ae,function(e){return[e.left||e.right?e.left?e.right?"":"pan-right":"pan-left":"pan-x",e.top||e.bottom?e.top?e.bottom?"":"pan-down":"pan-up":"pan-y"].join(" ").trim()}),Ne=function(e){function t(){var e,a;Object(y.a)(this,t);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return(a=Object(O.a)(this,(e=Object(j.a)(t)).call.apply(e,[this].concat(l)))).state={},a.handleTouchStart=function(e){a.cancelAnimation();var t=e.touches;2===t.length?(a.lastPinchLength=we(t),a.lastPanPointerPosition=null):1===t.length&&(a.lastPinchLength=null,a.pointerDown(t[0]),Re(e))},a.handleTouchMove=function(e){var t=e.touches;if(2===t.length)a.pinchChange(t),Re(e);else if(1===t.length){var n=a.pan(t[0]);if(!a.controlOverscrollViaCss){var r=Ae(a.state),l=n.left&&r.left>0||n.right&&r.right>0,o=n.up&&r.top>0||n.down&&r.bottom>0;if(!l&&!o)return;var c=n.left||n.right,i=n.up||n.down;if(i>2*c&&!o)return;if(c>2*i&&!l)return;Re(e)}}},a.handleTouchEnd=function(e){if(a.cancelAnimation(),0===e.touches.length&&1===e.changedTouches.length){if(a.lastPointerUpTimeStamp&&a.lastPointerUpTimeStamp+ze>e.timeStamp){var t=ye(e.changedTouches[0],a.imageRef.parentNode);a.doubleClick(t)}a.lastPointerUpTimeStamp=e.timeStamp,Re(e)}a.maybeAdjustCurrentTransform(Ue)},a.handleMouseDown=function(e){a.cancelAnimation(),a.pointerDown(e)},a.handleMouseMove=function(e){if(!e.buttons)return null;a.pan(e)},a.handleMouseDoubleClick=function(e){a.cancelAnimation();var t=ye(e,a.imageRef.parentNode);a.doubleClick(t)},a.handleMouseWheel=function(e){a.cancelAnimation();var t=ye(e,a.imageRef.parentNode);e.deltaY>0?a.state.scale>Ce(a.state,a.props)&&(a.zoomOut(t),Re(e)):e.deltaY<0&&a.state.scale<a.props.maxScale&&(a.zoomIn(t),Re(e))},a.handleImageLoad=function(e){a.debug("handleImageLoad"),a.isImageLoaded=!0,a.maybeHandleDimensionsChanged();var t=r.a.Children.only(a.props.children).props.onLoad;"function"===typeof t&&t(e)},a.handleZoomInClick=function(){a.cancelAnimation(),a.zoomIn()},a.handleZoomOutClick=function(){a.cancelAnimation(),a.zoomOut()},a.handleWindowResize=function(){return a.maybeHandleDimensionsChanged()},a.handleRefImage=function(e){a.imageRef&&(a.cancelAnimation(),a.imageRef.removeEventListener("touchmove",a.handleTouchMove)),a.imageRef=e,e&&a.imageRef.addEventListener("touchmove",a.handleTouchMove,{passive:!1}),function(e,t){"function"===typeof e?e(t):e&&(e.current=t)}(r.a.Children.only(a.props.children).ref,e)},a}return Object(S.a)(t,e),Object(w.a)(t,[{key:"pointerDown",value:function(e){this.lastPanPointerPosition=ye(e,this.imageRef.parentNode)}},{key:"pan",value:function(e){if(this.isTransformInitialized){if(!this.lastPanPointerPosition)return this.pointerDown(e),0;var t=ye(e,this.imageRef.parentNode),a=t.x-this.lastPanPointerPosition.x,n=t.y-this.lastPanPointerPosition.y;this.lastPanPointerPosition=t;var r=this.state.top+n,l=this.state.left+a;return this.constrainAndApplyTransform(r,l,this.state.scale,0,0),{up:n>0?n:0,down:n<0?Ee(n):0,right:a<0?Ee(a):0,left:a>0?a:0}}}},{key:"doubleClick",value:function(e){"zoom"===String(this.props.doubleTapBehavior).toLowerCase()&&1.05*this.state.scale<this.props.maxScale?this.zoomIn(e,Ue,.3):this.applyInitialTransform(Ue)}},{key:"pinchChange",value:function(e){var t=we(e),a=function(e){var t=Object(c.a)(e,2),a=t[0],n=t[1];return{x:(a.clientX+n.clientX)/2,y:(a.clientY+n.clientY)/2}}(e),n=this.lastPinchLength?this.state.scale*t/this.lastPinchLength:this.state.scale;this.zoom(n,a,.05),this.lastPinchLength=t}},{key:"zoomIn",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1;e=e||{x:this.state.containerDimensions.width/2,y:this.state.containerDimensions.height/2},this.zoom(this.state.scale*(1+a),e,0,t)}},{key:"zoomOut",value:function(e){e=e||{x:this.state.containerDimensions.width/2,y:this.state.containerDimensions.height/2},this.zoom(.9*this.state.scale,e,0)}},{key:"zoom",value:function(e,t,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(this.isTransformInitialized){var r=this.state,l=r.scale,o=r.top,c=r.left,i=t.y-o,u=t.x-c,s=this.getConstrainedScale(e,a),m=(s-l)/l,d=o-i*m,f=c-u*m;this.constrainAndApplyTransform(d,f,s,a,n)}}},{key:"maybeHandleDimensionsChanged",value:function(){var e,t=this;if(this.isImageReady){var a={width:(e=this.imageRef).parentNode.offsetWidth,height:e.parentNode.offsetHeight},n=je(this.imageRef);Oe(a,je(this.state.containerDimensions))&&Oe(n,je(this.state.imageDimensions))||(this.cancelAnimation(),this.setState({containerDimensions:a,imageDimensions:n},function(){t.isTransformInitialized?t.maybeAdjustCurrentTransform():t.applyInitialTransform()}),this.debug("Dimensions changed: Container: ".concat(a.width,", ").concat(a.height,", Image: ").concat(n.width,", ").concat(n.height)))}else this.debug("Image not loaded")}},{key:"constrainAndApplyTransform",value:function(e,t,a,n){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,l={top:e,left:t,scale:a};this.debug("Requesting transform: left ".concat(t,", top ").concat(e,", scale ").concat(a));var o=this.getCorrectedTransform(l,n)||l;return this.debug("Applying transform: left ".concat(o.left,", top ").concat(o.top,", scale ").concat(o.scale)),!Se(o,this.state)&&(this.applyTransform(o,r),!0)}},{key:"applyTransform",value:function(e,t){var a=this,n=e.top,r=e.left,l=e.scale;if(t>0){this.animation=requestAnimationFrame(function e(){var o=n-a.state.top,c=r-a.state.left,i=l-a.state.scale,u={top:be(a.state.top+t*o,n,1),left:be(a.state.left+t*c,r,1),scale:be(a.state.scale+t*i,l,.001)};Se(u,a.state)||a.setState(u,function(){return a.animation=requestAnimationFrame(e)})})}else this.setState({top:n,left:r,scale:l})}},{key:"getConstrainedScale",value:function(e,t){var a=1-t,n=1+t;return ve(Ce(this.state,this.props)*a,this.props.maxScale*n,e)}},{key:"getCorrectedTransform",value:function(e,t){var a=this.getConstrainedScale(e.scale,t),n=this.calculateNegativeSpace(a),r={width:Math.max(0,Ee(n.width)),height:Math.max(0,Ee(n.height))},l=this.props,o=l.position,c=l.initialTop,i=l.initialLeft,u=this.state,s=u.imageDimensions,m=u.containerDimensions,d=1+t,f={top:r.height?ve(Ee(r.height)*d,r.height*d-r.height,e.top):"center"===o?(m.height-s.height*a)/2:c||0,left:r.width?ve(Ee(r.width)*d,r.width*d-r.width,e.left):"center"===o?(m.width-s.width*a)/2:i||0,scale:a};return Se(f,e)?null:f}},{key:"maybeAdjustCurrentTransform",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;(e=this.getCorrectedTransform(this.state,0))&&this.applyTransform(e,t)}},{key:"applyInitialTransform",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,a=this.state,n=a.imageDimensions,r=a.containerDimensions,l=this.props,o=l.position,c=l.initialScale,i=l.maxScale,u=l.initialTop,s=l.initialLeft,m="auto"===String(c).toLowerCase()?xe(r,n):c,d=Ce(this.state,this.props);d>i?de()(!1,"minScale cannot exceed maxScale."):m<d||m>i?de()(!1,"initialScale must be between minScale and maxScale."):("center"===o?(de()(void 0===u,"initialTop prop should not be supplied with position=center. It was ignored."),de()(void 0===s,"initialLeft prop should not be supplied with position=center. It was ignored."),e={top:(r.width-n.width*m)/2,left:(r.height-n.height*m)/2}):e={top:u||0,left:s||0},this.constrainAndApplyTransform(e.top,e.left,m,0,t))}},{key:"render",value:function(){var e=r.a.Children.only(this.props.children),t=this.props,a=t.zoomButtons,n=t.maxScale,l=t.debug,o=this.state.scale,c={width:"100%",height:"100%",overflow:"hidden",touchAction:this.controlOverscrollViaCss?Me(this.state)||"none":void 0};return r.a.createElement("div",{style:c},a&&this.isImageReady&&this.isTransformInitialized&&r.a.createElement(ge,{scale:o,minScale:Ce(this.state,this.props),maxScale:n,onZoomOutClick:this.handleZoomOutClick,onZoomInClick:this.handleZoomInClick}),l&&r.a.createElement(he,Object.assign({},this.state,{overflow:Ae(this.state)})),r.a.cloneElement(e,{onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onMouseDown:this.handleMouseDown,onMouseMove:this.handleMouseMove,onDoubleClick:this.handleMouseDoubleClick,onWheel:this.handleMouseWheel,onDragStart:Re,onLoad:this.handleImageLoad,onContextMenu:Re,ref:this.handleRefImage,style:Be(this.state)}))}},{key:"componentDidMount",value:function(){window.addEventListener("resize",this.handleWindowResize),this.maybeHandleDimensionsChanged()}},{key:"componentDidUpdate",value:function(e,t){this.maybeHandleDimensionsChanged()}},{key:"componentWillUnmount",value:function(){this.cancelAnimation(),this.imageRef.removeEventListener("touchmove",this.handleTouchMove),window.removeEventListener("resize",this.handleWindowResize)}},{key:"calculateNegativeSpace",value:function(e){var t=this.state,a=t.containerDimensions,n=t.imageDimensions;return{width:a.width-e*n.width,height:a.height-e*n.height}}},{key:"cancelAnimation",value:function(){this.animation&&cancelAnimationFrame(this.animation)}},{key:"debug",value:function(e){this.props.debug&&console.log(e)}},{key:"isImageReady",get:function(){return this.isImageLoaded||this.imageRef&&"IMG"!==this.imageRef.tagName}},{key:"isTransformInitialized",get:function(){return Le(this.state.top,this.state.left,this.state.scale)}},{key:"controlOverscrollViaCss",get:function(){return window.CSS&&window.CSS.supports("touch-action","pan-up")}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.initialTop!==t.initialTop||e.initialLeft!==t.initialLeft||e.initialScale!==t.initialScale||e.position!==t.position?{position:e.position,initialScale:e.initialScale,initialTop:e.initialTop,initialLeft:e.initialLeft}:null}}]),t}(r.a.Component);Ne.defaultProps={initialScale:"auto",minScale:"auto",maxScale:1,position:"topLeft",zoomButtons:!0,doubleTapBehavior:"reset"};var qe=function(e){var t=e.userObj,a=e.isAndroid,l=(e.penType,Object(n.useState)("")),o=Object(c.a)(l,2),u=(o[0],o[1]),s=Object(n.useState)(0),d=Object(c.a)(s,2),f=d[0],g=d[1],h=Object(n.useRef)(),b=Object(n.useState)({brushRadius:1,lazyRadius:0}),v=Object(c.a)(b,2),E=v[0],y=v[1],w=Object(n.useState)([]),O=Object(c.a)(w,2),j=(O[0],O[1],Object(n.useState)([])),S=Object(c.a)(j,2),x=(S[0],S[1],Object(n.useState)(0)),C=Object(c.a)(x,2),k=C[0],R=C[1],D=Object(n.useState)(0),I=Object(c.a)(D,2),F=I[0],T=I[1],P=Object(n.useState)(0),z=Object(c.a)(P,2),U=(z[0],z[1]),L=Object(n.useState)([]),B=Object(c.a)(L,2),A=B[0],M=B[1],N=Object(n.useState)([]),q=Object(c.a)(N,2),V=q[0],_=q[1],W=Object(n.useState)(3),H=Object(c.a)(W,2),X=H[0],Y=H[1],J=Object(n.useState)("#444"),G=Object(c.a)(J,2),Z=G[0],K=G[1],$=Object(n.useState)(!1),ee=Object(c.a)($,2),te=ee[0],ae=ee[1],ne=Object(n.useState)(!1),re=Object(c.a)(ne,2),le=re[0],ce=re[1],ie=Object(n.useState)(!1),ue=Object(c.a)(ie,2),se=ue[0],me=ue[1],de=Object(n.useState)(!1),fe=Object(c.a)(de,2),ge=fe[0],pe=fe[1],he=Object(n.useState)(0),be=Object(c.a)(he,2),ve=be[0],Ee=be[1],ye=Object(n.useState)(0),we=Object(c.a)(ye,2),Oe=we[0],je=we[1],Se=Object(n.useState)(300),xe=Object(c.a)(Se,2),Ce=xe[0],ke=xe[1],Re=Object(n.useRef)(Ce),De=Object(n.useRef)(null),Ie=Object(n.useState)(""),Fe=Object(c.a)(Ie,2),Te=Fe[0],Pe=Fe[1];function ze(e){if(!e.includes("pinterest"))return"";var t=e.split("/");return t[t.length-2]}Object(n.useEffect)(function(){function e(e){e.data&&"updateCustomUrl"===e.data.action&&(console.log("\ub428?>"),Pe(e.data.customUrl))}return window.addEventListener("message",e),function(){window.removeEventListener("message",e)}},[]),Object(n.useEffect)(function(){return null!=localStorage.getItem(2)&&ke(JSON.parse(localStorage.getItem(2))),Y(parseInt(localStorage.getItem("penType"))),De.current=setInterval(function(){Ee(parseInt(Re.current/60)),je(Re.current%60),Re.current-=1},1e3),function(){return clearInterval(De.current)}},[]),Object(n.useEffect)(function(){Re.current<=-1&&te&&(Be(),Ue())},[Oe]);var Ue=function(){T(Math.floor(Math.random()*A.length)+1)};Object(n.useEffect)(function(){void 0==localStorage.getItem("sotyset")?localStorage.setItem("sotyset",!1):me(JSON.parse(localStorage.getItem("sotyset")));var e=0;void 0==localStorage.getItem("sotywhoset")?localStorage.setItem("sotywhoset",0):(R(JSON.parse(localStorage.getItem("sotywhoset"))),e=JSON.parse(localStorage.getItem("sotywhoset"))),m.doc("usersetting/"+t.uid).get().then(function(e){e.exists?(y({brushRadius:e.data().brushRadius,lazyRadius:e.data().lazyRadius,sotyIndex:e.data().sotyIndex,yoshinariIndex:e.data().yoshinariIndex}),T(e.data().sotyIndex),U(e.data().yoshinariIndex),console.log(e.data())):console.log("No such setting document!")}).catch(function(e){console.log("Error getting document:",e)}),m.doc("RefDB/soty").get().then(function(t){if(t.exists){var a=t.data().refUrl;0==e?M(a):(_(a),console.log("soty is temp"))}else console.log("No such document!")}).catch(function(e){console.log("Error getting document:",e)}),m.doc("RefDB/refStrings2").get().then(function(t){if(t.exists){var a=t.data().yoshinari;1==e?M(a):(_(a),console.log("you is temp"))}else console.log("No such document!")}).catch(function(e){console.log("Error getting document:",e)})},[]);var Le,Be=function(){te&&(Re.current=Ce),m.collection("usersetting").doc(t.uid).update({sotyIndex:F});var e=h.current.getSaveData(),a=h.current.getDataURL();(h.current.clear(),""!=Te)?(m.collection("Csubmit").add({text:e,createdAt:Date.now(),creatorId:t.uid,drawingTime:0,heart:0,dataUrl:a,refPinUrl:ze(Te),sotyIndex:F}),m.doc("RefDB/refStrings2").update({refUrl2:i.a.firestore.FieldValue.arrayUnion(ze(Te))})):m.collection("Csubmit").add({text:e,createdAt:Date.now(),creatorId:t.uid,drawingTime:0,heart:0,dataUrl:a,refPinUrl:A[F],sotyIndex:F});Pe(""),u(""),te&&Ue()},Ae=function(){h.current.undo()},Me=function(){K("erase")},qe=function(){K("#444")},Ve=function(){K("shadow")};return r.a.createElement(r.a.Fragment,null,r.a.createElement(oe.a,{keyName:"ctrl+z,c,x,a,s",onKeyDown:function(e,t,a){"ctrl+z"==e&&Ae(),"c"==e&&("erase"!=Z?Me():"erase"==Z&&qe()),"x"==e&&("shadow"!=Z?Ve():"shadow"==Z&&qe()),"a"==e&&F>0&&T(function(e){return e-1}),"s"==e&&F<A.length-1&&T(function(e){return e+1})}}),r.a.createElement("div",null,te?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{position:"absolute",left:"50%",transform:"translateX(-50%)",width:"70px",textAlign:"center",background:"linear-gradient(to left,#FFC365 "+100*(60*ve+Oe)/Ce+"%,#E8E8E8 "+100*(60*ve+Oe)/Ce+"%)"}},ve,": ",(Le=Oe)<=9?"0"+Le:Le)):r.a.createElement(r.a.Fragment,null),r.a.createElement("div",{style:{float:"right"}}),r.a.createElement("div",null,r.a.createElement("label",null,"pages:"),r.a.createElement("input",{type:"number",min:"0",max:A?A.length-1:0,style:{width:"40px"},value:F,onChange:function(e){T(e.target.value),g(f+1)}}),r.a.createElement("button",{onClick:function(e){e.preventDefault(),F>0&&T(function(e){return e-1})}},"<"),r.a.createElement("button",{onClick:function(e){e.preventDefault(),F<A.length-1&&T(function(e){return e+1})}},">"),r.a.createElement("button",{onClick:function(e){ae(function(e){return!e}),Re.current=Ce}},"random ",te?r.a.createElement(r.a.Fragment,null,"on"):r.a.createElement(r.a.Fragment,null,"off")),r.a.createElement("button",{onClick:function(e){ce(function(e){return!e})}},"Extend"),r.a.createElement("button",{onClick:function(e){me(function(e){return!e}),console.log("\uc628",se),Pe(""),localStorage.setItem("sotyset",!se)}},"Drawing Only"),r.a.createElement("button",{onClick:function(e){pe(function(e){return!e})}},"Ex draw"),r.a.createElement("button",{onClick:function(){0==k?localStorage.setItem("sotywhoset",1):localStorage.setItem("sotywhoset",0),R(0==k?1:0);var e=A;M(V),_(e)}},0==k?r.a.createElement(r.a.Fragment,null,"soty"):r.a.createElement(r.a.Fragment,null,"you")),r.a.createElement("div",{style:{float:"right"}},te?r.a.createElement(r.a.Fragment,null,r.a.createElement("input",{value:Ce,onChange:function(e){var t=e.target.value;ke(t),localStorage.setItem(2,t)},type:"number",placeholder:"Time"}),"Set Time"):r.a.createElement(r.a.Fragment,null))),r.a.createElement("div",{style:{float:"left"}},a?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{width:"600px",height:"450px"}},r.a.createElement(Ne,null,r.a.createElement("img",{alt:"Test Image",src:"string"==typeof A[F]&&A[F].startsWith("pot.com/o/")?"https://firebasestorage.googleapis.com/v0/b/croquistool.apps"+A[F]:A[F]})))):r.a.createElement(r.a.Fragment,null,se?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{width:"1px",height:"770px"}},r.a.createElement(Ne,null,r.a.createElement("img",{alt:"Test Image",src:"string"==typeof A[F]&&A[F].startsWith("pot.com/o/")?"https://firebasestorage.googleapis.com/v0/b/croquistool.apps"+A[F]:A[F]})))):r.a.createElement(r.a.Fragment,null,le?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{width:"850px",height:"770px"}},r.a.createElement(Ne,null,r.a.createElement("img",{alt:"Test Image",src:"string"==typeof A[F]&&A[F].startsWith("pot.com/o/")?"https://firebasestorage.googleapis.com/v0/b/croquistool.apps"+A[F]:A[F]})))):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{width:"450px",height:"770px"}},r.a.createElement(Ne,null,r.a.createElement("img",{alt:"Test Image",src:"string"==typeof A[F]&&A[F].startsWith("pot.com/o/")?"https://firebasestorage.googleapis.com/v0/b/croquistool.apps"+A[F]:A[F]}))))))),r.a.createElement("div",{style:{float:"left"}},r.a.createElement("div",null,r.a.createElement("div",{style:{float:"right"}},r.a.createElement("label",null,"Lazy:"),r.a.createElement("input",{type:"number",min:"0",max:"100",style:{width:"30px"},value:E.lazyRadius,onChange:function(e){return y(function(t){return Object(p.a)({},t,{lazyRadius:e.target.value})})}})),r.a.createElement("div",{style:{float:"right"}},"erase"==Z?r.a.createElement(r.a.Fragment,null,r.a.createElement("label",null,"Erase Size:"),r.a.createElement("input",{type:"number",min:"1",max:"100",style:{width:"30px"},value:E.eraseRadius,onChange:function(e){return y(function(t){return Object(p.a)({},t,{eraseRadius:e.target.value})})}})):r.a.createElement(r.a.Fragment,null,r.a.createElement("label",null,"Brush Size:"),r.a.createElement("input",{type:"number",min:"1",max:"100",style:{width:"30px"},value:E.brushRadius,onChange:function(e){return y(function(t){return Object(p.a)({},t,{brushRadius:e.target.value})})}}))),r.a.createElement("div",{style:{float:"right"}},r.a.createElement("button",{onClick:function(){window.confirm("wanna clear this?")&&h.current.clear()}},"Clear Canvas")),r.a.createElement("div",{style:{float:"right"}},a?r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{style:{padding:"15px"},onClick:Ae},"\u25c0")):r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:Ae},"\u25c0"))),r.a.createElement("div",{style:{float:"right"}},"erase"==Z?r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:qe},"brush")):r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:Me},"erase")),r.a.createElement("div",{style:{float:"right"}},"shadow"==Z?r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:qe},"brush")):r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:Ve},"shadow")),Z)),r.a.createElement("div",{style:{float:"right"}},r.a.createElement("button",{onClick:function(e){e.preventDefault(),Be()}},"Upload Drawing"))),r.a.createElement("div",{style:{float:"right"}},r.a.createElement(Q,{enablePanAndZoom:!0,canvasWidth:ge?1e3:600,canvasHeight:600,brushRadius:"erase"==Z?E.eraseRadius:E.brushRadius,lazyRadius:E.lazyRadius,ref:h,brushColor:Z,allowOnlyPointerType:["all","mouse","touch","pen"][X]}))),se&&r.a.createElement(r.a.Fragment,null," ",r.a.createElement("input",{style:{width:"240px"},value:Te,onChange:function(e){Pe(e.target.value)}}))))},Ve=a(40),_e=(a(133),a(134),Ve.default.getComponent("Button")),We=Ve.default.extend(_e,{constructor:function(e,t){_e.call(this,e,t),this.player=e,this.frameTime=1/t.fps,this.step_size=t.value,this.on("click",this.onClick)},onClick:function(){this.player.pause();var e=this.frameTime*this.step_size;this.player.currentTime(this.player.currentTime()+e)}});var He=function(e){var t=this;t.ready(function(){e.steps.forEach(function(a){t.controlBar.addChild(new We(t,{el:Ve.default.dom.createEl("button",{className:"vjs-res-button vjs-control",innerHTML:'<div class="vjs-control-content"><span class="vjs-fbf">'+a.text+"</span></div>"},{role:"button"}),value:a.step,fps:e.fps}),{},a.index)})})},Xe=function(e){function t(){return Object(y.a)(this,t),Object(O.a)(this,Object(j.a)(t).apply(this,arguments))}return Object(S.a)(t,e),Object(w.a)(t,[{key:"componentDidMount",value:function(){(Ve.default.registerPlugin||Ve.default.plugin)("framebyframe",He),this.player=Object(Ve.default)(this.videoNode,this.props,function(){console.log("onPlayerReady",this)}),this.player.addClass("vjs-matrix")}},{key:"componentWillUnmount",value:function(){this.player&&this.player.dispose()}},{key:"componentWillReceiveProps",value:function(e){if(e.videoUrl!==this.props.videoUrl){this.player.dispose();var t={autoplay:!0,controls:!0,sources:[{src:this.props.videoUrl,type:"video/mp4"}]};this.player=Object(Ve.default)(this.videoNode,t,this.props,function(){console.log("onPlayerReady",this)})}}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{"data-vjs-player":!0},r.a.createElement("video",{ref:function(t){return e.videoNode=t},className:"video-js"}))}}]),t}(r.a.Component),Ye=(a(135),a(136),function(e){var t=e.userObj,a=e.isAndroid,l=(e.penType,Object(n.useState)("")),o=Object(c.a)(l,2),i=o[0],u=o[1],s=Object(n.useState)(""),f=Object(c.a)(s,2),g=f[0],h=f[1],b=Object(n.useState)(1),v=Object(c.a)(b,2),E=v[0],y=v[1],w=Object(n.useState)(0),O=Object(c.a)(w,2),j=O[0],S=O[1],x=Object(n.useState)([]),C=Object(c.a)(x,2),k=C[0],R=C[1],D=Object(n.useState)([]),I=Object(c.a)(D,2),F=I[0],T=I[1],P=Object(n.useState)([]),z=Object(c.a)(P,2),U=z[0],L=z[1],B=Object(n.useState)([]),A=Object(c.a)(B,2),M=A[0],N=A[1],q=Object(n.useState)(""),V=Object(c.a)(q,2),_=V[0],W=V[1],H=Object(n.useState)([]),X=Object(c.a)(H,2),Y=X[0],J=X[1],G=Object(n.useState)([]),Z=Object(c.a)(G,2),K=Z[0],$=Z[1],ee=Object(n.useState)([]),te=Object(c.a)(ee,2),ae=te[0],ne=te[1],re=Object(n.useState)(450),le=Object(c.a)(re,2),ce=le[0],ie=le[1],ue=Object(n.useState)(!0),se=Object(c.a)(ue,2),me=se[0],de=se[1],fe=Object(n.useState)(!1),ge=Object(c.a)(fe,2),pe=ge[0],he=ge[1],be=Object(n.useState)(!0),ve=Object(c.a)(be,2),Ee=ve[0],ye=ve[1],we=Object(n.useState)(""),Oe=Object(c.a)(we,2),je=Oe[0],Se=Oe[1],xe=Object(n.useState)(3),Ce=Object(c.a)(xe,2),ke=Ce[0],Re=Ce[1],De=function(e){u(e.target.value),S(200)};Object(n.useEffect)(function(){var e=i.replace(" ","_"),t=F.filter(function(t){return t.name.toLowerCase().includes(e.toLowerCase())});Se("load tag!"),""!=i&&R(t)},[i]);var Ie=Object(n.useState)(""),Fe=Object(c.a)(Ie,2),Te=(Fe[0],Fe[1]),Pe=Object(n.useState)([]),ze=Object(c.a)(Pe,2),Ue=ze[0],Le=(ze[1],Object(n.useState)(0)),Be=Object(c.a)(Le,2),Ae=Be[0],Me=Be[1],Ne=Object(n.useState)(0),qe=Object(c.a)(Ne,2),Ve=qe[0],_e=qe[1],We=Object(n.useRef)(),He=Object(n.useState)({brushRadius:.8,lazyRadius:0}),Ye=Object(c.a)(He,2),Je=Ye[0],Ge=Ye[1],Ze=Object(n.useState)(0),Ke=Object(c.a)(Ze,2),Qe=Ke[0],$e=Ke[1],et=Object(n.useState)(["PLtG4P3lq8RHGuMuprDarMz_Y9Fbw_d2ws","PLTY4AtphBe8NS7WFIMIhHIBJVk3xQvi-q","PLTY4AtphBe8PSqfXT4qfxwdbLgSK0XZ9v","PLTY4AtphBe8P3zIOlyr7gEt176af-pp5R","PLtG4P3lq8RHFBeVaruf2JjyQmZJH4__Zv","PLHYRqaApAQGGCUm1mPME4HVOzay3OcTgH"]),tt=Object(c.a)(et,2),at=tt[0],nt=(tt[1],Object(n.useState)("#444")),rt=Object(c.a)(nt,2),lt=rt[0],ot=rt[1];Object(n.useRef)();Object(n.useEffect)(function(){Re(parseInt(localStorage.getItem("penType"))),a&&ie(600),m.doc("usersetting/"+t.uid).get().then(function(e){e.exists?(Ge({brushRadius:e.data().brushRadius,lazyRadius:e.data().lazyRadius}),fetch(e.data().sakuga).then(function(e){return e.json()}).then(function(e){T(e),Se("load tag..")}).catch(function(e){console.error("Error fetching JSON data:",e),Se("error load tag")}),fetch("https://firebasestorage.googleapis.com/v0/b/croquistool.appspot.com/o/randomtag.json?alt=media&token=ca3aa7d5-0428-4727-b470-8539f90087cc").then(function(e){return e.json()}).then(function(e){var t=function(e){for(var t=e.length-1;t>0;t--){var a=Math.floor(Math.random()*(t+1)),n=[e[a],e[t]];e[t]=n[0],e[a]=n[1]}return e}(e);ne(t),console.log("get randomlist")}).catch(function(e){console.error("Error fetching random JSON data:",e),Se("error load tag")})):console.log("No such setting document!")}).catch(function(e){console.log("Error getting document:",e)}),ye(JSON.parse(localStorage.getItem(1)))},[]);var ct=function(e){e.preventDefault(),he(!1),it()},it=function(){Ee?fetch("https://jolly-hall-d8e3.ddcmyk.workers.dev/?https://www.sakugabooru.com/post.json?page=".concat(E,"&tags=").concat(i)).then(function(e){if(e.ok)return e.json()}).then(function(e){console.log("\uc131\uacf5:",e),console.log(typeof e),"object"==typeof e&&L(e)}).catch(function(e){console.log(e)}):fetch("https://www.sakugabooru.com/post.json?page=".concat(E,"&tags=").concat(i)).then(function(e){if(e.ok)return e.json()}).then(function(e){console.log("\uc131\uacf5:",e),console.log(typeof e),"object"==typeof e&&L(e)}).catch(function(e){console.log(e)})},ut=function(e){e.preventDefault(),y(function(e){return e-1}),it()},st=function(e){e.preventDefault(),y(function(e){return e+1}),it()},mt=function(e){e.preventDefault(),he(!pe),me&&m.collection("sakugaBookmark").where("creatorId","==",t.uid).orderBy("createdAt","desc").limit(50).onSnapshot(function(e){var t=e.docs.map(function(e){return Object(p.a)({id:e.id},e.data())});$(t),console.log(Ue),de(!1)})},dt=function(e){e.preventDefault(),window.confirm("wanna bookmark this?")&&m.collection("sakugaBookmark").add({DimgUrl:Y[0],DvideoUrl:Y[1],Dtag:Y[2],creatorId:t.uid,createdAt:Date.now(),Did:Y[3]})},ft=function(){We.current.undo()},gt=function(){ot("erase")},pt=function(){ot("#444")},ht=function(){ot("shadow")},bt={autoplay:!1,playbackRates:[.2,.4,.6,.8,1],width:ce,controls:!0,controlBar:{pictureInPictureToggle:!1,fullscreenToggle:!1},plugins:{framebyframe:{fps:23.976024,steps:[{text:"< 1f",step:-1},{text:"1f >",step:1}]},hotkeys:{seekStep:1/23.976024,enableModifiersForNumbers:!1,customKeys:{DforwardKey:{key:function(e){return 68===e.which},handler:function(e,t,a){e.pause(),e.currentTime(e.currentTime()+1/23.976024)}},SrewindKey:{key:function(e){return 83===e.which},handler:function(e,t,a){e.pause(),e.currentTime(e.currentTime()-1/23.976024)}},E1forwardKey:{key:function(e){return 69===e.which},handler:function(e,t,a){e.pause(),e.currentTime(e.currentTime()+1)}},W1rewindKey:{key:function(e){return 87===e.which},handler:function(e,t,a){e.pause(),e.currentTime(e.currentTime()-1)}},R5forwardKey:{key:function(e){return 82===e.which},handler:function(e,t,a){e.pause(),e.currentTime(e.currentTime()+5)}},Q5rewindKey:{key:function(e){return 81===e.which},handler:function(e,t,a){e.pause(),e.currentTime(e.currentTime()-5)}}}}},sources:[{src:g}]};return r.a.createElement(r.a.Fragment,null,r.a.createElement(oe.a,{keyName:"ctrl+z,c,x",onKeyDown:function(e,t,a){"ctrl+z"==e&&ft(),"c"==e&&("erase"!=lt?gt():"erase"==lt&&pt()),"x"==e&&("shadow"!=lt?ht():"shadow"==lt&&pt())}}),r.a.createElement("div",null,r.a.createElement("div",{style:{float:"right"}}),r.a.createElement("div",null,r.a.createElement("label",null,"videos:"),r.a.createElement("input",{type:"number",min:"0",max:at.length-1,style:{width:"30px"},value:Qe,onChange:function(e){$e(e.target.value),Me(Ae+1)}}),je,r.a.createElement("button",{style:{float:"right",left:"-50%",position:"relative"},onClick:function(e){e.preventDefault(),h(ae[Ve]),_e(Ve+1),Me(Ae+1),it()}},"Next"),r.a.createElement("button",{style:{float:"right"},onClick:function(){fetch("https://jolly-hall-d8e3.ddcmyk.workers.dev/?https://www.sakugabooru.com/tag.json?limit=0").then(function(e){return e.json()}).then(function(e){var t=JSON.stringify(e);d.ref().child("tag.json").putString(t).then(function(e){console.log("JSON file uploaded successfully."),Se("get tag")}).catch(function(e){console.error("Error uploading JSON file:",e),Se("fail get tag")})}).catch(function(e){console.error("Error fetching JSON data:",e)})}},"load tag"),r.a.createElement("button",{style:{float:"right"},onClick:function(){""!=i?fetch("https://jolly-hall-d8e3.ddcmyk.workers.dev/?https://www.sakugabooru.com/post.json?limit=100&tags=".concat(i)).then(function(e){return e.json()}).then(function(e){var t=e.map(function(e){return e.file_url}),a=JSON.stringify(t);d.ref().child("randomtag.json").putString(a).then(function(e){console.log("JSON file uploaded successfully."),Se("upload randomtag")}).catch(function(e){console.error("Error uploading JSON file:",e),Se("fail upload randomtag")})}):Se("no tag")}},"upld rantag")),a?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{float:"left"}},r.a.createElement("form",{onSubmit:ct},r.a.createElement("input",{type:"text",placeholder:"Search",value:i,onChange:De}),r.a.createElement("input",{type:"submit",value:"search"}),r.a.createElement("button",{onClick:ut},"<"),E,r.a.createElement("button",{onClick:st}," ",">"," "),r.a.createElement("button",{onClick:mt}," ","\u2764list"," "),pe?r.a.createElement(r.a.Fragment,null):r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:dt}," ","\u2764"," "))),r.a.createElement("ul",{style:{width:"450px",height:j,overflow:"auto"}},k.map(function(e){return r.a.createElement("li",{key:e.id,onClick:function(t){console.log(e.name),u(e.name),S(0)}},e.name)})),r.a.createElement("ul",{style:{width:"450px",height:"400px",overflow:"auto"}},pe?r.a.createElement(r.a.Fragment,null,K.map(function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{width:"215px",float:"left"}},r.a.createElement("img",{src:e.DimgUrl,style:{width:"215px"},onClick:function(t){h(e.DvideoUrl),console.log(e.DvideoUrl),Me(Ae+1)}}),r.a.createElement("div",{style:{width:"215px",height:"0px",transform:"translate( 0px, -25px )"}},r.a.createElement("button",{style:{backgroundColor:"transparent",border:"1px solid #3498db",appearance:"none",borderRadius:"0"},onClick:function(t){N(e.Dtag.split(/\s+/)),W(e.Did)}}," ","tag"," "),r.a.createElement("button",{style:{backgroundColor:"transparent",border:"1px solid #3498db",appearance:"none",borderRadius:"0"},onClick:function(t){window.confirm("wanna delete this?")&&m.doc("sakugaBookmark/".concat(e.id)).delete()}}," ","del"," "))))})):r.a.createElement(r.a.Fragment,null,U.map(function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{width:"215px",float:"left"}},r.a.createElement("img",{src:e.preview_url,style:{width:"215px"},onClick:function(t){h(e.file_url),console.log(e.file_url),Me(Ae+1),J([e.preview_url,e.file_url,e.tags,e.id])}}),r.a.createElement("div",{style:{width:"215px",height:"0px",transform:"translate( 0px, -25px )"}},r.a.createElement("button",{style:{backgroundColor:"transparent",border:"1px solid #3498db",appearance:"none",borderRadius:"0"},onClick:function(t){N(e.tags.split(/\s+/)),W(e.id)}}," ","tag"," "))))}))),r.a.createElement("div",{style:{width:"450px"}},M.map(function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:function(t){u(e)}}," ",e," "))})),r.a.createElement("div",{key:Ae},r.a.createElement(Xe,bt)))):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{float:"left"}},r.a.createElement("div",{key:Ae},r.a.createElement(Xe,bt)),r.a.createElement("form",{onSubmit:ct},r.a.createElement("input",{type:"text",placeholder:"Search",value:i,onChange:De}),r.a.createElement("input",{type:"submit",value:"search"}),r.a.createElement("button",{onClick:ut},"<"),E,r.a.createElement("button",{onClick:st}," ",">"," "),r.a.createElement("button",{onClick:mt}," ","\u2764list"," "),pe?r.a.createElement(r.a.Fragment,null):r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:dt}," ","\u2764"," "))),r.a.createElement("ul",{style:{width:"450px",height:j,overflow:"auto"}},k.map(function(e){return r.a.createElement("li",{key:e.id,onClick:function(t){console.log(e.name),u(e.name),S(0)}},e.name)})),r.a.createElement("ul",{style:{width:"450px",height:"400px",overflow:"auto"}},pe?r.a.createElement(r.a.Fragment,null,K.map(function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{width:"215px",float:"left"}},r.a.createElement("img",{src:e.DimgUrl,style:{width:"215px"},onClick:function(t){h(e.DvideoUrl),console.log(e.DvideoUrl),Me(Ae+1)}}),r.a.createElement("div",{style:{width:"215px",height:"0px",transform:"translate( 0px, -25px )"}},r.a.createElement("button",{style:{backgroundColor:"transparent",border:"1px solid #3498db",appearance:"none",borderRadius:"0"},onClick:function(t){N(e.Dtag.split(/\s+/)),W(e.Did)}}," ","tag"," "),r.a.createElement("button",{style:{backgroundColor:"transparent",border:"1px solid #3498db",appearance:"none",borderRadius:"0"},onClick:function(t){window.confirm("wanna delete this?")&&m.doc("sakugaBookmark/".concat(e.id)).delete()}}," ","del"," "))))})):r.a.createElement(r.a.Fragment,null,U.map(function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{width:"215px",float:"left"}},r.a.createElement("img",{src:e.preview_url,style:{width:"215px"},onClick:function(t){h(e.file_url),console.log(e.file_url),Me(Ae+1),J([e.preview_url,e.file_url,e.tags,e.id])}}),r.a.createElement("div",{style:{width:"215px",height:"0px",transform:"translate( 0px, -25px )"}},r.a.createElement("button",{style:{backgroundColor:"transparent",border:"1px solid #3498db",appearance:"none",borderRadius:"0"},onClick:function(t){N(e.tags.split(/\s+/)),W(e.id)}}," ","tag"," "))))}))),r.a.createElement("div",{style:{width:"450px"}},M.map(function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:function(t){u(e)}}," ",e," "))}),r.a.createElement("a",{target:"_blank",href:"https://www.sakugabooru.com/post/show/"+_},"link"),r.a.createElement("button",{onClick:function(e){localStorage.setItem(1,!Ee),ye(function(e){return!e})}}," ",Ee?r.a.createElement(r.a.Fragment,null,"on"):r.a.createElement(r.a.Fragment,null,"off")),"s,d:\ud504\ub808\uc784\uc774\ub3d9 qwer:\ucd08\uc774\ub3d9"))),r.a.createElement("div",{style:{float:"left"}},r.a.createElement("div",null,r.a.createElement("div",{style:{float:"right"}},r.a.createElement("label",null,"Lazy:"),r.a.createElement("input",{type:"number",min:"0",max:"100",style:{width:"30px"},value:Je.lazyRadius,onChange:function(e){return Ge(function(t){return Object(p.a)({},t,{lazyRadius:e.target.value})})}})),r.a.createElement("div",{style:{float:"right"}},"erase"==lt?r.a.createElement(r.a.Fragment,null,r.a.createElement("label",null,"Erase Size:"),r.a.createElement("input",{type:"number",min:"1",max:"100",style:{width:"30px"},value:Je.eraseRadius,onChange:function(e){return Ge(function(t){return Object(p.a)({},t,{eraseRadius:e.target.value})})}})):r.a.createElement(r.a.Fragment,null,r.a.createElement("label",null,"Brush Size:"),r.a.createElement("input",{type:"number",min:"1",max:"100",style:{width:"30px"},value:Je.brushRadius,onChange:function(e){return Ge(function(t){return Object(p.a)({},t,{brushRadius:e.target.value})})}}))),r.a.createElement("div",{style:{float:"right"}},r.a.createElement("button",{onClick:function(){window.confirm("wanna clear this?")&&We.current.clear()}},"Clear Canvas")),r.a.createElement("div",{style:{float:"right"}},a?r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{style:{padding:"15px"},onClick:ft},"\u25c0")):r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:ft},"\u25c0"))),r.a.createElement("div",{style:{float:"right"}},"erase"==lt?r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:pt},"brush")):r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:gt},"erase")),r.a.createElement("div",{style:{float:"right"}},"shadow"==lt?r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:pt},"brush")):r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:ht},"shadow")),lt)),r.a.createElement("div",{style:{float:"right"}},r.a.createElement("button",{onClick:function(e){e.preventDefault(),function(){var e=We.current.getSaveData(),a=We.current.getDataURL();We.current.clear(),m.collection("Csubmit").add({text:e,createdAt:Date.now(),creatorId:t.uid,drawingTime:0,heart:0,dataUrl:a,refPinUrl:""}),Te("")}()}},"Upload Drawing"))),r.a.createElement("div",{style:{float:"right"}},r.a.createElement(Q,{canvasWidth:600,canvasHeight:600,brushRadius:"erase"==lt?Je.eraseRadius:Je.brushRadius,lazyRadius:Je.lazyRadius,ref:We,brushColor:lt,allowOnlyPointerType:["all","mouse","touch","pen"][ke]})))))}),Je=a(7),Ge=function(e){var t=e.userObj,a=e.isAndroid,l=(e.penType,Object(n.useState)("")),o=Object(c.a)(l,2),u=(o[0],o[1]),s=Object(n.useState)([]),f=Object(c.a)(s,2),g=(f[0],f[1],Object(n.useState)([])),h=Object(c.a)(g,2),E=(h[0],h[1],Object(n.useState)([])),y=Object(c.a)(E,2),w=y[0],O=y[1],j=Object(n.useState)([]),S=Object(c.a)(j,2),x=S[0],C=S[1],k=Object(n.useState)([""]),R=Object(c.a)(k,2),D=R[0],I=R[1],F=Object(n.useState)(!1),T=Object(c.a)(F,2),P=T[0],z=T[1],U=Object(n.useState)(""),L=Object(c.a)(U,2),B=L[0],A=L[1],M=Object(n.useRef)(),N=Object(n.useState)(""),q=Object(c.a)(N,2),V=q[0],_=q[1],W=Object(n.useState)([""]),H=Object(c.a)(W,2),X=H[0],Y=H[1],J=Object(n.useState)(0),G=Object(c.a)(J,2),Z=G[0],K=G[1],$=Object(n.useState)(0),ee=Object(c.a)($,2),te=ee[0],ae=ee[1],ne=Object(n.useState)(0),re=Object(c.a)(ne,2),le=re[0],ce=re[1],ie=Object(n.useState)(!0),ue=Object(c.a)(ie,2),se=(ue[0],ue[1],Object(n.useState)("")),me=Object(c.a)(se,2),de=me[0],fe=me[1],ge=Object(n.useState)(60),pe=Object(c.a)(ge,2),he=pe[0],be=pe[1],ve=["all","mouse","touch","pen"],Ee=Object(n.useState)(3),ye=Object(c.a)(Ee,2),we=ye[0],Oe=ye[1],je=Object(n.useState)(0),Se=Object(c.a)(je,2),xe=Se[0],Ce=Se[1],ke=Object(n.useState)(0),Re=Object(c.a)(ke,2),De=Re[0],Ie=Re[1],Fe=Object(n.useRef)(he),Te=Object(n.useRef)(null),Pe=Object(n.useState)({croquisTimeDB:60,brushRadius:1,lazyRadius:1,eraseRadius:10}),ze=Object(c.a)(Pe,2),Ue=ze[0],Le=ze[1],Be=Object(n.useState)(!1),Ae=Object(c.a)(Be,2),Me=Ae[0],Ne=Ae[1],qe=Object(n.useState)("#444"),Ve=Object(c.a)(qe,2),_e=Ve[0],We=Ve[1],He=Object(n.useState)([]),Xe=Object(c.a)(He,2),Ye=Xe[0],Ge=Xe[1],Ze=Object(n.useState)(400),Ke=Object(c.a)(Ze,2),Qe=Ke[0],$e=Ke[1];var et=function(e){m.collection("usersetting").doc(t.uid).update({brushRadius:Ue.brushRadius,lazyRadius:Ue.lazyRadius,croquisTimeDB:Ue.croquisTimeDB,eraseRadius:Ue.eraseRadius})},tt=function(){K(Z+1);var e=0;void 0==localStorage.getItem("drawNum")?localStorage.setItem("drawNum",parseInt(0)):e=localStorage.getItem("drawNum"),localStorage.setItem("drawNum",parseInt(e)+1),ce(parseInt(e)+1),localStorage.setItem("lastdrawtime",parseInt(Date.now())),ae(te+1),Fe.current=he;var a=M.current.getSaveData(),n=M.current.getDataURL();if(M.current.clear(),"concept-2"==B){var r=X[te];fetch(n).then(function(e){return e.blob()}).then(function(e){var t=new Blob([e],{type:e.type,name:r});console.log("File renamed",r);var a=d.ref("conceptRef/"+r);a.put(t).then(function(){console.log("File reuploaded !","conceptRef","/",r)}).then(function(){var e=m.doc("concept/ref");a.getDownloadURL().then(function(t){var a=t.indexOf("pot.com/o/"),n=t.indexOf("?alt="),l=t.substring(a,n+4);e.update(Object(Je.a)({},B,i.a.firestore.FieldValue.arrayUnion(r+l)))})})})}m.collection("Csubmit").add({text:a,createdAt:Date.now(),creatorId:t.uid,drawingTime:he-60*xe-De,heart:0,dataUrl:n,refPinUrl:X[te]}),u("")};function at(e){for(var t=e.length-1;t>0;t--){var a=Math.floor(Math.random()*(t+1)),n=[e[a],e[t]];e[t]=n[0],e[a]=n[1]}return e}Object(n.useEffect)(function(){return void 0==localStorage.getItem("drawNum")?(localStorage.setItem("drawNum",parseInt(0)),ce(parseInt(0))):ce(parseInt(localStorage.getItem("drawNum"))),void 0!=localStorage.getItem("lastdrawtime")&&parseInt(Date.now())-parseInt(localStorage.getItem("lastdrawtime"))>216e5&&(localStorage.setItem("drawNum",parseInt(0)),ce(parseInt(0))),m.doc("usersetting/"+t.uid).get().then(function(e){e.exists?(Le({brushRadius:e.data().brushRadius,lazyRadius:e.data().lazyRadius,eraseRadius:e.data().eraseRadius,croquisTimeDB:e.data().croquisTimeDB}),be(e.data().croquisTimeDB),console.log(e.data()),Fe.current+=e.data().croquisTimeDB-60):console.log("No such setting document!")}).catch(function(e){console.log("Error getting document:",e)}),Oe(parseInt(localStorage.getItem("penType"))),Te.current=setInterval(function(){Ce(parseInt(Fe.current/60)),Ie(Fe.current%60),Fe.current-=1},1e3),function(){return clearInterval(Te.current)}},[]),Object(n.useEffect)(function(){Fe.current<=-1&&tt()},[De]),Object(n.useEffect)(function(){var e=[];m.doc("RefDB/refStrings").get().then(function(t){if(t.exists){var a=t.data();Object.keys(a).forEach(function(t){console.log(t),e.push({list:t,url:a[t]})})}else console.log("ref1 No such document!")}).catch(function(e){console.log("ref1 Error getting document:",e)}).then(function(t){m.doc("RefDB/refStrings2").get().then(function(t){if(t.exists){var a=t.data();Object.keys(a).forEach(function(t){console.log(t),e.push({list:t+"-2",url:a[t]})}),e.sort(function(e,t){return e.list.localeCompare(t.list)}),O(e);var n=at(e.flatMap(function(e){return e.url}));if(C(n),void 0==localStorage.getItem("specdraw")){var r=at(Object.values(e[0].url));console.log("\uac12\uc740\ubc14\ub85c",e[0].list),A(e[0].list),Y(r),I(r)}else{var l=at(Object.values(e[parseInt(localStorage.getItem("specdraw"))].url));console.log("\uac12\uc740\ubc14\ub85c",e[parseInt(localStorage.getItem("specdraw"))].list),A(e[parseInt(localStorage.getItem("specdraw"))].list),Y(l),I(l)}}else console.log("ref2 No such document!")}).catch(function(e){console.log("ref2  Error getting document:",e)})})},[]);var nt=function(e){e.preventDefault(),tt(),fe("")},rt=function(e){var t=e.target.value;be(t),Le(function(t){return Object(p.a)({},t,{croquisTimeDB:e.target.value})})},lt=function(e){e.preventDefault(),Ne(!1),console.log("\ud604\uc7ac\uac12\uc740",B)},ot=function(){var e=0;void 0==localStorage.getItem("drawNum")?localStorage.setItem("drawNum",parseInt(0)):e=localStorage.getItem("drawNum"),localStorage.setItem("drawNum",parseInt(e)+1),ce(parseInt(e)+1),localStorage.setItem("lastdrawtime",parseInt(Date.now())),Fe.current=he;var a=M.current.getSaveData(),n=M.current.getDataURL();M.current.clear(),m.collection("Csubmit").add({text:a,createdAt:Date.now(),creatorId:t.uid,drawingTime:he-60*xe-De,heart:0,dataUrl:n,refPinUrl:X[te]}),u("")},ct=function(e){e.preventDefault(),ot(),fe("")},it=function(e){e.preventDefault(),function(e,t){var a=new Image;a.onload=function(){var e=document.createElement("canvas");e.width=a.width,e.height=a.height;var n=e.getContext("2d");n.drawImage(a,0,0);for(var r=n.getImageData(0,0,e.width,e.height),l=r.data,o=0;o<l.length;o+=4)l[o+3]=Math.floor(.2*l[o+3]);n.putImageData(r,0,0);var c=e.toDataURL("image/png");t(c)},a.src=e}(M.current.getDataURL(),function(e){fe(e)}),ot(),M.current.clear()},ut=function(e){e.preventDefault(),K(Z+1),ae(te+1),Fe.current=he},st=function(){B.includes("-2")?m.doc("RefDB/refStrings2").update(Object(Je.a)({},B.slice(0,-2),i.a.firestore.FieldValue.arrayRemove(X[te]))):m.doc("RefDB/refStrings").update(Object(Je.a)({},B,i.a.firestore.FieldValue.arrayRemove(X[te])));K(Z+1),ae(te+1)},mt=function(){window.confirm("wanna clear this?")&&(M.current.clear(),fe(""))},dt=function(){M.current.undo()},ft=function(){We("erase")},gt=function(){We("#444")},pt=function(){We("shadow")};function ht(e){var t=e%10,a=e%100;return 1==t&&11!=a?e+"st":2==t&&12!=a?e+"nd":3==t&&13!=a?e+"rd":e+"th"}function bt(e){return e<=9?"0"+e:e}var vt=function(e){A(w[e.target.value].list),localStorage.setItem("specdraw",parseInt(e.target.value));var t=at(Object.values(w[e.target.value].url));Y(t),I(t)},Et=function(e){0==P?(Y(x),console.log("rand on",x.length),z(!0)):(Y(D),console.log("rand off",D.length),z(!1))},yt=function(){var e=Object(v.a)(b.a.mark(function e(t){return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),Ot(B,Ye),Ge([]);case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),wt=function(){var e=Object(v.a)(b.a.mark(function e(t,a){var n;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==a){e.next=2;break}return e.abrupt("return","");case 2:return e.prev=2,e.next=5,d.ref("/".concat(t,"/").concat(a.name)).put(a);case 5:return n=e.sent,e.abrupt("return",n.ref.getDownloadURL().then(function(e){return e}));case 9:e.prev=9,e.t0=e.catch(2),console.log(e.t0);case 12:case"end":return e.stop()}},e,null,[[2,9]])}));return function(t,a){return e.apply(this,arguments)}}(),Ot=function(){var e=Object(v.a)(b.a.mark(function e(t,a){var n,r,l,o,c,u,s,d,f,g,p,h,v,E,y;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==a.length){e.next=2;break}return e.abrupt("return",[]);case 2:if(!t.includes("-2")){e.next=21;break}n=m.doc("RefDB/refStrings2"),r=0;case 5:if(!(r<a.length)){e.next=19;break}return l=a[r],e.next=9,wt(t,l);case 9:o=e.sent,u=(c=o).indexOf("pot.com/o/"),s=c.indexOf("&token="),d=c.slice(u,s),n.update(Object(Je.a)({},t.slice(0,-2),i.a.firestore.FieldValue.arrayUnion(d))),console.log("complete : ",r+1,"/",a.length," ",o);case 16:r++,e.next=5;break;case 19:e.next=37;break;case 21:f=m.doc("RefDB/refStrings"),r=0;case 23:if(!(r<a.length)){e.next=37;break}return g=a[r],e.next=27,wt(t,g);case 27:p=e.sent,v=(h=p).indexOf("pot.com/o/"),E=h.indexOf("&token="),y=h.slice(v,E),f.update(Object(Je.a)({},t,i.a.firestore.FieldValue.arrayUnion(y))),console.log("complete : ",r+1,"/",a.length," ",p);case 34:r++,e.next=23;break;case 37:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,r.a.createElement(oe.a,{keyName:"ctrl+z,c,x",onKeyDown:function(e,t,a){"ctrl+z"==e&&dt(),"c"==e&&("erase"!=_e?ft():"erase"==_e&&gt()),"x"==e&&("shadow"!=_e?pt():"shadow"==_e&&gt())}}),r.a.createElement("div",null,a?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{float:"right"}},r.a.createElement("button",{onClick:Et},P?"off":"ran"),Me?r.a.createElement(r.a.Fragment,null,r.a.createElement("form",{onSubmit:lt},r.a.createElement("input",{value:he,onChange:rt,type:"number",placeholder:"Input Croquis Time"}),r.a.createElement("input",{type:"submit",value:"Set Time"})),r.a.createElement("button",{onClick:st},"Delete Pin"),r.a.createElement("button",{onClick:function(e){0==we?(Oe(3),localStorage.setItem("penType",parseInt(3))):3==we&&(Oe(0),localStorage.setItem("penType",parseInt(0)))}},ve[we])):r.a.createElement(r.a.Fragment,null,ht(le+1),r.a.createElement("button",{onClick:function(e){Ne(!0)}},"Set Time")),Me&&r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:et},"Setting")))):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{width:"1000px"}},r.a.createElement("div",{style:{float:"right"}},Me?r.a.createElement(r.a.Fragment,null,r.a.createElement("form",{onSubmit:lt},r.a.createElement("input",{value:he,onChange:rt,type:"number",placeholder:"Input Croquis Time"}),r.a.createElement("input",{type:"submit",value:"Set Time"})),r.a.createElement("button",{onClick:st},"Delete Pin"),r.a.createElement("button",{onClick:function(e){0==we?(Oe(3),localStorage.setItem("penType",parseInt(3))):3==we&&(Oe(0),localStorage.setItem("penType",parseInt(0)))}},ve[we])):r.a.createElement(r.a.Fragment,null,ht(le+1),r.a.createElement("button",{onClick:function(e){Ne(!0)}},"Set Time")),Me&&r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:et},"Setting"))))),a?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,r.a.createElement("select",{defaultValue:-1,onChange:vt},w.map(function(e,t){return r.a.createElement("option",{key:e.list,value:t,selected:localStorage.getItem("specdraw")?t===parseInt(localStorage.getItem("specdraw")):0===t},e.list)}))),r.a.createElement("div",{style:{float:"left"}},"string"==typeof X[te]&&X[te].startsWith("pot.com/o/")?r.a.createElement(r.a.Fragment,null,r.a.createElement("img",{key:Z,src:X[te].replace("pot.com/o/","https://firebasestorage.googleapis.com/v0/b/croquistool.appspot.com/o/"),height:450,frameBorder:0,scrolling:"no"})):r.a.createElement(r.a.Fragment,null,"string"==typeof X[te]&&X[te].includes("firebasestorage.googleapis.com")?r.a.createElement(r.a.Fragment,null,r.a.createElement("img",{key:Z,src:X[te],height:450,frameBorder:0,scrolling:"no"})):r.a.createElement(r.a.Fragment,null,r.a.createElement("iframe",{key:Z,src:"https://assets.pinterest.com/ext/embed.html?id="+X[te],height:450,frameBorder:0,scrolling:"no"}))))):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{float:"right"}},r.a.createElement("button",{onClick:mt},"Clear Canvas")),r.a.createElement("div",{style:{float:"right"}},r.a.createElement("button",{onClick:ct},"Up&Re")),r.a.createElement("div",{style:{float:"right"}},r.a.createElement("button",{onClick:it},"Review")),r.a.createElement("div",{style:{float:"right"}},r.a.createElement("button",{onClick:nt},"Upload")),r.a.createElement("div",{style:{float:"right"}},r.a.createElement("button",{onClick:ut},"Next")),r.a.createElement("div",{style:{float:"left"}},r.a.createElement("button",{onClick:function(e){400==Qe?$e(600):600==Qe&&$e(400)}},"ex"),r.a.createElement("button",{onClick:Et},P?"off":"ran")),r.a.createElement("div",{style:{position:"absolute",left:"30%",transform:"translateX(-50%)",width:"70px",textAlign:"center",background:"linear-gradient(to left,#FFC365 "+100*(60*xe+De)/he+"%,#E8E8E8 "+100*(60*xe+De)/he+"%)"}},xe,": ",bt(De)),r.a.createElement("div",null,r.a.createElement("form",{onSubmit:function(e){if(e.preventDefault(),B.includes("-2"))if(V.match(",")){var t=m.doc("RefDB/refStrings2");V.split(",").forEach(function(e){t.update(Object(Je.a)({},B.slice(0,-2),i.a.firestore.FieldValue.arrayUnion(e)))})}else V.length>1&&m.doc("RefDB/refStrings2").update(Object(Je.a)({},B.slice(0,-2),i.a.firestore.FieldValue.arrayUnion(V)));else if(V.match(",")){var a=m.doc("RefDB/refStrings");V.split(",").forEach(function(e){a.update(Object(Je.a)({},B,i.a.firestore.FieldValue.arrayUnion(e)))})}else V.length>1&&m.doc("RefDB/refStrings").update(Object(Je.a)({},B,i.a.firestore.FieldValue.arrayUnion(V)));_("")}},r.a.createElement("select",{defaultValue:2,onChange:vt},w.map(function(e,t){return r.a.createElement("option",{key:e.list,value:t,selected:localStorage.getItem("specdraw")?t===parseInt(localStorage.getItem("specdraw")):0===t},e.list)})),r.a.createElement("input",{value:V,onChange:function(e){var t=e.target.value;_(t)},type:"text",placeholder:"You Can Upload Pinterst Pin By Url Number"}),r.a.createElement("input",{type:"submit",value:"Upload Pin"}))),r.a.createElement("div",{style:{float:"left"}},"string"==typeof X[te]&&X[te].startsWith("pot.com/o/")?r.a.createElement(r.a.Fragment,null,r.a.createElement("img",{key:Z,src:X[te].replace("pot.com/o/","https://firebasestorage.googleapis.com/v0/b/croquistool.appspot.com/o/"),width:Qe,frameBorder:0,scrolling:"no"})):r.a.createElement(r.a.Fragment,null,"string"==typeof X[te]&&X[te].includes("firebasestorage.googleapis.com")?r.a.createElement(r.a.Fragment,null,r.a.createElement("img",{key:Z,src:X[te],width:Qe,frameBorder:0,scrolling:"no"})):r.a.createElement(r.a.Fragment,null,r.a.createElement("iframe",{key:Z,src:"https://assets.pinterest.com/ext/embed.html?id="+X[te],height:Qe+370,width:Qe,frameBorder:0,scrolling:"no"}))))),r.a.createElement("div",{style:{float:"left"}},r.a.createElement("div",null,a?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{float:"right"}},r.a.createElement("button",{onClick:mt},"Clear")),r.a.createElement("div",{style:{float:"right"}},r.a.createElement("button",{onClick:ct},"UpRe"),r.a.createElement("button",{onClick:it},"Rev")),r.a.createElement("div",{style:{float:"right"}},r.a.createElement("button",{onClick:nt},"Up")),r.a.createElement("div",{style:{float:"right"}},r.a.createElement("button",{onClick:ut},"Next")),r.a.createElement("div",{style:{float:"right"}},xe,": ",bt(De))):r.a.createElement(r.a.Fragment,null),r.a.createElement("div",{style:{float:"right"}},r.a.createElement("label",null,"Lazy:"),r.a.createElement("input",{type:"number",min:"0",max:"100",style:{width:"30px"},value:Ue.lazyRadius,onChange:function(e){return Le(function(t){return Object(p.a)({},t,{lazyRadius:e.target.value})})}})),r.a.createElement("div",{style:{float:"right"}},"erase"==_e?r.a.createElement(r.a.Fragment,null,r.a.createElement("label",null,"Er:"),r.a.createElement("input",{type:"number",min:"1",max:"100",style:{width:"30px"},value:Ue.eraseRadius,onChange:function(e){return Le(function(t){return Object(p.a)({},t,{eraseRadius:e.target.value})})}})):r.a.createElement(r.a.Fragment,null,r.a.createElement("label",null,"Br:"),r.a.createElement("input",{type:"number",min:"1",max:"100",style:{width:"30px"},value:Ue.brushRadius,onChange:function(e){return Le(function(t){return Object(p.a)({},t,{brushRadius:e.target.value})})}}))),r.a.createElement("div",{style:{float:"left"}},a?r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{style:{paddingLeft:"15px"},onClick:dt},"\u25c0")):r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:dt},"\u25c0"))),r.a.createElement("div",{style:{float:"left"}},"erase"==_e?r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:gt},"brush")):r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:ft},"erase"))),r.a.createElement("div",{style:{float:"left"}},"shadow"==_e?r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:gt},"brush")):r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:pt},"shadow")),_e)),r.a.createElement("div",{style:{float:"right"}},r.a.createElement(Q,{canvasWidth:600,canvasHeight:600,brushRadius:"erase"==_e?Ue.eraseRadius:Ue.brushRadius,lazyRadius:Ue.lazyRadius,ref:M,brushColor:_e,imgSrc:de,allowOnlyPointerType:ve[we]}))),Me&&r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:function(e){var t=at(X);Y(t)}},"random!")),Me&&r.a.createElement(r.a.Fragment,null," ",r.a.createElement("form",{onSubmit:yt},r.a.createElement("input",{type:"file",accept:"image/*",onChange:function(e){var t=e.target.files;t[0];Ge(t),console.log(t)},multiple:!0}),r.a.createElement("input",{type:"submit",value:"Upload Croquis Images"})))))},Ze=function(e){var t=e.userObj,a=e.isAndroid,l=(e.penType,Object(n.useState)("")),o=Object(c.a)(l,2),u=(o[0],o[1]),s=Object(n.useState)([]),f=Object(c.a)(s,2),g=(f[0],f[1],Object(n.useState)([])),h=Object(c.a)(g,2),E=(h[0],h[1],Object(n.useState)([])),y=Object(c.a)(E,2),w=y[0],O=y[1],j=Object(n.useState)([]),S=Object(c.a)(j,2),x=S[0],C=S[1],k=Object(n.useState)([""]),R=Object(c.a)(k,2),D=R[0],I=R[1],F=Object(n.useState)(!1),T=Object(c.a)(F,2),P=T[0],z=T[1],U=Object(n.useState)(""),L=Object(c.a)(U,2),B=L[0],A=L[1],M=Object(n.useRef)(),N=Object(n.useState)(""),q=Object(c.a)(N,2),V=q[0],_=q[1],W=Object(n.useState)([""]),H=Object(c.a)(W,2),X=H[0],Y=H[1],J=Object(n.useState)(0),G=Object(c.a)(J,2),Z=G[0],K=G[1],$=Object(n.useState)(0),ee=Object(c.a)($,2),te=ee[0],ae=ee[1],ne=Object(n.useState)(0),re=Object(c.a)(ne,2),le=re[0],ce=re[1],ie=Object(n.useState)(!0),ue=Object(c.a)(ie,2),se=(ue[0],ue[1],Object(n.useState)("")),me=Object(c.a)(se,2),de=me[0],fe=me[1],ge=Object(n.useState)(60),pe=Object(c.a)(ge,2),he=pe[0],be=pe[1],ve=["all","mouse","touch","pen"],Ee=Object(n.useState)(3),ye=Object(c.a)(Ee,2),we=ye[0],Oe=ye[1],je=Object(n.useState)(0),Se=Object(c.a)(je,2),xe=Se[0],Ce=(Se[1],Object(n.useState)(0)),ke=Object(c.a)(Ce,2),Re=ke[0],De=(ke[1],Object(n.useRef)(he)),Ie=(Object(n.useRef)(null),Object(n.useState)({croquisTimeDB:60,brushRadius:1,lazyRadius:1,eraseRadius:10})),Fe=Object(c.a)(Ie,2),Te=Fe[0],Pe=Fe[1],ze=Object(n.useState)(!1),Ue=Object(c.a)(ze,2),Le=Ue[0],Be=Ue[1],Ae=Object(n.useState)("#444"),Me=Object(c.a)(Ae,2),Ne=Me[0],qe=Me[1],Ve=Object(n.useState)([]),_e=Object(c.a)(Ve,2),We=_e[0],He=_e[1],Xe=Object(n.useState)(400),Ye=Object(c.a)(Xe,2),Ge=Ye[0],Ze=Ye[1];var Ke=function(e){m.collection("usersetting").doc(t.uid).update({brushRadius:Te.brushRadius,lazyRadius:Te.lazyRadius,croquisTimeDB:Te.croquisTimeDB,eraseRadius:Te.eraseRadius})};function Qe(e){for(var t=e.length-1;t>0;t--){var a=Math.floor(Math.random()*(t+1)),n=[e[a],e[t]];e[t]=n[0],e[a]=n[1]}return e}Object(n.useEffect)(function(){void 0==localStorage.getItem("drawNum")?(localStorage.setItem("drawNum",parseInt(0)),ce(parseInt(0))):ce(parseInt(localStorage.getItem("drawNum"))),void 0!=localStorage.getItem("lastdrawtime")&&parseInt(Date.now())-parseInt(localStorage.getItem("lastdrawtime"))>216e5&&(localStorage.setItem("drawNum",parseInt(0)),ce(parseInt(0))),m.doc("usersetting/"+t.uid).get().then(function(e){e.exists?(Pe({brushRadius:e.data().brushRadius,lazyRadius:e.data().lazyRadius,eraseRadius:e.data().eraseRadius,croquisTimeDB:e.data().croquisTimeDB}),be(e.data().croquisTimeDB),console.log(e.data()),De.current+=e.data().croquisTimeDB-60):console.log("No such setting document!")}).catch(function(e){console.log("Error getting document:",e)}),Oe(parseInt(localStorage.getItem("penType")))},[]),Object(n.useEffect)(function(){var e=[];m.doc("concept/ref").get().then(function(t){if(t.exists){var a=t.data();Object.keys(a).forEach(function(t){console.log(t),e.push({list:t,url:a[t]})}),e.sort(function(e,t){return e.list.localeCompare(t.list)}),O(e);var n=Qe(e.flatMap(function(e){return e.url}));if(C(n),void 0==localStorage.getItem("speccopydraw")){var r=Qe(Object.values(e[0].url));console.log("\uac12\uc740\ubc14\ub85c",e[0].list),A(e[0].list),Y(r);var l=r[0].substring(r[0].indexOf("pot.com/o/"),r[0].length).replace("pot.com/o/","https://firebasestorage.googleapis.com/v0/b/croquistool.appspot.com/o/");console.log("\uc774\ubbf8\uc9c0\ub85c\ub529!",l),0!=l.length&&(fe(l+"=media"),console.log("\ub85c\ub529\uc644")),I(r)}else{var o=Qe(Object.values(e[parseInt(localStorage.getItem("speccopydraw"))].url));console.log("\uac12\uc740\ubc14\ub85c",e[parseInt(localStorage.getItem("speccopydraw"))].list),A(e[parseInt(localStorage.getItem("speccopydraw"))].list),Y(o);var c=o[0].substring(o[0].indexOf("pot.com/o/"),o[0].length).replace("pot.com/o/","https://firebasestorage.googleapis.com/v0/b/croquistool.appspot.com/o/");console.log("\uc774\ubbf8\uc9c0\ub85c\ub529!",c),0!=c.length&&(fe(c+"=media"),console.log("\ub85c\ub529\uc644")),I(o)}}else console.log("ref1 No such document!")}).catch(function(e){console.log("ref1 Error getting document:",e)}).then(function(e){})},[]);var $e=function(e){e.preventDefault(),function(){K(Z+1);var e=0;void 0==localStorage.getItem("drawNum")?localStorage.setItem("drawNum",parseInt(0)):e=localStorage.getItem("drawNum"),localStorage.setItem("drawNum",parseInt(e)+1),ce(parseInt(e)+1),localStorage.setItem("lastdrawtime",parseInt(Date.now())),ae(te+1),De.current=he;M.current.getSaveData();var a=M.current.props.canvasWidth,n=M.current.props.canvasHeight,r=M.current.canvasContainer.children[0],l=M.current.canvasContainer.children[1],o=document.createElement("canvas");o.width=a,o.height=n,o.getContext("2d").drawImage(r,0,0),o.getContext("2d").drawImage(l,0,0);var c=o.toDataURL("image/png");M.current.clear();var i=X[te+1].substring(X[te+1].indexOf("pot.com/o/"),X[te+1].length).replace("pot.com/o/","https://firebasestorage.googleapis.com/v0/b/croquistool.appspot.com/o/");console.log("\uc774\ubbf8\uc9c0\ub85c\ub529!",i),0!=i.length&&fe(i+"=media"),m.collection("Csubmit").add({text:"",createdAt:Date.now(),creatorId:t.uid,drawingTime:he-60*xe-Re,heart:0,dataUrl:c,refPinUrl:X[te].substring(0,X[te].indexOf("pot.com/o/"))}),u("")}()},et=function(e){var t=e.target.value;be(t),Pe(function(t){return Object(p.a)({},t,{croquisTimeDB:e.target.value})})},tt=function(e){e.preventDefault(),Be(!1),console.log("\ud604\uc7ac\uac12\uc740",B);var t=X[te].substring(X[te].indexOf("pot.com/o/"),X[te].length).replace("pot.com/o/","https://firebasestorage.googleapis.com/v0/b/croquistool.appspot.com/o/");console.log("\uc774\ubbf8\uc9c0\ub85c\ub529!",t),0!=t.length&&fe(t+"=media")},at=function(){var e=0;void 0==localStorage.getItem("drawNum")?localStorage.setItem("drawNum",parseInt(0)):e=localStorage.getItem("drawNum"),localStorage.setItem("drawNum",parseInt(e)+1),ce(parseInt(e)+1),localStorage.setItem("lastdrawtime",parseInt(Date.now())),De.current=he;M.current.getSaveData();var a=M.current.props.canvasWidth,n=M.current.props.canvasHeight,r=M.current.canvasContainer.children[0],l=M.current.canvasContainer.children[1],o=document.createElement("canvas");o.width=a,o.height=n,o.getContext("2d").drawImage(r,0,0),o.getContext("2d").drawImage(l,0,0);var c=o.toDataURL("image/png");M.current.clear();var i=X[te+1].substring(X[te+1].indexOf("pot.com/o/"),X[te+1].length).replace("pot.com/o/","https://firebasestorage.googleapis.com/v0/b/croquistool.appspot.com/o/");console.log("\uc774\ubbf8\uc9c0\ub85c\ub529!",i),0!=i.length&&fe(i+"=media"),m.collection("Csubmit").add({text:"",createdAt:Date.now(),creatorId:t.uid,drawingTime:he-60*xe-Re,heart:0,dataUrl:c,refPinUrl:X[te].substring(0,X[te].indexOf("pot.com/o/"))}),u("")},nt=function(e){e.preventDefault(),at(),fe("")},rt=function(e){e.preventDefault(),function(e,t){var a=new Image;a.onload=function(){var e=document.createElement("canvas");e.width=a.width,e.height=a.height;var n=e.getContext("2d");n.drawImage(a,0,0);for(var r=n.getImageData(0,0,e.width,e.height),l=r.data,o=0;o<l.length;o+=4)l[o+3]=Math.floor(.2*l[o+3]);n.putImageData(r,0,0);var c=e.toDataURL("image/png");t(c)},a.src=e}(M.current.getDataURL(),function(e){fe(e)}),at(),M.current.clear()},lt=function(e){e.preventDefault(),K(Z+1);var t=X[te+1].substring(X[te+1].indexOf("pot.com/o/"),X[te+1].length).replace("pot.com/o/","https://firebasestorage.googleapis.com/v0/b/croquistool.appspot.com/o/");console.log("\uc774\ubbf8\uc9c0\ub85c\ub529!",t),0!=t.length&&fe(t+"=media"),ae(te+1),De.current=he},ot=function(){B.includes("-aaaaad2")?m.doc("concept/ref").update(Object(Je.a)({},B.slice(0,-2),i.a.firestore.FieldValue.arrayRemove(X[te]))):m.doc("concept/ref").update(Object(Je.a)({},B,i.a.firestore.FieldValue.arrayRemove(X[te])));K(Z+1),ae(te+1)},ct=function(){window.confirm("wanna clear this?")&&(M.current.clear(),fe(""))},it=function(){M.current.undo()},ut=function(){qe("erase")},st=function(){qe("#444")},mt=function(){qe("shadow")};function dt(e){var t=e%10,a=e%100;return 1==t&&11!=a?e+"st":2==t&&12!=a?e+"nd":3==t&&13!=a?e+"rd":e+"th"}function ft(e){return e<=9?"0"+e:e}var gt=function(e){A(w[e.target.value].list),localStorage.setItem("speccopydraw",parseInt(e.target.value));var t=Qe(Object.values(w[e.target.value].url));Y(t),I(t)},pt=function(e){0==P?(Y(x),console.log("rand on",x.length),z(!0)):(Y(D),console.log("rand off",D.length),z(!1))},ht=function(){var e=Object(v.a)(b.a.mark(function e(t){return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),vt(B,We),He([]);case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),bt=function(){var e=Object(v.a)(b.a.mark(function e(t,a){var n;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==a){e.next=2;break}return e.abrupt("return","");case 2:return e.prev=2,e.next=5,d.ref("/".concat(t,"/").concat(a.name)).put(a);case 5:return n=e.sent,e.abrupt("return",n.ref.getDownloadURL().then(function(e){return e}));case 9:e.prev=9,e.t0=e.catch(2),console.log(e.t0);case 12:case"end":return e.stop()}},e,null,[[2,9]])}));return function(t,a){return e.apply(this,arguments)}}(),vt=function(){var e=Object(v.a)(b.a.mark(function e(t,a){var n,r,l,o,c,u,s,d,f,g,p,h,v,E,y;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==a.length){e.next=2;break}return e.abrupt("return",[]);case 2:if(!t.includes("-2")){e.next=21;break}n=m.doc("RefDB/refStrings2"),r=0;case 5:if(!(r<a.length)){e.next=19;break}return l=a[r],e.next=9,bt(t,l);case 9:o=e.sent,u=(c=o).indexOf("pot.com/o/"),s=c.indexOf("&token="),d=c.slice(u,s),n.update(Object(Je.a)({},t.slice(0,-2),i.a.firestore.FieldValue.arrayUnion(d))),console.log("complete : ",r+1,"/",a.length," ",o);case 16:r++,e.next=5;break;case 19:e.next=37;break;case 21:f=m.doc("RefDB/refStrings"),r=0;case 23:if(!(r<a.length)){e.next=37;break}return g=a[r],e.next=27,bt(t,g);case 27:p=e.sent,v=(h=p).indexOf("pot.com/o/"),E=h.indexOf("&token="),y=h.slice(v,E),f.update(Object(Je.a)({},t,i.a.firestore.FieldValue.arrayUnion(y))),console.log("complete : ",r+1,"/",a.length," ",p);case 34:r++,e.next=23;break;case 37:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,r.a.createElement(oe.a,{keyName:"ctrl+z,c,x",onKeyDown:function(e,t,a){"ctrl+z"==e&&it(),"c"==e&&("erase"!=Ne?ut():"erase"==Ne&&st()),"x"==e&&("shadow"!=Ne?mt():"shadow"==Ne&&st())}}),r.a.createElement("div",null,a?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{float:"right"}},r.a.createElement("button",{onClick:pt},P?"off":"ran"),Le?r.a.createElement(r.a.Fragment,null,r.a.createElement("form",{onSubmit:tt},r.a.createElement("input",{value:he,onChange:et,type:"number",placeholder:"Input Croquis Time"}),r.a.createElement("input",{type:"submit",value:"Set Time"})),r.a.createElement("button",{onClick:ot},"Delete Pin"),r.a.createElement("button",{onClick:function(e){0==we?(Oe(3),localStorage.setItem("penType",parseInt(3))):3==we&&(Oe(0),localStorage.setItem("penType",parseInt(0)))}},ve[we])):r.a.createElement(r.a.Fragment,null,dt(le+1),r.a.createElement("button",{onClick:function(e){Be(!0)}},"Set Time")),Le&&r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:Ke},"Setting")))):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{width:"1000px"}},r.a.createElement("div",{style:{float:"right"}},Le?r.a.createElement(r.a.Fragment,null,r.a.createElement("form",{onSubmit:tt},r.a.createElement("input",{value:he,onChange:et,type:"number",placeholder:"Input Croquis Time"}),r.a.createElement("input",{type:"submit",value:"Set Time"})),r.a.createElement("button",{onClick:ot},"Delete Pin"),r.a.createElement("button",{onClick:function(e){0==we?(Oe(3),localStorage.setItem("penType",parseInt(3))):3==we&&(Oe(0),localStorage.setItem("penType",parseInt(0)))}},ve[we])):r.a.createElement(r.a.Fragment,null,dt(le+1),r.a.createElement("button",{onClick:function(e){Be(!0)}},"Set Time")),Le&&r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:Ke},"Setting"))))),a?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,r.a.createElement("select",{defaultValue:-1,onChange:gt},w.map(function(e,t){return r.a.createElement("option",{key:e.list,value:t,selected:localStorage.getItem("speccopydraw")?t===parseInt(localStorage.getItem("speccopydraw")):0===t},e.list)}))),r.a.createElement("div",{style:{float:"left"}},"string"==typeof X[te]&&X[te].startsWith("pot.com/o/")?r.a.createElement(r.a.Fragment,null,r.a.createElement("img",{key:Z,src:X[te].substring(X[te].indexOf("pot.com/o/"),X[te].length).replace("pot.com/o/","https://firebasestorage.googleapis.com/v0/b/croquistool.appspot.com/o/"),height:450,frameBorder:0,scrolling:"no"})):r.a.createElement(r.a.Fragment,null,"error,",X[te]))):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{float:"right"}},r.a.createElement("button",{onClick:ct},"Clear Canvas")),r.a.createElement("div",{style:{float:"right"}},r.a.createElement("button",{onClick:nt},"Up&Re")),r.a.createElement("div",{style:{float:"right"}},r.a.createElement("button",{onClick:rt},"Review")),r.a.createElement("div",{style:{float:"right"}},r.a.createElement("button",{onClick:$e},"Upload")),r.a.createElement("div",{style:{float:"right"}},r.a.createElement("button",{onClick:lt},"Next")),r.a.createElement("div",{style:{float:"left"}},r.a.createElement("button",{onClick:function(e){400==Ge?Ze(600):600==Ge&&Ze(400)}},"ex"),r.a.createElement("button",{onClick:pt},P?"off":"ran")),r.a.createElement("div",{style:{position:"absolute",left:"30%",transform:"translateX(-50%)",width:"70px",textAlign:"center",background:"linear-gradient(to left,#FFC365 "+100*(60*xe+Re)/he+"%,#E8E8E8 "+100*(60*xe+Re)/he+"%)"}},xe,": ",ft(Re)),r.a.createElement("div",null,r.a.createElement("form",{onSubmit:function(e){if(e.preventDefault(),B.includes("-2"))if(V.match(",")){var t=m.doc("RefDB/refStrings2");V.split(",").forEach(function(e){t.update(Object(Je.a)({},B.slice(0,-2),i.a.firestore.FieldValue.arrayUnion(e)))})}else V.length>1&&m.doc("RefDB/refStrings2").update(Object(Je.a)({},B.slice(0,-2),i.a.firestore.FieldValue.arrayUnion(V)));else if(V.match(",")){var a=m.doc("RefDB/refStrings");V.split(",").forEach(function(e){a.update(Object(Je.a)({},B,i.a.firestore.FieldValue.arrayUnion(e)))})}else V.length>1&&m.doc("RefDB/refStrings").update(Object(Je.a)({},B,i.a.firestore.FieldValue.arrayUnion(V)));_("")}},r.a.createElement("select",{defaultValue:2,onChange:gt},w.map(function(e,t){return r.a.createElement("option",{key:e.list,value:t,selected:localStorage.getItem("speccopydraw")?t===parseInt(localStorage.getItem("speccopydraw")):0===t},e.list)})),r.a.createElement("input",{value:V,onChange:function(e){var t=e.target.value;_(t)},type:"text",placeholder:"You Can Upload Pinterst Pin By Url Number"}),r.a.createElement("input",{type:"submit",value:"Upload Pin"}))),r.a.createElement("div",{style:{float:"left"}},"string"==typeof X[te]&&X[te].includes("pot.com/o/")?r.a.createElement(r.a.Fragment,null,r.a.createElement("img",{key:Z,src:X[te].substring(X[te].indexOf("pot.com/o/"),X[te].length).replace("pot.com/o/","https://firebasestorage.googleapis.com/v0/b/croquistool.appspot.com/o/")+"=media",width:Ge,frameBorder:0,scrolling:"no"})):r.a.createElement(r.a.Fragment,null,"error,",X[te]))),r.a.createElement("div",{style:{float:"left"}},r.a.createElement("div",null,a?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{float:"right"}},r.a.createElement("button",{onClick:ct},"Clear")),r.a.createElement("div",{style:{float:"right"}},r.a.createElement("button",{onClick:nt},"UpRe"),r.a.createElement("button",{onClick:rt},"Rev")),r.a.createElement("div",{style:{float:"right"}},r.a.createElement("button",{onClick:$e},"Up")),r.a.createElement("div",{style:{float:"right"}},r.a.createElement("button",{onClick:lt},"Next")),r.a.createElement("div",{style:{float:"right"}},xe,": ",ft(Re))):r.a.createElement(r.a.Fragment,null),r.a.createElement("div",{style:{float:"right"}},r.a.createElement("label",null,"Lazy:"),r.a.createElement("input",{type:"number",min:"0",max:"100",style:{width:"30px"},value:Te.lazyRadius,onChange:function(e){return Pe(function(t){return Object(p.a)({},t,{lazyRadius:e.target.value})})}})),r.a.createElement("div",{style:{float:"right"}},"erase"==Ne?r.a.createElement(r.a.Fragment,null,r.a.createElement("label",null,"Er:"),r.a.createElement("input",{type:"number",min:"1",max:"100",style:{width:"30px"},value:Te.eraseRadius,onChange:function(e){return Pe(function(t){return Object(p.a)({},t,{eraseRadius:e.target.value})})}})):r.a.createElement(r.a.Fragment,null,r.a.createElement("label",null,"Br:"),r.a.createElement("input",{type:"number",min:"1",max:"100",style:{width:"30px"},value:Te.brushRadius,onChange:function(e){return Pe(function(t){return Object(p.a)({},t,{brushRadius:e.target.value})})}}))),r.a.createElement("div",{style:{float:"left"}},a?r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{style:{paddingLeft:"15px"},onClick:it},"\u25c0")):r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:it},"\u25c0"))),r.a.createElement("div",{style:{float:"left"}},"erase"==Ne?r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:st},"brush")):r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:ut},"erase"))),r.a.createElement("div",{style:{float:"left"}},"shadow"==Ne?r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:st},"brush")):r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:mt},"shadow")),Ne)),r.a.createElement("div",{style:{float:"right"}},r.a.createElement(Q,{canvasWidth:600,canvasHeight:600,brushRadius:"erase"==Ne?Te.eraseRadius:Te.brushRadius,lazyRadius:Te.lazyRadius,ref:M,brushColor:Ne,imgSrc:de,allowOnlyPointerType:ve[we]}))),Le&&r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:function(e){var t=Qe(X);Y(t),M.current.clear();var a=X[te].substring(X[te].indexOf("pot.com/o/"),X[te].length).replace("pot.com/o/","https://firebasestorage.googleapis.com/v0/b/croquistool.appspot.com/o/");console.log("\uc774\ubbf8\uc9c0\ub85c\ub529!",a),0!=a.length&&fe(a+"=media")}},"random!")),Le&&r.a.createElement(r.a.Fragment,null," ",r.a.createElement("form",{onSubmit:ht},r.a.createElement("input",{type:"file",accept:"image/*",onChange:function(e){var t=e.target.files;t[0];He(t),console.log(t)},multiple:!0}),r.a.createElement("input",{type:"submit",value:"Upload Croquis Images"})))))},Ke=function(e){var t=e.userObj,a=Object(n.useState)(""),l=Object(c.a)(a,2),o=(l[0],l[1]),i=Object(n.useState)([]),u=Object(c.a)(i,2),s=(u[0],u[1],Object(n.useState)(0)),d=Object(c.a)(s,2),f=d[0],g=d[1],h=Object(n.useRef)(),b=Object(n.useState)(3),v=Object(c.a)(b,2),E=(v[0],v[1],Object(n.useState)({brushRadius:.8,lazyRadius:0})),y=Object(c.a)(E,2),w=y[0],O=y[1],j=Object(n.useState)(0),S=Object(c.a)(j,2),x=S[0],C=S[1],k=Object(n.useState)(["https://www.adorkastock.com/sketch/","https://line-of-action.com/"]),R=Object(c.a)(k,2),D=R[0],I=(R[1],Object(n.useState)("#444")),F=Object(c.a)(I,2),T=F[0],P=F[1];Object(n.useEffect)(function(){m.doc("usersetting/"+t.uid).get().then(function(e){e.exists?O({brushRadius:e.data().brushRadius,lazyRadius:e.data().lazyRadius}):console.log("No such setting document!")}).catch(function(e){console.log("Error getting document:",e)})},[]);var z=function(){h.current.undo()},U=function(){P("erase")},L=function(){P("#444")},B=function(){P("shadow")};return r.a.createElement(r.a.Fragment,null,r.a.createElement(oe.a,{keyName:"ctrl+z,c,x",onKeyDown:function(e,t,a){"ctrl+z"==e&&z(),"c"==e&&("erase"!=T?U():"erase"==T&&L()),"x"==e&&("shadow"!=T?B():"shadow"==T&&L())}}),r.a.createElement("div",null,r.a.createElement("div",{style:{float:"right"}}),r.a.createElement("div",null,r.a.createElement("label",null,"videos:"),r.a.createElement("input",{type:"number",min:"0",max:D.length-1,style:{width:"30px"},value:x,onChange:function(e){C(e.target.value),g(f+1)}})),r.a.createElement("div",{style:{float:"left"}},r.a.createElement("iframe",{is:"x-frame-bypass",key:f,src:D[x],height:600,width:450,frameBorder:0})),r.a.createElement("div",{style:{float:"left"}},r.a.createElement("div",null,r.a.createElement("div",{style:{float:"right"}},r.a.createElement("label",null,"Lazy:"),r.a.createElement("input",{type:"number",min:"0",max:"100",style:{width:"30px"},value:w.lazyRadius,onChange:function(e){return O(function(t){return Object(p.a)({},t,{lazyRadius:e.target.value})})}})),r.a.createElement("div",{style:{float:"right"}},"erase"==T?r.a.createElement(r.a.Fragment,null,r.a.createElement("label",null,"Erase Size:"),r.a.createElement("input",{type:"number",min:"1",max:"100",style:{width:"30px"},value:w.eraseRadius,onChange:function(e){return O(function(t){return Object(p.a)({},t,{eraseRadius:e.target.value})})}})):r.a.createElement(r.a.Fragment,null,r.a.createElement("label",null,"Brush Size:"),r.a.createElement("input",{type:"number",min:"1",max:"100",style:{width:"30px"},value:w.brushRadius,onChange:function(e){return O(function(t){return Object(p.a)({},t,{brushRadius:e.target.value})})}}))),r.a.createElement("div",{style:{float:"right"}},r.a.createElement("button",{onClick:function(){h.current.clear()}},"Clear Canvas")),r.a.createElement("div",{style:{float:"right"}},r.a.createElement("button",{onClick:z},"\u25c0")),r.a.createElement("div",{style:{float:"right"}},"erase"==T?r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:L},"brush")):r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:U},"erase")),r.a.createElement("div",{style:{float:"right"}},"shadow"==T?r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:L},"brush")):r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:B},"shadow")),T)),r.a.createElement("div",{style:{float:"right"}},r.a.createElement("button",{onClick:function(e){e.preventDefault(),function(){var e=h.current.getSaveData(),a=h.current.getDataURL();h.current.clear(),m.collection("Csubmit").add({text:e,createdAt:Date.now(),creatorId:t.uid,drawingTime:0,heart:0,dataUrl:a,refPinUrl:""}),o("")}()}},"Upload Drawing"))),r.a.createElement("div",{style:{float:"right"}},r.a.createElement(Q,{canvasWidth:600,canvasHeight:600,brushRadius:"erase"==T?w.eraseRadius:w.brushRadius,lazyRadius:w.lazyRadius,ref:h,brushColor:T})))))},Qe=a(60);customElements.define("x-frame-bypass",function(e){function t(){return Object(y.a)(this,t),Object(O.a)(this,Object(j.a)(t).call(this))}return Object(S.a)(t,e),Object(w.a)(t,null,[{key:"observedAttributes",get:function(){return["src"]}}]),Object(w.a)(t,[{key:"attributeChangedCallback",value:function(){this.load(this.src)}},{key:"connectedCallback",value:function(){this.sandbox=""+this.sandbox||"allow-forms allow-modals allow-pointer-lock allow-popups allow-popups-to-escape-sandbox allow-presentation allow-same-origin allow-scripts allow-top-navigation-by-user-activation"}},{key:"load",value:function(e,t){var a=this;if(!e||!e.startsWith("http"))throw new Error("X-Frame-Bypass src ".concat(e," does not start with http(s)://"));console.log("X-Frame-Bypass loading:",e),this.srcdoc='<html>\n<head>\n\t<style>\n\t.loader {\n\t\tposition: absolute;\n\t\ttop: calc(50% - 25px);\n\t\tleft: calc(50% - 25px);\n\t\twidth: 50px;\n\t\theight: 50px;\n\t\tbackground-color: #333;\n\t\tborder-radius: 50%;  \n\t\tanimation: loader 1s infinite ease-in-out;\n\t}\n\t@keyframes loader {\n\t\t0% {\n\t\ttransform: scale(0);\n\t\t}\n\t\t100% {\n\t\ttransform: scale(1);\n\t\topacity: 0;\n\t\t}\n\t}\n\t</style>\n</head>\n<body>\n\t<div class="loader"></div>\n</body>\n</html>',this.fetchProxy(e,t,0).then(function(e){return e.text()}).then(function(t){t&&(a.srcdoc=t.replace(/<head([^>]*)>/i,'<head$1>\n\t<base href="'.concat(e,"\">\n\t<script>\n\t// X-Frame-Bypass navigation event handlers\n\tdocument.addEventListener('click', e => {\n\t\tif (frameElement && document.activeElement && document.activeElement.href) {\n\t\t\te.preventDefault()\n\t\t\tframeElement.load(document.activeElement.href)\n\t\t}\n\t})\n\tdocument.addEventListener('submit', e => {\n\t\tif (frameElement && document.activeElement && document.activeElement.form && document.activeElement.form.action) {\n\t\t\te.preventDefault()\n\t\t\tif (document.activeElement.form.method === 'post')\n\t\t\t\tframeElement.load(document.activeElement.form.action, {method: 'post', body: new FormData(document.activeElement.form)})\n\t\t\telse\n\t\t\t\tframeElement.load(document.activeElement.form.action + '?' + new URLSearchParams(new FormData(document.activeElement.form)))\n\t\t}\n\t})\n\t<\/script>")))}).catch(function(e){return console.error("Cannot load X-Frame-Bypass:",e)})}},{key:"fetchProxy",value:function(e,t,a){var n=this,r=(t||{}).proxies||["https://croquistoolcors.herokuapp.com/","https://cors-anywhere.herokuapp.com/","https://yacdn.org/proxy/","https://api.codetabs.com/v1/proxy/?quest="];return fetch(r[a]+e,t).then(function(e){if(!e.ok)throw new Error("".concat(e.status," ").concat(e.statusText));return e}).catch(function(l){if(a===r.length-1)throw l;return n.fetchProxy(e,t,a+1)})}}]),t}(Object(Qe.a)(HTMLIFrameElement)),{extends:"iframe"});var $e=function(e){var t=e.userObj,a=Object(n.useState)(""),l=Object(c.a)(a,2),o=(l[0],l[1]),i=Object(n.useState)([]),u=Object(c.a)(i,2),s=(u[0],u[1],Object(n.useState)(0)),d=Object(c.a)(s,2),f=d[0],g=d[1],h=Object(n.useRef)(),b=Object(n.useState)(3),v=Object(c.a)(b,2),E=(v[0],v[1],Object(n.useState)({brushRadius:.8,lazyRadius:0})),y=Object(c.a)(E,2),w=y[0],O=y[1],j=Object(n.useState)(0),S=Object(c.a)(j,2),x=S[0],C=S[1],k=Object(n.useState)(["https://line-of-action.com/"]),R=Object(c.a)(k,2),D=R[0],I=(R[1],Object(n.useState)("#444")),F=Object(c.a)(I,2),T=F[0],P=F[1];Object(n.useEffect)(function(){m.doc("usersetting/"+t.uid).get().then(function(e){e.exists?O({brushRadius:e.data().brushRadius,lazyRadius:e.data().lazyRadius}):console.log("No such setting document!")}).catch(function(e){console.log("Error getting document:",e)})},[]);var z=function(){h.current.undo()},U=function(){P("erase")},L=function(){P("#444")},B=function(){P("shadow")};return r.a.createElement(r.a.Fragment,null,r.a.createElement(oe.a,{keyName:"ctrl+z,c,x",onKeyDown:function(e,t,a){"ctrl+z"==e&&z(),"c"==e&&("erase"!=T?U():"erase"==T&&L()),"x"==e&&("shadow"!=T?B():"shadow"==T&&L())}}),r.a.createElement("div",null,r.a.createElement("div",{style:{float:"right"}}),r.a.createElement("div",null,r.a.createElement("label",null,"videos:"),r.a.createElement("input",{type:"number",min:"0",max:D.length-1,style:{width:"30px"},value:x,onChange:function(e){C(e.target.value),g(f+1)}})),r.a.createElement("div",{style:{float:"left"}},r.a.createElement("iframe",{is:"x-frame-bypass",key:f,src:D[x],height:600,width:450,frameBorder:0})),r.a.createElement("div",{style:{float:"left"}},r.a.createElement("div",null,r.a.createElement("div",{style:{float:"right"}},r.a.createElement("label",null,"Lazy:"),r.a.createElement("input",{type:"number",min:"0",max:"100",style:{width:"30px"},value:w.lazyRadius,onChange:function(e){return O(function(t){return Object(p.a)({},t,{lazyRadius:e.target.value})})}})),r.a.createElement("div",{style:{float:"right"}},"erase"==T?r.a.createElement(r.a.Fragment,null,r.a.createElement("label",null,"Erase Size:"),r.a.createElement("input",{type:"number",min:"1",max:"100",style:{width:"30px"},value:w.eraseRadius,onChange:function(e){return O(function(t){return Object(p.a)({},t,{eraseRadius:e.target.value})})}})):r.a.createElement(r.a.Fragment,null,r.a.createElement("label",null,"Brush Size:"),r.a.createElement("input",{type:"number",min:"1",max:"100",style:{width:"30px"},value:w.brushRadius,onChange:function(e){return O(function(t){return Object(p.a)({},t,{brushRadius:e.target.value})})}}))),r.a.createElement("div",{style:{float:"right"}},r.a.createElement("button",{onClick:function(){h.current.clear()}},"Clear Canvas")),r.a.createElement("div",{style:{float:"right"}},r.a.createElement("button",{onClick:z},"\u25c0")),r.a.createElement("div",{style:{float:"right"}},"erase"==T?r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:L},"brush")):r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:U},"erase")),r.a.createElement("div",{style:{float:"right"}},"shadow"==T?r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:L},"brush")):r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:B},"shadow")),T)),r.a.createElement("div",{style:{float:"right"}},r.a.createElement("button",{onClick:function(e){e.preventDefault(),function(){var e=h.current.getSaveData(),a=h.current.getDataURL();h.current.clear(),m.collection("Csubmit").add({text:e,createdAt:Date.now(),creatorId:t.uid,drawingTime:0,heart:0,dataUrl:a,refPinUrl:""}),o("")}()}},"Upload Drawing"))),r.a.createElement("div",{style:{float:"right"}},r.a.createElement(Q,{canvasWidth:600,canvasHeight:600,brushRadius:"erase"==T?w.eraseRadius:w.brushRadius,lazyRadius:w.lazyRadius,ref:h,brushColor:T})))))},et=function(e){var t=e.userObj,a=Object(n.useState)(""),l=Object(c.a)(a,2),o=(l[0],l[1]),u=Object(n.useState)(0),s=Object(c.a)(u,2),d=s[0],f=s[1],g=Object(n.useRef)(),h=Object(n.useState)(3),b=Object(c.a)(h,2),v=b[0],y=b[1],w=Object(n.useState)({brushRadius:1,lazyRadius:0}),O=Object(c.a)(w,2),j=O[0],S=O[1],x=Object(n.useState)("HourlyLizards"),C=Object(c.a)(x,2),k=C[0],R=C[1],D=Object(n.useState)("#444"),I=Object(c.a)(D,2),F=I[0],T=I[1],P=Object(n.useState)(!0),z=Object(c.a)(P,2),U=z[0],L=z[1],B=Object(n.useState)(!1),A=Object(c.a)(B,2),M=A[0],N=A[1],q=Object(n.useState)(!1),V=Object(c.a)(q,2),_=V[0],W=V[1],H=Object(n.useState)([]),X=Object(c.a)(H,2),Y=X[0],J=X[1];Object(n.useEffect)(function(){m.doc("usersetting/"+t.uid).get().then(function(e){e.exists?(S({brushRadius:e.data().brushRadius,lazyRadius:e.data().lazyRadius}),console.log(e.data()),J(e.data().twitterBookmark),console.log(e.data().twitterBookmark),console.log(Y)):console.log("No such setting document!")}).catch(function(e){console.log("Error getting document:",e)}),y(parseInt(localStorage.getItem("penType")))},[]);var G=function(){g.current.undo()},Z=function(){T("erase")},K=function(){T("#444")},$=function(){T("shadow")};return Object(n.useEffect)(function(){var e=document.createElement("script");e.setAttribute("src","https://platform.twitter.com/widgets.js"),document.getElementsByClassName("twitter-timeline")[0].appendChild(e)},[d]),r.a.createElement(r.a.Fragment,null,r.a.createElement(oe.a,{keyName:"ctrl+z,c,x",onKeyDown:function(e,t,a){"ctrl+z"==e&&G(),"c"==e&&("erase"!=F?Z():"erase"==F&&K()),"x"==e&&("shadow"!=F?$():"shadow"==F&&K())}}),r.a.createElement("div",null,r.a.createElement("div",{style:{float:"right"}}),r.a.createElement("div",null,r.a.createElement("form",{style:{float:"left"},onSubmit:function(e){e.preventDefault(),f(d+1),Y.includes(k)?L(!0):L(!1)}},r.a.createElement("input",{value:k,onChange:function(e){R(e.target.value)},type:"text",placeholder:"@name"}),r.a.createElement("input",{type:"submit",value:"Go"})),r.a.createElement("button",{onClick:function(e){e.preventDefault(),console.log(Y),N(!M)}},"\u2764list"),U?r.a.createElement(r.a.Fragment,null):r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:function(e){e.preventDefault(),Y.includes(k)?L(!0):(m.collection("usersetting").doc(t.uid).update({twitterBookmark:i.a.firestore.FieldValue.arrayUnion(k)}),J([k].concat(Object(E.a)(Y)))),L(!0)}},"\u2764")),M?r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:function(e){e.preventDefault(),W(!_)}},"\ud83d\uddd1"),_?r.a.createElement(r.a.Fragment,null,Y.map(function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:function(a){a.preventDefault(),m.collection("usersetting").doc(t.uid).update({twitterBookmark:i.a.firestore.FieldValue.arrayRemove(e)});var n=Y.filter(function(t){return t!==e});J(n)}},"\ud83d\uddd1",e))})):r.a.createElement(r.a.Fragment,null,Y.map(function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:function(t){t.preventDefault(),R(e)}},e))}))):r.a.createElement(r.a.Fragment,null)),r.a.createElement("div",{style:{float:"left",width:"450px",height:"770px",position:"absolute"}},r.a.createElement("div",{key:d,style:{float:"left",width:"450px",height:"770px",position:"absolute"}},r.a.createElement("a",{class:"twitter-timeline","data-width":"450","data-height":"770",href:"https://twitter.com/"+k+"?ref_src=twsrc%5Etfw"}))),r.a.createElement("div",{style:{float:"left",position:"absolute",left:"460px"}},r.a.createElement("div",null,r.a.createElement("div",{style:{float:"right"}},r.a.createElement("label",null,"Lazy:"),r.a.createElement("input",{type:"number",min:"0",max:"100",style:{width:"30px"},value:j.lazyRadius,onChange:function(e){return S(function(t){return Object(p.a)({},t,{lazyRadius:e.target.value})})}})),r.a.createElement("div",{style:{float:"right"}},"erase"==F?r.a.createElement(r.a.Fragment,null,r.a.createElement("label",null,"Erase Size:"),r.a.createElement("input",{type:"number",min:"1",max:"100",style:{width:"30px"},value:j.eraseRadius,onChange:function(e){return S(function(t){return Object(p.a)({},t,{eraseRadius:e.target.value})})}})):r.a.createElement(r.a.Fragment,null,r.a.createElement("label",null,"Brush Size:"),r.a.createElement("input",{type:"number",min:"1",max:"100",style:{width:"30px"},value:j.brushRadius,onChange:function(e){return S(function(t){return Object(p.a)({},t,{brushRadius:e.target.value})})}}))),r.a.createElement("div",{style:{float:"right"}},r.a.createElement("button",{onClick:function(){window.confirm("wanna clear this?")&&g.current.clear()}},"Clear Canvas")),r.a.createElement("div",{style:{float:"right"}},r.a.createElement("button",{onClick:G},"\u25c0")),r.a.createElement("div",{style:{float:"right"}},"erase"==F?r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:K},"brush")):r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:Z},"erase"))),r.a.createElement("div",{style:{float:"right"}},"shadow"==F?r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:K},"brush")):r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:$},"shadow")),F),r.a.createElement("div",{style:{float:"right"}},r.a.createElement("button",{onClick:function(e){e.preventDefault(),function(){var e=g.current.getSaveData(),a=g.current.getDataURL();g.current.clear(),m.collection("Csubmit").add({text:e,createdAt:Date.now(),creatorId:t.uid,drawingTime:0,heart:0,dataUrl:a,refPinUrl:""}),o("")}()}},"Upload Drawing"))),r.a.createElement("div",{style:{float:"right"}},r.a.createElement(Q,{canvasWidth:600,canvasHeight:600,brushRadius:"erase"==F?j.eraseRadius:j.brushRadius,lazyRadius:j.lazyRadius,ref:g,brushColor:F,allowOnlyPointerType:["all","mouse","touch","pen"][v]})))))},tt=a(90),at=a.n(tt),nt=a(91),rt=a.n(nt),lt=a(92),ot=a.n(lt),ct=a(93),it=a.n(ct),ut=function(e){var t=e.userObj,a=e.isAndroid,l=(e.penType,Object(n.useState)([])),o=Object(c.a)(l,2),u=(o[0],o[1]),s=Object(n.useState)([""]),d=Object(c.a)(s,2),f=(d[0],d[1]),g=Object(n.useState)(""),h=Object(c.a)(g,2),b=(h[0],h[1]),v=Object(n.useState)([]),E=Object(c.a)(v,2),y=(E[0],E[1],Object(n.useState)([])),w=Object(c.a)(y,2),O=(w[0],w[1],Object(n.useState)([])),j=Object(c.a)(O,2),S=j[0],x=j[1],C=Object(n.useState)(""),k=Object(c.a)(C,2),R=k[0],D=k[1],I=Object(n.useRef)(),F=Object(n.useState)(""),T=Object(c.a)(F,2),P=(T[0],T[1],Object(n.useState)([])),z=Object(c.a)(P,2),U=z[0],L=z[1],B=Object(n.useState)(0),A=Object(c.a)(B,2),M=A[0],N=A[1],q=Object(n.useState)(0),V=Object(c.a)(q,2),_=V[0],W=V[1],H=Object(n.useState)(60),X=Object(c.a)(H,2),Y=X[0],J=X[1],G=["all","mouse","touch","pen"],Z=Object(n.useState)(3),K=Object(c.a)(Z,2),$=K[0],ee=K[1],te=Object(n.useState)(0),ae=Object(c.a)(te,2),ne=ae[0],re=(ae[1],Object(n.useState)(0)),le=Object(c.a)(re,2),ce=le[0],ie=(le[1],Object(n.useRef)(Y)),ue=(Object(n.useRef)(null),Object(n.useState)({croquisTimeDB:60,brushRadius:.6,lazyRadius:1,eraseRadius:10})),se=Object(c.a)(ue,2),me=se[0],de=se[1],fe=Object(n.useState)(!1),ge=Object(c.a)(fe,2),pe=ge[0],he=ge[1],be=Object(n.useState)("#444"),ve=Object(c.a)(be,2),Ee=ve[0],ye=ve[1],we=Object(n.useState)(1),Oe=Object(c.a)(we,2),je=Oe[0],Se=Oe[1],xe=Object(n.useState)(!1),Ce=Object(c.a)(xe,2),ke=(Ce[0],Ce[1],Object(n.useState)(!1)),Re=Object(c.a)(ke,2),De=Re[0],Ie=Re[1],Fe=Object(n.useState)([]),Te=Object(c.a)(Fe,2),Pe=Te[0],ze=Te[1],Ue=Object(n.useState)(0),Le=Object(c.a)(Ue,2),Be=Le[0],Ae=Le[1],Me=function(e){m.collection("usersetting").doc(t.uid).update({brushRadius:me.brushRadius,lazyRadius:me.lazyRadius,eraseRadius:me.eraseRadius})};function Ne(e){for(var t=e.length-1;t>0;t--){var a=Math.floor(Math.random()*(t+1)),n=[e[a],e[t]];e[t]=n[0],e[a]=n[1]}return e}Object(n.useEffect)(function(){var e=setTimeout(function(){console.log("One second has passed!");var e=localStorage.getItem("redrawDesign");0!=e.length&&(console.log("redraw!"),I.current.loadSaveData(e))},1e3);return function(){return clearTimeout(e)}},[]),Object(n.useEffect)(function(){ee(parseInt(localStorage.getItem("penType"))),it.a.parse(ot.a,{download:!0,complete:function(e){var t=e.data.sort(function(e,t){return t[1]-e[1]});ze(t),console.log("\uac12:",Object.values(t)),console.log("\uac12:",typeof Object.values(t)[0])}});var e=[];m.doc("RefDB/refStrings").get().then(function(t){if(t.exists){var a=t.data();Object.keys(a).forEach(function(t){console.log(t),e.push({list:t,url:a[t]})})}else console.log("ref1 No such document!")}).catch(function(e){console.log("ref1 Error getting document:",e)}).then(function(t){m.doc("RefDB/refStrings2").get().then(function(t){if(t.exists){var a=t.data();Object.keys(a).forEach(function(t){console.log(t),e.push({list:t+"-2",url:a[t]})}),e.sort(function(e,t){return e.list.localeCompare(t.list)}),x(e);var n=Ne(e.flatMap(function(e){return e.url}));if(u(n),void 0==localStorage.getItem("chadraw")){var r=Ne(Object.values(e[0].url));L(r),f(r)}else{var l=Ne(Object.values(e[parseInt(localStorage.getItem("chadraw"))].url));L(l),f(l)}}else console.log("ref2 No such document!")}).catch(function(e){console.log("ref2  Error getting document:",e)})})},[]);var qe=function(e){var t=e.target.value;J(t),de(function(t){return Object(p.a)({},t,{croquisTimeDB:e.target.value})})},Ve=function(e){e.preventDefault(),he(!1)},_e=function(){m.doc("RefDB/refStrings").update(Object(Je.a)({},R,i.a.firestore.FieldValue.arrayRemove(U[_]))),N(M+1),W(_+1)},We=function(){I.current.undo()},He=function(){ye("erase")},Xe=function(){ye("#444")},Ye=function(){ye("shadow")};function Ge(e){var t=e%10,a=e%100;return 1==t&&11!=a?e+"st":2==t&&12!=a?e+"nd":3==t&&13!=a?e+"rd":e+"th"}var Ze;return r.a.createElement(r.a.Fragment,null,r.a.createElement(oe.a,{keyName:"ctrl+z,c,x",onKeyDown:function(e,t,a){"ctrl+z"==e&&We(),"c"==e&&("erase"!=Ee?He():"erase"==Ee&&Xe()),"x"==e&&("shadow"!=Ee?Ye():"shadow"==Ee&&Xe())}}),r.a.createElement("div",null,a?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{float:"right"}},pe?r.a.createElement(r.a.Fragment,null,r.a.createElement("form",{onSubmit:Ve},r.a.createElement("input",{value:Y,onChange:qe,type:"number",placeholder:"Input Croquis Time"}),r.a.createElement("input",{type:"submit",value:"Set Time"})),r.a.createElement("button",{onClick:_e},"Delete Pin"),r.a.createElement("button",{onClick:function(e){0==$?(ee(3),localStorage.setItem("penType",parseInt(3))):3==$&&(ee(0),localStorage.setItem("penType",parseInt(0)))}},G[$]),r.a.createElement("button",{onClick:function(e){0==$?ee(3):3==$&&ee(0)}},G[$])):r.a.createElement(r.a.Fragment,null,Ge(_+1),r.a.createElement("button",{onClick:function(e){he(!0)}},"Set Time")),r.a.createElement("button",{onClick:Me},"Update Setting"))):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{width:"1000px"}},r.a.createElement("div",{style:{float:"right"}},pe?r.a.createElement(r.a.Fragment,null,r.a.createElement("form",{onSubmit:Ve},r.a.createElement("input",{value:Y,onChange:qe,type:"number",placeholder:"Input Croquis Time"}),r.a.createElement("input",{type:"submit",value:"Set Time"})),r.a.createElement("button",{onClick:_e},"Delete Pin"),r.a.createElement("button",{onClick:function(e){0==$?(ee(3),localStorage.setItem("penType",parseInt(3))):3==$&&(ee(0),localStorage.setItem("penType",parseInt(0)))}},G[$])):r.a.createElement(r.a.Fragment,null,Ge(_+1),r.a.createElement("button",{onClick:function(e){he(!0)}},"Set Time")),r.a.createElement("button",{onClick:Me},"Update Setting")))),r.a.createElement("div",{style:{float:"right"}},r.a.createElement("button",{onClick:function(){window.confirm("wanna clear this?")&&I.current.clear()}},"Clear Canvas")),r.a.createElement("div",{style:{float:"right"}},r.a.createElement("button",{onClick:function(e){e.preventDefault(),window.confirm("wanna upload this?")&&function(){ie.current=Y;var e=I.current.getSaveData(),a=I.current.getDataURL();m.collection("Dsubmit").add({text:e,createdAt:Date.now(),creatorId:t.uid,drawingTime:Y-60*ne-ce,heart:0,dataUrl:a,refPinUrl:U[_]}),b(""),localStorage.setItem("redrawDesign","")}()}},"Upload"),r.a.createElement("button",{onClick:function(e){e.preventDefault(),window.confirm("wanna upload this?")&&function(){ie.current=Y;var e=I.current.getSaveData(),a=I.current.props.canvasWidth,n=I.current.props.canvasHeight,r=I.current.canvasContainer.children[0],l=I.current.canvasContainer.children[1],o=document.createElement("canvas");o.width=a,o.height=n,o.getContext("2d").drawImage(r,0,0),o.getContext("2d").drawImage(l,0,0);var c=o.toDataURL("image/png");m.collection("Dsubmit").add({text:e,createdAt:Date.now(),creatorId:t.uid,drawingTime:Y-60*ne-ce,heart:0,dataUrl:c,refPinUrl:U[_]}),b(""),localStorage.setItem("redrawDesign","")}()}},"With Img")),r.a.createElement("div",{style:{float:"right"}},r.a.createElement("button",{onClick:function(e){e.preventDefault(),N(M+1),W(_+1)}},"Next")),r.a.createElement("div",{style:{float:"right"}},r.a.createElement("button",{onClick:function(e){Se(function(e){return 2})}},"+2")),r.a.createElement("div",{style:{position:"absolute",left:"30%",transform:"translateX(-50%)",width:"70px",textAlign:"center",background:"linear-gradient(to left,#FFC365 "+100*(60*ne+ce)/Y+"%,#E8E8E8 "+100*(60*ne+ce)/Y+"%)"}},ne,": ",(Ze=ce)<=9?"0"+Ze:Ze),r.a.createElement("div",null,r.a.createElement("select",{defaultValue:1,onChange:function(e){D(S[e.target.value].list),localStorage.setItem("chadraw",parseInt(e.target.value));var t=Ne(Object.values(S[e.target.value].url));L(t)}},S.map(function(e,t){return r.a.createElement("option",{key:e.list,value:t,selected:localStorage.getItem("chadraw")?t===parseInt(localStorage.getItem("chadraw")):0===t},e.list)})),r.a.createElement("button",{onClick:function(e){Ie(function(e){return!e})}},"char"),1==De&&r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:function(e){Ae(Math.floor(363*Math.random()))}},"random"),r.a.createElement("input",{type:"number",min:"0",max:"362",style:{width:"40px"},value:Be,onChange:function(e){var t=parseInt(e.target.value,10);!isNaN(t)&&t>=0&&t<=362&&Ae(t)}}),r.a.createElement("button",{onClick:function(e){Ae(function(e){return e>0?e-1:e})}},"\u25c0"),r.a.createElement("button",{onClick:function(e){Ae(function(e){return e<362?e+1:e})}},"\u25b6"))),r.a.createElement("div",{style:{float:"left"}},1==De?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{class:"custom-div"},Pe.length>0?r.a.createElement(r.a.Fragment,null,r.a.createElement("p",null,r.a.createElement("a",{href:Pe[Be][1],target:"_blank"},"link")),Pe[Be][1].split("/").length>5?r.a.createElement(r.a.Fragment,null,r.a.createElement("p",null,r.a.createElement("a",{href:Pe[Be][1].split("/").slice(0,5).join("/"),target:"_blank"},"original link"))):r.a.createElement(r.a.Fragment,null),r.a.createElement("div",{style:{whiteSpace:"pre-line"}},r.a.createElement("p",null,Pe[Be][2]),r.a.createElement("br",null),r.a.createElement("p",null,Pe[Be][5].slice(Pe[Be][5].indexOf("\uc885\uc871: "))),r.a.createElement("br",null),r.a.createElement("p",null,Pe[Be][3]),r.a.createElement("br",null),r.a.createElement("p",null,Pe[Be][4]),r.a.createElement("br",null),r.a.createElement("p",null,Pe[Be][6]),r.a.createElement("br",null),r.a.createElement("p",null,Pe[Be][7]),r.a.createElement("br",null),r.a.createElement("p",null,Pe[Be][8]))):r.a.createElement("p",null,"Loading data..."))):r.a.createElement(r.a.Fragment,null,"string"==typeof U[_]&&U[_].startsWith("pot.com/o/")?r.a.createElement(r.a.Fragment,null,r.a.createElement("img",{key:M,src:U[_].replace("pot.com/o/","https://firebasestorage.googleapis.com/v0/b/croquistool.appspot.com/o/"),width:400,frameBorder:0,scrolling:"no"})):r.a.createElement(r.a.Fragment,null,"string"==typeof U[_]&&U[_].includes("firebasestorage.googleapis.com")?r.a.createElement(r.a.Fragment,null,r.a.createElement("img",{key:M,src:U[_],width:400,frameBorder:0,scrolling:"no"})):r.a.createElement(r.a.Fragment,null,r.a.createElement("iframe",{key:M,src:"https://assets.pinterest.com/ext/embed.html?id="+U[_],height:770,width:400,frameBorder:0,scrolling:"no"}))))),r.a.createElement("div",{style:{float:"left"}},r.a.createElement("div",null,r.a.createElement("div",{style:{float:"right"}},r.a.createElement("label",null,"Lazy:"),r.a.createElement("input",{type:"number",min:"0",max:"100",style:{width:"30px"},value:me.lazyRadius,onChange:function(e){return de(function(t){return Object(p.a)({},t,{lazyRadius:e.target.value})})}})),r.a.createElement("div",{style:{float:"right"}},"erase"==Ee?r.a.createElement(r.a.Fragment,null,r.a.createElement("label",null,"Erase Size:"),r.a.createElement("input",{type:"number",min:"1",max:"100",style:{width:"30px"},value:me.eraseRadius,onChange:function(e){return de(function(t){return Object(p.a)({},t,{eraseRadius:e.target.value})})}})):r.a.createElement(r.a.Fragment,null,r.a.createElement("label",null,"Brush Size:"),r.a.createElement("input",{type:"number",min:"1",max:"100",style:{width:"30px"},value:me.brushRadius,onChange:function(e){return de(function(t){return Object(p.a)({},t,{brushRadius:e.target.value})})}}))),r.a.createElement("div",{style:{float:"left"}},r.a.createElement("button",{onClick:We},"\u25c0")),r.a.createElement("div",{style:{float:"left"}},"erase"==Ee?r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:Xe},"brush")):r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:He},"erase"))),r.a.createElement("div",{style:{float:"left"}},"shadow"==Ee?r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:Xe},"brush")):r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:Ye},"shadow")),Ee)),r.a.createElement("div",{style:{float:"right"}},r.a.createElement(Q,{imgSrc:1==je?at.a:rt.a,canvasWidth:600,canvasHeight:600,brushRadius:"erase"==Ee?me.eraseRadius:me.brushRadius,lazyRadius:me.lazyRadius,ref:I,brushColor:Ee,refreshBackgroundImage:!0,immediateLoading:!0,allowOnlyPointerType:G[$]})),r.a.createElement("div",null,r.a.createElement("button",{onClick:function(){var e=localStorage.getItem("redrawDesign");0!=e.length&&(console.log("redraw!"),I.current.loadSaveData(e))}},"load"))))," ",r.a.createElement("div",null,U[_]&&U[_].includes("pokemon")?r.a.createElement("a",{href:"https://podic.kr/Gen4/mon/mon"+U[_].toString().split("/pokemon-2%2F")[1].split(".png?alt=media")[0].slice(0,-2)+".html",target:"_blank"},U[_].toString().split("/pokemon-2%2F")[1].split(".png?alt=media")[0].slice(0,-2)):r.a.createElement("span",null,"Loading...")))},st=function(e){var t=e.DsubmitObj,a=e.isOwner,l=(e.viewDeleyToggle,Object(n.useState)(!1)),o=Object(c.a)(l,2),u=o[0],s=o[1],d=Object(n.useState)(t.text),f=Object(c.a)(d,2),g=(f[0],f[1],Object(n.useRef)()),p=Object(n.useState)(!0),h=Object(c.a)(p,2),E=(h[0],h[1]),y=new Date(t.createdAt),w=Object(n.useState)(!1),O=Object(c.a)(w,2),j=O[0],S=O[1],x=function(){var e=Object(v.a)(b.a.mark(function e(){return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return E(function(e){return!e}),e.next=3,m.doc("Dsubmit/".concat(t.id)).update({heart:1+t.heart});case 3:console.log(t.heart),m.doc("RefDB/refStrings").update({heart:i.a.firestore.FieldValue.arrayUnion(t.refPinUrl)});case 6:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();return r.a.createElement("div",{style:{float:"left",border:"10px solid rgba(0, 0, 0, 0.05)",width:"420px"}},u?r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:function(e){e.preventDefault();var a=g.current.getSaveData(),n=g.current.getDataURL();m.doc("Dsubmit/".concat(t.id)).update({text:a,dataUrl:n}),s(!1)}},"Edit"),r.a.createElement("div",null,r.a.createElement(Q,{ref:g,brushRadius:.6,lazyRadius:.5,brushColor:"#df6161",allowOnlyPointerType:"pen",loadTimeOffset:1})),r.a.createElement("button",{onClick:function(){g.current.clear(),g.current.loadSaveData(t.text)}},"Rewind"),r.a.createElement("button",{onClick:function(){s(!1)}},"Cancel")):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{margin:"0 auto"}},r.a.createElement($.LazyLoadImage,{height:400,src:t.dataUrl})),a?r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:x,style:{padding:"0px 0px"}},0==t.heart?r.a.createElement(r.a.Fragment,null,"\u2764"):r.a.createElement(r.a.Fragment,null,"+",t.heart)),r.a.createElement("button",{onClick:function(){window.confirm("wanna delete this?")&&m.doc("Dsubmit/".concat(t.id)).delete()}},"Delete"),r.a.createElement("button",{onClick:function(){s(!0),setTimeout(function(){g.current.loadSaveData(t.text)},5)}},"Review")):r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:x},"\u2764 ",t.heart))),r.a.createElement("button",{onClick:function(){S(function(e){return!e})}},"Ref Pin"),"   ","  ",y.toLocaleString(navigator.language||navigator.userLanguage),j?r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:function(){window.confirm("wanna redraw this?")&&localStorage.setItem("redrawDesign",t.text)}},"redraw"),r.a.createElement("div",null,t.refPinUrl.startsWith("pot.com/o/")?r.a.createElement(r.a.Fragment,null,r.a.createElement("img",{src:t.refPinUrl.replace("pot.com/o/","https://firebasestorage.googleapis.com/v0/b/croquistool.appspot.com/o/"),width:415,frameBorder:0,scrolling:"no"})):r.a.createElement(r.a.Fragment,null,"string"==typeof t.refPinUrl&&t.refPinUrl.includes("firebasestorage.googleapis.com")?r.a.createElement(r.a.Fragment,null,r.a.createElement("img",{src:t.refPinUrl,width:415,frameBorder:0,scrolling:"no"})):r.a.createElement(r.a.Fragment,null,r.a.createElement("iframe",{src:"https://assets.pinterest.com/ext/embed.html?id="+t.refPinUrl,height:"600",width:"300",frameBorder:0,scrolling:"no"}))))):r.a.createElement(r.a.Fragment,null))},mt=function(e){var t=e.userObj,a=Object(n.useState)([]),l=Object(c.a)(a,2),o=l[0],i=l[1],u=Object(n.useState)(!1),d=Object(c.a)(u,2),f=(d[0],d[1],Object(n.useState)(!1)),g=Object(c.a)(f,2),h=g[0],b=(g[1],Object(n.useState)(new Date)),v=Object(c.a)(b,2),E=v[0],y=(v[1],Object(n.useState)(26586748e5)),w=Object(c.a)(y,2),O=w[0],j=w[1],S=Object(n.useState)(100),x=Object(c.a)(S,2),C=x[0],k=x[1],R=Object(n.useState)(!1),D=Object(c.a)(R,2),I=D[0],F=D[1],T=Object(n.useState)(!1),P=Object(c.a)(T,2),z=P[0],U=P[1],L=Object(n.useState)(!1),B=Object(c.a)(L,2),A=B[0],M=B[1],N=Object(n.useState)("test"),q=Object(c.a)(N,2),V=q[0],_=q[1];Object(n.useEffect)(function(){m.doc("usersetting/"+t.uid).get().then(function(e){e.exists?_(e.data().Dmemo):console.log("No such setting document!")}).catch(function(e){console.log("Error getting document:",e)})},[]);Object(n.useEffect)(function(){m.collection("Dsubmit").where("creatorId","==",t.uid).orderBy("createdAt","desc").where("createdAt","<",O+864e5).limit(C).onSnapshot(function(e){var t=e.docs.map(function(e){return Object(p.a)({id:e.id},e.data())});i(t)})},[O]);return r.a.createElement(r.a.Fragment,null,r.a.createElement("span",null,"Profile"),r.a.createElement("button",{onClick:function(){window.confirm("wanna logout?")&&s.signOut()}},"Log Out"),r.a.createElement("button",{onClick:function(){F(function(e){return!e})}},"Calender"),I?r.a.createElement(r.a.Fragment,null,r.a.createElement(ae.a,{value:E,onClickDay:function(e){j(e.getTime()),console.log(e.getTime())},calendarType:"US"})):r.a.createElement(r.a.Fragment,null),r.a.createElement("input",{value:C,onChange:function(e){var t=e.target.value;k(t),console.log("ddd")},type:"number",placeholder:"Input Croquis Time"}),r.a.createElement("button",{onClick:function(){U(function(e){return!e})}},"Memo"),z?r.a.createElement(r.a.Fragment,null,A?r.a.createElement(r.a.Fragment,null,r.a.createElement("form",null,r.a.createElement("p",null,r.a.createElement("textarea",{onChange:function(e){var t=e.target.value;_(t)},cols:"50",rows:"10"},V)),r.a.createElement("p",null,r.a.createElement("input",{type:"submit",value:"Submit",onClick:function(e){e.preventDefault(),m.collection("usersetting").doc(t.uid).update({Dmemo:V}),M(!1)}})))):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{whiteSpace:"pre-line",border:"10px solid rgba(0, 0, 0, 0.05)",padding:"10px"}},V)),r.a.createElement("button",{onClick:function(){M(function(e){return!e})}},"edit")):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{whiteSpace:"pre-line",border:"10px solid rgba(0, 0, 0, 0.05)",padding:"10px"}},V.substring(0,70))),r.a.createElement("div",null,o.map(function(e){return r.a.createElement(st,{DsubmitObj:e,isOwner:e.creatorId===t.uid,viewsToggle:h})})),r.a.createElement("div",null,r.a.createElement("button",{style:{float:"right",margin:"10px",marginRight:"500px",padding:"15px 30px"},onClick:function(){k(function(e){return e+100})}},"Next Page")))},dt=(a(137),function(e){var t=e.imagesrc,a=e.imageWidth,l=t,o=Object(n.useState)(1),i=Object(c.a)(o,2),u=i[0],s=i[1],m=Object(n.useState)(1),d=Object(c.a)(m,2),f=d[0],g=d[1],h=Object(n.useState)(1),b=Object(c.a)(h,2),v=b[0],E=b[1],y=Object(n.useState)(0),w=Object(c.a)(y,2),O=w[0],j=w[1],S=Object(n.useState)(100),x=Object(c.a)(S,2),C=x[0],k=x[1],R=Object(n.useState)(100),D=Object(c.a)(R,2),I=D[0],F=D[1],T=Object(n.useState)(.5),P=Object(c.a)(T,2),z=P[0],U=P[1],L=Object(n.useState)("none"),B=Object(c.a)(L,2),A=B[0],M=B[1];Object(n.useEffect)(function(){var e=new Image;e.src="https://firebasestorage.googleapis.com/v0/b/croquistool.appspot.com/o/"+l+"?alt=media";var t=l;console.log(typeof t);var n=1,r=1,o=1;if(void 0!=t){var c=t.split(/[_]/);console.log(c);var i=c[0].indexOf("%2F"),u=c[0].substring(i+3);M(u),n=Number(c[1]),r=Number(c[2]),o=Number(c[3])}g(n),s(r),E(o),e.onload=function(){console.log("\ub118\uc5b4\uc628\uac12",a,"\ucc98\uc74c\uac12",e.width,"\uc801\uc6a9\uac12"),k(e.width/n),F(e.height/r),console.log(n,o,l),U(a/(e.width/n))}},[l]);var N={width:C,height:I,backgroundImage:"url(".concat("https://firebasestorage.googleapis.com/v0/b/croquistool.appspot.com/o/"+l+"?alt=media",")"),backgroundPosition:"-".concat(0*C,"px -").concat(0*I,"px")},q=Object(n.useRef)(null),V=Object(n.useState)({Row:0,Col:0}),_=Object(c.a)(V,2),W=_[0],H=_[1];return r.a.createElement(r.a.Fragment,null,O+1,"/",v,"   ",A," ",r.a.createElement("a",{href:"https://firebasestorage.googleapis.com/v0/b/croquistool.appspot.com/o/"+l+"?alt=media",target:"_blank"},"link"),r.a.createElement("div",{style:{transform:"scale("+z+")",transformOrigin:"top left",width:a+"px"}},r.a.createElement("div",{ref:q,style:Object(p.a)({},N,{touchAction:"none",backgroundPosition:"-".concat(W.Row*C,"px -").concat(W.Col*I,"px")}),onPointerDown:function(e){var t=e.clientX,a=W.Row,n=4*W.Col+a;console.log("\ucc98\uc74c\uac12",n,v);var r=O,l=function(e){var a=e.clientX-t,n=parseInt(a/20),l=r+n;l<0&&(l=v+l%(f*u)),l>v-1&&(l-=v),j(l);var o=l%f,c=parseInt(l/f);o<0?o=0:o>f&&(o=0),c<0?c=0:c>u&&(c=0),H({Row:o,Col:c})};window.addEventListener("pointermove",l),window.addEventListener("pointerup",function(){window.removeEventListener("pointermove",l)})}})))}),ft=function(e){var t=e.userObj,a=e.isAndroid,l=(e.penType,Object(n.useState)("")),o=Object(c.a)(l,2),u=(o[0],o[1]),s=Object(n.useState)([]),f=Object(c.a)(s,2),g=(f[0],f[1],Object(n.useState)([])),h=Object(c.a)(g,2),E=(h[0],h[1],Object(n.useState)([])),y=Object(c.a)(E,2),w=y[0],O=y[1],j=Object(n.useState)(""),S=Object(c.a)(j,2),x=S[0],C=S[1],k=Object(n.useRef)(),R=Object(n.useState)(""),D=Object(c.a)(R,2),I=(D[0],D[1],Object(n.useState)([""])),F=Object(c.a)(I,2),T=F[0],P=F[1],z=Object(n.useState)(0),U=Object(c.a)(z,2),L=U[0],B=U[1],A=Object(n.useState)(0),M=Object(c.a)(A,2),N=M[0],q=M[1],V=Object(n.useState)(60),_=Object(c.a)(V,2),W=_[0],H=_[1],X=Object(n.useState)(3),Y=Object(c.a)(X,2),J=Y[0],G=Y[1],Z=Object(n.useState)(0),K=Object(c.a)(Z,2),$=K[0],ee=K[1],te=Object(n.useState)(0),ae=Object(c.a)(te,2),ne=ae[0],re=ae[1],le=Object(n.useRef)(W),ce=Object(n.useRef)(null),ie=Object(n.useState)({croquisTimeDB:60,brushRadius:1,lazyRadius:1,eraseRadius:10}),ue=Object(c.a)(ie,2),se=ue[0],me=ue[1],de=Object(n.useState)(!1),fe=Object(c.a)(de,2),ge=fe[0],pe=fe[1],he=Object(n.useState)("#444"),be=Object(c.a)(he,2),ve=be[0],Ee=be[1],ye=Object(n.useState)([]),we=Object(c.a)(ye,2),Oe=we[0],je=we[1],Se=Object(n.useState)("https://www.posespace.com/img/contact/krystalmari219contacta.jpg"),xe=Object(c.a)(Se,2),Ce=(xe[0],xe[1],Object(n.useState)([1,1])),ke=Object(c.a)(Ce,2),Re=(ke[0],ke[1],Object(n.useState)(1)),De=Object(c.a)(Re,2),Ie=De[0],Fe=De[1],Te=Object(n.useState)(1),Pe=Object(c.a)(Te,2),ze=Pe[0],Ue=Pe[1],Le=Object(n.useState)("none"),Be=Object(c.a)(Le,2),Ae=Be[0],Me=Be[1],Ne=function(e){m.collection("usersetting").doc(t.uid).update({brushRadius:se.brushRadius,lazyRadius:se.lazyRadius,croquisTimeDB:se.croquisTimeDB,eraseRadius:se.eraseRadius})},qe=function(){B(L+1),q(N+1),le.current=W;var e=k.current.getSaveData(),a=k.current.getDataURL();k.current.clear(),m.collection("Csubmit").add({text:e,createdAt:Date.now(),creatorId:t.uid,drawingTime:W-60*$-ne,heart:0,dataUrl:a,refPinUrl:"https://firebasestorage.googleapis.com/v0/b/croquistool.appspot.com/o/"+T[N]+"?alt=media"}),u("")};Object(n.useEffect)(function(){return m.doc("usersetting/"+t.uid).get().then(function(e){e.exists?(me({brushRadius:e.data().brushRadius,lazyRadius:e.data().lazyRadius,eraseRadius:e.data().eraseRadius,croquisTimeDB:e.data().croquisTimeDB}),H(e.data().croquisTimeDB),console.log(e.data()),le.current+=e.data().croquisTimeDB-60):console.log("No such setting document!")}).catch(function(e){console.log("Error getting document:",e)}),G(parseInt(localStorage.getItem("penType"))),ce.current=setInterval(function(){ee(parseInt(le.current/60)),re(le.current%60),le.current-=1,le.current=100},1e3),function(){return clearInterval(ce.current)}},[]),Object(n.useEffect)(function(){le.current<=-1&&qe()},[ne]),Object(n.useEffect)(function(){m.doc("RefDB/d360d").get().then(function(e){if(e.exists){var t=[],a=e.data();Object.keys(a).forEach(function(e){console.log(e),t.push({list:e,url:a[e]})}),t.sort(function(e,t){return e.list.localeCompare(t.list)}),O(t);var n=Object.values(t[0].url).sort(function(){return Math.random()-.5});P(n)}else console.log("No such document!")}).catch(function(e){console.log("Error getting document:",e)})},[]);var Ve=function(e){e.preventDefault(),qe()},_e=function(e){var t=e.target.value;Ue(t)},We=function(e){var t=e.target.value;Fe(t)},He=function(e){var t=e.target.value;H(t),me(function(t){return Object(p.a)({},t,{croquisTimeDB:e.target.value})})},Xe=function(e){e.preventDefault(),pe(!1)},Ye=function(e){e.preventDefault(),function(){le.current=W;var e=k.current.getSaveData(),a=k.current.getDataURL();k.current.clear(),m.collection("Csubmit").add({text:e,createdAt:Date.now(),creatorId:t.uid,drawingTime:W-60*$-ne,heart:0,dataUrl:a,refPinUrl:"https://firebasestorage.googleapis.com/v0/b/croquistool.appspot.com/o/"+T[N]+"?alt=media"}),u("")}()},Ge=function(e){e.preventDefault(),B(L+1),q(N+1),le.current=W},Ze=function(){var e=T[N],t=e.indexOf("%2F"),a=e.substring(t+3),n=e.substring(0,t);console.log(a,n);var r=a.split("_"),l=r[0]+"_"+ze+"_"+Ie+"_"+r[3]+"_"+r[4];console.log("oldname",a,"  newname",l);var o=n,c=r[4].split(/[-.]/);console.log(c);var u=d.ref(o+"/"+a);u.getDownloadURL().then(function(e){console.log("downloadurl",e),fetch(e).then(function(e){return e.blob()}).then(function(e){var t=new Blob([e],{type:e.type,name:l});console.log("File renamed",a,"=>",l),Me("rename..");var n=d.ref(o+"/"+l);n.put(t).then(function(){console.log("File reuploaded !",l),Me("reupload..")}).then(function(){u.delete().then(function(){console.log("old file removed!")}).then(function(){var e=m.doc("RefDB/d360d");n.getDownloadURL().then(function(t){for(var a=t.indexOf(".com/o/"),n=t.indexOf("jpg?"),r=t.substring(a+7,n+3),l=1;l<c.length-1;l++)e.update(Object(Je.a)({},c[l],i.a.firestore.FieldValue.arrayRemove(T[N]))),console.log("field deleted and updated in ",c[l],", "),Me("Done!"),e.update(Object(Je.a)({},c[l],i.a.firestore.FieldValue.arrayUnion(r)))})})})})})},Ke=function(){window.confirm("wanna clear this?")&&k.current.clear()},Qe=function(){k.current.undo()},$e=function(){Ee("erase")},et=function(){Ee("#444")},tt=function(){Ee("shadow")};function at(e){var t=e%10,a=e%100;return 1==t&&11!=a?e+"st":2==t&&12!=a?e+"nd":3==t&&13!=a?e+"rd":e+"th"}function nt(e){return e<=9?"0"+e:e}var rt=function(e){C(w[e.target.value].list);var t=Object.values(w[e.target.value].url).sort(function(){return Math.random()-.5});P(t)},lt=function(){var e=Object(v.a)(b.a.mark(function e(t){return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),ct(x,Oe),je([]);case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),ot=function(){var e=Object(v.a)(b.a.mark(function e(t,a){var n;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==a){e.next=2;break}return e.abrupt("return","");case 2:return e.prev=2,e.next=5,d.ref("/".concat(t,"/").concat(a.name)).put(a);case 5:return n=e.sent,e.abrupt("return",n.ref.getDownloadURL().then(function(e){return e}));case 9:e.prev=9,e.t0=e.catch(2),console.log(e.t0);case 12:case"end":return e.stop()}},e,null,[[2,9]])}));return function(t,a){return e.apply(this,arguments)}}(),ct=function(){var e=Object(v.a)(b.a.mark(function e(t,a){var n,r,l,o,c,u,s,d,f,g,p;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==a.length){e.next=2;break}return e.abrupt("return",[]);case 2:n=m.doc("RefDB/d360d"),r=0;case 4:if(!(r<a.length)){e.next=21;break}return l=a[r],e.next=8,ot("d360d",l);case 8:for(o=e.sent,c=o,console.log("fullurl",c),u=c.indexOf(".com/o/"),s=c.indexOf("jpg?"),d=c.substring(u+7,s+3),f=l.name,g=f.split(/[-.]/),console.log(g),p=1;p<g.length-1;p++)n.update(Object(Je.a)({},g[p],i.a.firestore.FieldValue.arrayUnion(d))),console.log("complete : ",r+1,"/",a.length,"in",g[p]," ",d);case 18:r++,e.next=4;break;case 21:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,r.a.createElement(oe.a,{keyName:"ctrl+z,c,x",onKeyDown:function(e,t,a){"ctrl+z"==e&&Qe(),"c"==e&&("erase"!=ve?$e():"erase"==ve&&et()),"x"==e&&("shadow"!=ve?tt():"shadow"==ve&&et())}}),r.a.createElement("div",null,a?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{float:"right"}},ge?r.a.createElement(r.a.Fragment,null,r.a.createElement("form",{onSubmit:Xe},r.a.createElement("input",{value:W,onChange:He,type:"number",placeholder:"Input Croquis Time"}),r.a.createElement("input",{type:"submit",value:"Set Time"})),Ae," :",r.a.createElement("input",{value:ze,onChange:_e,type:"number",placeholder:"Col",inputmode:"decimal"}),r.a.createElement("input",{value:Ie,onChange:We,type:"number",placeholder:"row",inputmode:"decimal"}),r.a.createElement("button",{onClick:Ze},"reset col row")):r.a.createElement(r.a.Fragment,null,at(N+1),r.a.createElement("button",{onClick:function(e){pe(!0)}},"Set Time")),r.a.createElement("button",{onClick:Ne},"Setting"))):r.a.createElement(r.a.Fragment,null," ",r.a.createElement("div",{style:{width:"1000px"}},r.a.createElement("div",{style:{float:"right"}},ge?r.a.createElement(r.a.Fragment,null,r.a.createElement("form",{onSubmit:Xe},r.a.createElement("input",{value:W,onChange:He,type:"number",placeholder:"Input Croquis Time"}),r.a.createElement("input",{type:"submit",value:"Set Time"})),Ae," :",r.a.createElement("input",{value:ze,onChange:_e,type:"number",placeholder:"Col",inputmode:"decimal"}),r.a.createElement("input",{value:Ie,onChange:We,type:"number",placeholder:"row",inputmode:"decimal"}),r.a.createElement("button",{onClick:Ze},"reset col row")):r.a.createElement(r.a.Fragment,null,at(N+1),r.a.createElement("button",{onClick:function(e){pe(!0)}},"Set Time")),r.a.createElement("button",{onClick:Ne},"Setting")))),a?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,r.a.createElement("select",{defaultValue:-1,onChange:rt},w.map(function(e,t){return r.a.createElement("option",{key:e.list,value:t},e.list)}))),r.a.createElement("div",{style:{float:"left"}},r.a.createElement("div",null,r.a.createElement(dt,{imagesrc:T[N],imageWidth:400})))):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{float:"right"}},r.a.createElement("button",{onClick:Ke},"Clear Canvas")),r.a.createElement("div",{style:{float:"right"}},r.a.createElement("button",{onClick:Ye},"Upload&Redraw")),r.a.createElement("div",{style:{float:"right"}},r.a.createElement("button",{onClick:Ve},"Upload")),r.a.createElement("div",{style:{float:"right"}},r.a.createElement("button",{onClick:Ge},"Next")),r.a.createElement("div",{style:{position:"absolute",left:"30%",transform:"translateX(-50%)",width:"70px",textAlign:"center",background:"linear-gradient(to left,#FFC365 "+100*(60*$+ne)/W+"%,#E8E8E8 "+100*(60*$+ne)/W+"%nSubmitPinNum)"}},$,": ",nt(ne)),r.a.createElement("div",null,r.a.createElement("form",null,r.a.createElement("select",{key:"cos",onChange:rt},w.map(function(e,t){return r.a.createElement("option",{key:e.list,value:t},e.list)})))),r.a.createElement("div",{style:{float:"left",width:"400"}},r.a.createElement(dt,{imagesrc:T[N],imageWidth:400}),"fd")),r.a.createElement("div",{style:{float:"left"}},r.a.createElement("div",null,a?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{float:"right"}},r.a.createElement("button",{onClick:Ke},"Clear")),r.a.createElement("div",{style:{float:"right"}},r.a.createElement("form",{onSubmit:Ye},r.a.createElement("input",{type:"submit",value:"Up&Re"}))),r.a.createElement("div",{style:{float:"right"}},r.a.createElement("form",{onSubmit:Ve},r.a.createElement("input",{type:"submit",value:"Up"}))),r.a.createElement("div",{style:{float:"right"}},r.a.createElement("button",{onClick:Ge},"Next")),r.a.createElement("div",{style:{float:"right"}},$,": ",nt(ne))):r.a.createElement(r.a.Fragment,null),r.a.createElement("div",{style:{float:"right"}},r.a.createElement("label",null,"Lazy:"),r.a.createElement("input",{type:"number",min:"0",max:"100",style:{width:"30px"},value:se.lazyRadius,onChange:function(e){return me(function(t){return Object(p.a)({},t,{lazyRadius:e.target.value})})}})),r.a.createElement("div",{style:{float:"right"}},"erase"==ve?r.a.createElement(r.a.Fragment,null,r.a.createElement("label",null,"Erase Size:"),r.a.createElement("input",{type:"number",min:"1",max:"100",style:{width:"30px"},value:se.eraseRadius,onChange:function(e){return me(function(t){return Object(p.a)({},t,{eraseRadius:e.target.value})})}})):r.a.createElement(r.a.Fragment,null,r.a.createElement("label",null,"Brush Size:"),r.a.createElement("input",{type:"number",min:"1",max:"100",style:{width:"30px"},value:se.brushRadius,onChange:function(e){return me(function(t){return Object(p.a)({},t,{brushRadius:e.target.value})})}}))),r.a.createElement("div",{style:{float:"left"}},a?r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{style:{padding:"15px"},onClick:Qe},"\u25c0")):r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:Qe},"\u25c0"))),r.a.createElement("div",{style:{float:"left"}},"erase"==ve?r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:et},"brush")):r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:$e},"erase"))),r.a.createElement("div",{style:{float:"left"}},"shadow"==ve?r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:et},"brush")):r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:tt},"shadow")),ve)),r.a.createElement("div",{style:{float:"right"}},r.a.createElement(Q,{canvasWidth:600,canvasHeight:600,brushRadius:"erase"==ve?se.eraseRadius:se.brushRadius,lazyRadius:se.lazyRadius,ref:k,brushColor:ve,allowOnlyPointerType:["all","mouse","touch","pen"][J]}))),ge&&r.a.createElement(r.a.Fragment,null," ",r.a.createElement("form",{onSubmit:lt},r.a.createElement("input",{type:"file",accept:"image/*",onChange:function(e){var t=e.target.files;t[0];je(t),console.log(t)},multiple:!0}),r.a.createElement("input",{type:"submit",value:"Upload Croquis Images"})))))},gt=a(97),pt=a.n(gt),ht=function(e){var t=e.userObj,a=e.isAndroid,l=(e.penType,Object(n.useState)("")),o=Object(c.a)(l,2),u=(o[0],o[1]),s=Object(n.useState)(0),f=Object(c.a)(s,2),g=f[0],h=f[1],E=Object(n.useRef)(),y=Object(n.useState)({brushRadius:1,lazyRadius:0}),w=Object(c.a)(y,2),O=w[0],j=w[1],S=Object(n.useState)([]),x=Object(c.a)(S,2),C=(x[0],x[1],Object(n.useState)([])),k=Object(c.a)(C,2),R=(k[0],k[1],Object(n.useState)(!1)),D=Object(c.a)(R,2),I=D[0],F=D[1],T=Object(n.useState)(0),P=Object(c.a)(T,2),z=(P[0],P[1]),U=Object(n.useState)([]),L=Object(c.a)(U,2),B=(L[0],L[1],Object(n.useState)(3)),A=Object(c.a)(B,2),M=A[0],N=A[1],q=Object(n.useState)("#444"),V=Object(c.a)(q,2),_=V[0],W=V[1],H=Object(n.useState)(!1),X=Object(c.a)(H,2),Y=X[0],J=X[1],G=Object(n.useState)(!1),Z=Object(c.a)(G,2),K=Z[0],$=Z[1],ee=Object(n.useState)(!1),te=Object(c.a)(ee,2),ae=te[0],ne=te[1],re=Object(n.useState)(0),le=Object(c.a)(re,2),ce=le[0],ie=le[1],ue=Object(n.useState)(0),se=Object(c.a)(ue,2),me=se[0],de=se[1],fe=Object(n.useState)(300),ge=Object(c.a)(fe,2),pe=ge[0],he=ge[1],be=Object(n.useRef)(pe),ve=Object(n.useRef)(null),Ee=Object(n.useState)([]),ye=Object(c.a)(Ee,2),we=ye[0],Oe=ye[1],je=Object(n.useState)([]),Se=Object(c.a)(je,2),xe=Se[0],Ce=Se[1],ke=Object(n.useState)("dragonball1"),Re=Object(c.a)(ke,2),De=Re[0],Ie=Re[1],Fe=Object(n.useState)(""),Te=Object(c.a)(Fe,2),Pe=(Te[0],Te[1],Object(n.useState)([""])),ze=Object(c.a)(Pe,2),Ue=ze[0],Le=ze[1],Be=Object(n.useState)(0),Ae=Object(c.a)(Be,2),Me=Ae[0],qe=Ae[1],Ve=Object(n.useState)([]),_e=Object(c.a)(Ve,2),We=_e[0],He=_e[1],Xe=Object(n.useState)(!1),Ye=Object(c.a)(Xe,2),Ge=Ye[0],Ze=Ye[1],Ke=Object(n.useState)(!1),Qe=Object(c.a)(Ke,2),$e=Qe[0],et=Qe[1],tt=Object(n.useState)(0),at=Object(c.a)(tt,2),nt=at[0],rt=at[1],lt=Object(n.useState)(!1),ot=Object(c.a)(lt,2),ct=ot[0],it=ot[1],ut=Object(n.useState)(1),st=Object(c.a)(ut,2),mt=st[0];st[1];Object(n.useEffect)(function(){return null!=localStorage.getItem(2)&&he(JSON.parse(localStorage.getItem(2))),void 0==localStorage.getItem("mangarepeat")?localStorage.setItem("mangarepeat",!1):et(JSON.parse(localStorage.getItem("mangarepeat"))),void 0==localStorage.getItem("mangasoche")?localStorage.setItem("mangasoche",!1):F(JSON.parse(localStorage.getItem("mangasoche"))),N(parseInt(localStorage.getItem("penType"))),ve.current=setInterval(function(){ie(parseInt(be.current/60)),de(be.current%60),be.current-=1},1e3),function(){return clearInterval(ve.current)}},[]),Object(n.useEffect)(function(){be.current<=-1&&Y&&(gt(),dt())},[me]);var dt=function(){z(Math.floor(690*Math.random())+1)};Object(n.useEffect)(function(){var e=[],a=[];m.doc("RefDB/manga").get().then(function(t){if(t.exists){var n=t.data();Object.keys(n).forEach(function(t){console.log(t),a.push({list:t,page:0}),e.push({list:t,url:n[t]})})}else console.log("ref1 No such document!")}).catch(function(e){console.log("ref1 Error getting document:",e)}).then(function(t){e.sort(function(e,t){return e.list.localeCompare(t.list)}),a.push({list:"lastpage",page:""}),Ce(a),Oe(e);var n=Object.values(e[4].url);Le(n)}).then(function(a){m.doc("usersetting/"+t.uid).get().then(function(t){if(t.exists){j({brushRadius:t.data().brushRadius,lazyRadius:t.data().lazyRadius,sotyIndex:t.data().sotyIndex}),z(t.data().sotyIndex),t.data().page.length>0&&Ce(t.data().page),console.log("PAGE",t.data().page),console.log(t.data());var a="";t.data().page.forEach(function(e){"lastpage"===e.list&&(a=e.page)}),t.data().page.forEach(function(e){e.list===a&&qe(parseInt(e.page))});for(var n=0;n<e.length;n++)if(e[n].list==a){var r=Object.values(e[n].url);Le(r)}Ie(a)}else console.log("No such setting document!")}).catch(function(e){console.log("Error getting document:",e)})})},[]);var ft,gt=function(){Y&&(be.current=pe);var e=xe;e.forEach(function(e){e.list===De&&(e.page=Me),"lastpage"===e.list&&(e.page=De)}),console.log(xe),m.collection("usersetting").doc(t.uid).update({page:e});var a=E.current.getSaveData(),n=E.current.getDataURL();E.current.clear(),m.collection("Csubmit").add({text:a,createdAt:Date.now(),creatorId:t.uid,drawingTime:0,heart:0,dataUrl:n,refPinUrl:Ue[Me]}),u(""),Y&&dt()},ht=function(){E.current.undo()},bt=function(){W("erase")},vt=function(){W("#444")},Et=function(){W("shadow")},yt=function(){var e=Object(v.a)(b.a.mark(function e(t){return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),Ot(De,We),He([]);case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),wt=function(){var e=Object(v.a)(b.a.mark(function e(t,a){var n;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==a){e.next=2;break}return e.abrupt("return","");case 2:return e.prev=2,e.next=5,d.ref("/".concat(t,"/").concat(a.name)).put(a);case 5:return n=e.sent,e.abrupt("return",n.ref.getDownloadURL().then(function(e){return e}));case 9:e.prev=9,e.t0=e.catch(2),console.log(e.t0);case 12:case"end":return e.stop()}},e,null,[[2,9]])}));return function(t,a){return e.apply(this,arguments)}}(),Ot=function(){var e=Object(v.a)(b.a.mark(function e(t,a){var n,r,l,o,c,u,s,d;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==a.length){e.next=2;break}return e.abrupt("return",[]);case 2:n=m.doc("RefDB/manga"),r=0;case 4:if(!(r<a.length)){e.next=18;break}return l=a[r],e.next=8,wt(t,l);case 8:o=e.sent,u=(c=o).indexOf("pot.com/o/"),s=c.indexOf("&token="),d=c.slice(u,s),n.update(Object(Je.a)({},t,i.a.firestore.FieldValue.arrayUnion(d))),console.log("complete : ",r+1,"/",a.length," ",o);case 15:r++,e.next=4;break;case 18:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,r.a.createElement(oe.a,{keyName:"ctrl+z,c,x,a,s",onKeyDown:function(e,t,a){"ctrl+z"==e&&ht(),"c"==e&&("erase"!=_?bt():"erase"==_&&vt()),"x"==e&&("shadow"!=_?Et():"shadow"==_&&vt()),"a"==e&&Me>0&&qe(function(e){return e-1}),"s"==e&&Me<Ue.length-1&&qe(function(e){return e+1})}}),r.a.createElement("div",null,Y?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{position:"absolute",left:"50%",transform:"translateX(-50%)",width:"70px",textAlign:"center",background:"linear-gradient(to left,#FFC365 "+100*(60*ce+me)/pe+"%,#E8E8E8 "+100*(60*ce+me)/pe+"%)"}},ce,": ",(ft=me)<=9?"0"+ft:ft)):r.a.createElement(r.a.Fragment,null),r.a.createElement("div",{style:{float:"right"}}),r.a.createElement("div",null,r.a.createElement("select",{defaultValue:-1,onChange:function(e){qe(0),Ie(we[e.target.value].list),localStorage.setItem("mangdraw",e.target.value),xe.forEach(function(t){t.list===we[e.target.value].list&&(console.log(t.list,"\ud398\uc774\uc9c0",t.page),qe(parseInt(t.page)))});var t=Object.values(we[e.target.value].url).sort(function(e,t){return e.localeCompare(t)});Le(t)}},we.map(function(e,t){return r.a.createElement("option",{selected:localStorage.getItem("mangdraw")?t===parseInt(localStorage.getItem("mangdraw")):0===t,key:e.list,value:t},e.list)})),r.a.createElement("label",null,"pages:"),r.a.createElement("input",{type:"number",min:"0",max:Ue.length-1,style:{width:"40px"},value:Me,onChange:function(e){qe(parseInt(e.target.value)),h(g+1)}}),r.a.createElement("button",{onClick:function(e){e.preventDefault(),Me>0&&qe(function(e){return e-1})}},"<"),r.a.createElement("button",{onClick:function(e){e.preventDefault(),Me<Ue.length-1&&qe(function(e){return e+1})}},">"),r.a.createElement("button",{onClick:function(e){J(function(e){return!e}),be.current=pe}},"random ",Y?r.a.createElement(r.a.Fragment,null,"on"):r.a.createElement(r.a.Fragment,null,"off")),r.a.createElement("button",{onClick:function(e){$(function(e){return!e})}},"Extend"),r.a.createElement("button",{onClick:function(e){ne(function(e){return!e})}},"Drawing Only"),r.a.createElement("button",{onClick:function(e){e.preventDefault();var a=xe;a.forEach(function(e){e.list===De&&(e.page=Me),"lastpage"===e.list&&(e.page=De)}),console.log(xe),m.collection("usersetting").doc(t.uid).update({page:a})}},"save page"),r.a.createElement("button",{onClick:function(e){e.preventDefault(),0==$e?localStorage.setItem("mangarepeat",!0):localStorage.setItem("mangarepeat",!1),et(function(e){return!e})}},"\ud83d\udd02",1==$e&&r.a.createElement(r.a.Fragment,null,"\u2764")),r.a.createElement("button",{onClick:function(e){it(function(e){return!e})}},"\ud83d\udc41\ufe0f"),r.a.createElement("button",{onClick:function(e){F(function(e){return!e}),0==I?localStorage.setItem("mangasoche",!0):localStorage.setItem("mangasoche",!1)}},"soche"),r.a.createElement("div",{style:{float:"right"}},Y?r.a.createElement(r.a.Fragment,null,r.a.createElement("input",{value:pe,onChange:function(e){var t=e.target.value;he(t),localStorage.setItem(2,t)},type:"number",placeholder:"Time"}),"Set Time"):r.a.createElement(r.a.Fragment,null))),r.a.createElement("div",{style:{float:"left",opacity:ct?"0":"1"}},a?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{width:"600px",height:"450px"}},r.a.createElement(Ne,null,r.a.createElement("img",{alt:"Test Image",src:Ue[Me]&&Ue[Me].includes("pot.com/o/")?Ue[Me].replace("pot.com/o/","https://firebasestorage.googleapis.com/v0/b/croquistool.appspot.com/o/"):""})))):r.a.createElement(r.a.Fragment,null,ae?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{width:"1px",height:"770px"}},r.a.createElement(Ne,null,r.a.createElement("img",{alt:"Test Image",src:Ue[Me]&&Ue[Me].includes("pot.com/o/")?Ue[Me].replace("pot.com/o/","https://firebasestorage.googleapis.com/v0/b/croquistool.appspot.com/o/"):""})))):r.a.createElement(r.a.Fragment,null,K?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{width:"850px",height:"770px"}},r.a.createElement(Ne,null,r.a.createElement("img",{alt:"Test Image",src:Ue[Me]&&Ue[Me].includes("pot.com/o/")?Ue[Me].replace("pot.com/o/","https://firebasestorage.googleapis.com/v0/b/croquistool.appspot.com/o/"):""})))):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{width:"450px",height:"770px"}},r.a.createElement(Ne,null,r.a.createElement("img",{alt:"Test Image",src:Ue[Me]&&Ue[Me].includes("pot.com/o/")?Ue[Me].replace("pot.com/o/","https://firebasestorage.googleapis.com/v0/b/croquistool.appspot.com/o/"):""}))))))),r.a.createElement("div",{style:{float:"left"}},r.a.createElement("div",null,r.a.createElement("div",{style:{float:"right"}},r.a.createElement("label",null,"Lazy:"),r.a.createElement("input",{type:"number",min:"0",max:"100",style:{width:"30px"},value:O.lazyRadius,onChange:function(e){return j(function(t){return Object(p.a)({},t,{lazyRadius:e.target.value})})}})),r.a.createElement("div",{style:{float:"right"}},"erase"==_?r.a.createElement(r.a.Fragment,null,r.a.createElement("label",null,"Erase Size:"),r.a.createElement("input",{type:"number",min:"1",max:"100",style:{width:"30px"},value:O.eraseRadius,onChange:function(e){return j(function(t){return Object(p.a)({},t,{eraseRadius:e.target.value})})}})):r.a.createElement(r.a.Fragment,null,r.a.createElement("label",null,"Brush Size:"),r.a.createElement("input",{type:"number",min:"1",max:"100",style:{width:"30px"},value:O.brushRadius,onChange:function(e){return j(function(t){return Object(p.a)({},t,{brushRadius:e.target.value})})}}))),r.a.createElement("div",{style:{float:"right"}},r.a.createElement("button",{onClick:function(){window.confirm("wanna clear this?")&&E.current.clear()}},"Clear Canvas")),r.a.createElement("div",{style:{float:"right"}},a?r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{style:{padding:"15px"},onClick:ht},"\u25c0")):r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:ht},"\u25c0"))),r.a.createElement("div",{style:{float:"right"}},"erase"==_?r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:vt},"brush")):r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:bt},"erase")),r.a.createElement("div",{style:{float:"right"}},"shadow"==_?r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:vt},"brush")):r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:Et},"shadow")),_)),r.a.createElement("div",{style:{float:"right"}},r.a.createElement("button",{onClick:function(e){e.preventDefault(),0==nt&&1==$e?(gt(),rt(function(e){return e+1}),it(!0)):nt==mt&&1==$e?(gt(),rt(0),it(!1),qe(function(e){return e+1})):gt()}},"Upload Drawing"))),r.a.createElement("div",{style:{float:"right"}},r.a.createElement(Q,{imgSrc:1==I?pt.a:"",enablePanAndZoom:!0,canvasWidth:ae?1e3:600,canvasHeight:600,brushRadius:"erase"==_?O.eraseRadius:O.brushRadius,lazyRadius:O.lazyRadius,ref:E,brushColor:_,allowOnlyPointerType:["all","mouse","touch","pen"][M]}))),r.a.createElement("button",{onClick:function(e){Ze(function(e){return!e})}},"Up"),Ge&&r.a.createElement(r.a.Fragment,null," ",r.a.createElement("form",{onSubmit:yt},r.a.createElement("input",{type:"file",accept:"image/*",onChange:function(e){var t=e.target.files;t[0];He(t),console.log(t)},multiple:!0}),r.a.createElement("input",{type:"submit",value:"Upload Croquis Images"})))))},bt=function(e){var t=e.userObj,a=e.isAndroid,l=(e.penType,Object(n.useState)("")),o=Object(c.a)(l,2),u=(o[0],o[1]),s=Object(n.useState)([]),f=Object(c.a)(s,2),g=(f[0],f[1],Object(n.useState)([])),h=Object(c.a)(g,2),E=(h[0],h[1],Object(n.useState)([])),y=Object(c.a)(E,2),w=y[0],O=y[1],j=Object(n.useState)([]),S=Object(c.a)(j,2),x=S[0],C=S[1],k=Object(n.useState)([""]),R=Object(c.a)(k,2),D=R[0],I=R[1],F=Object(n.useState)(!1),T=Object(c.a)(F,2),P=T[0],z=T[1],U=Object(n.useState)(""),L=Object(c.a)(U,2),B=L[0],A=L[1],M=Object(n.useRef)(),N=Object(n.useState)(""),q=Object(c.a)(N,2),V=q[0],_=q[1],W=Object(n.useState)([""]),H=Object(c.a)(W,2),X=H[0],Y=H[1],J=Object(n.useState)(0),G=Object(c.a)(J,2),Z=G[0],K=G[1],$=Object(n.useState)(0),ee=Object(c.a)($,2),te=ee[0],ae=ee[1],ne=Object(n.useState)(0),re=Object(c.a)(ne,2),le=re[0],ce=re[1],ie=Object(n.useState)(!0),ue=Object(c.a)(ie,2),se=(ue[0],ue[1],Object(n.useState)("")),me=Object(c.a)(se,2),de=me[0],fe=me[1],ge=Object(n.useState)(60),pe=Object(c.a)(ge,2),he=pe[0],be=pe[1],ve=["all","mouse","touch","pen"],Ee=Object(n.useState)(3),ye=Object(c.a)(Ee,2),we=ye[0],Oe=ye[1],je=Object(n.useState)(0),Se=Object(c.a)(je,2),xe=Se[0],Ce=Se[1],ke=Object(n.useState)(0),Re=Object(c.a)(ke,2),De=Re[0],Ie=Re[1],Fe=Object(n.useRef)(he),Te=Object(n.useRef)(null),Pe=Object(n.useState)({croquisTimeDB:60,brushRadius:1,lazyRadius:1,eraseRadius:10}),ze=Object(c.a)(Pe,2),Ue=ze[0],Le=ze[1],Be=Object(n.useState)(!1),Ae=Object(c.a)(Be,2),Me=Ae[0],Ne=Ae[1],qe=Object(n.useState)("#444"),Ve=Object(c.a)(qe,2),_e=Ve[0],We=Ve[1],He=Object(n.useState)([]),Xe=Object(c.a)(He,2),Ye=Xe[0],Ge=Xe[1],Ze=Object(n.useState)(400),Ke=Object(c.a)(Ze,2),Qe=Ke[0],$e=Ke[1];var et=function(e){m.collection("usersetting").doc(t.uid).update({brushRadius:Ue.brushRadius,lazyRadius:Ue.lazyRadius,croquisTimeDB:Ue.croquisTimeDB,eraseRadius:Ue.eraseRadius})},tt=function(){K(Z+1);var e=0;void 0==localStorage.getItem("drawNum")?localStorage.setItem("drawNum",parseInt(0)):e=localStorage.getItem("drawNum"),localStorage.setItem("drawNum",parseInt(e)+1),ce(parseInt(e)+1),localStorage.setItem("lastdrawtime",parseInt(Date.now())),ae(te+1),Fe.current=he;var a=M.current.getSaveData(),n=M.current.getDataURL();if(M.current.clear(),"concept-2"==B){var r=X[te];fetch(n).then(function(e){return e.blob()}).then(function(e){var t=new Blob([e],{type:e.type,name:r});console.log("File renamed",r);var a=d.ref("conceptRef/"+r);a.put(t).then(function(){console.log("File reuploaded !","conceptRef","/",r)}).then(function(){var e=m.doc("concept/ref");a.getDownloadURL().then(function(t){var a=t.indexOf("pot.com/o/"),n=t.indexOf("?alt="),l=t.substring(a,n+4);e.update(Object(Je.a)({},B,i.a.firestore.FieldValue.arrayUnion(r+l)))})})})}m.collection("Csubmit").add({text:a,createdAt:Date.now(),creatorId:t.uid,drawingTime:he-60*xe-De,heart:0,dataUrl:n,refPinUrl:X[te]}),u("")};function at(e){for(var t=e.length-1;t>0;t--){var a=Math.floor(Math.random()*(t+1)),n=[e[a],e[t]];e[t]=n[0],e[a]=n[1]}return e}Object(n.useEffect)(function(){return void 0==localStorage.getItem("drawNum")?(localStorage.setItem("drawNum",parseInt(0)),ce(parseInt(0))):ce(parseInt(localStorage.getItem("drawNum"))),void 0!=localStorage.getItem("lastdrawtime")&&parseInt(Date.now())-parseInt(localStorage.getItem("lastdrawtime"))>216e5&&(localStorage.setItem("drawNum",parseInt(0)),ce(parseInt(0))),m.doc("usersetting/"+t.uid).get().then(function(e){e.exists?(Le({brushRadius:e.data().brushRadius,lazyRadius:e.data().lazyRadius,eraseRadius:e.data().eraseRadius,croquisTimeDB:e.data().croquisTimeDB}),be(e.data().croquisTimeDB),console.log(e.data()),Fe.current+=e.data().croquisTimeDB-60):console.log("No such setting document!")}).catch(function(e){console.log("Error getting document:",e)}),Oe(parseInt(localStorage.getItem("penType"))),Te.current=setInterval(function(){Ce(parseInt(Fe.current/60)),Ie(Fe.current%60),Fe.current-=1},1e3),function(){return clearInterval(Te.current)}},[]),Object(n.useEffect)(function(){Fe.current<=-1&&tt()},[De]),Object(n.useEffect)(function(){var e=[];m.doc("RefDB/refStrings").get().then(function(t){if(t.exists){var a=t.data();Object.keys(a).forEach(function(t){console.log(t),e.push({list:t,url:a[t]})})}else console.log("ref1 No such document!")}).catch(function(e){console.log("ref1 Error getting document:",e)}).then(function(t){m.doc("RefDB/refStrings2").get().then(function(t){if(t.exists){var a=t.data();Object.keys(a).forEach(function(t){console.log(t),e.push({list:t+"-2",url:a[t]})}),e.sort(function(e,t){return e.list.localeCompare(t.list)}),O(e);var n=at(e.flatMap(function(e){return e.url}));if(C(n),void 0==localStorage.getItem("specdraw2")){var r=at(Object.values(e[0].url));console.log("\uac12\uc740\ubc14\ub85c",e[0].list),A(e[0].list),Y(r),I(r)}else{var l=at(Object.values(e[parseInt(localStorage.getItem("specdraw2"))].url));console.log("\uac12\uc740\ubc14\ub85c",e[parseInt(localStorage.getItem("specdraw2"))].list),A(e[parseInt(localStorage.getItem("specdraw2"))].list),Y(l),I(l)}}else console.log("ref2 No such document!")}).catch(function(e){console.log("ref2  Error getting document:",e)})})},[]);var nt=function(e){e.preventDefault(),tt(),fe("")},rt=function(e){var t=e.target.value;be(t),Le(function(t){return Object(p.a)({},t,{croquisTimeDB:e.target.value})})},lt=function(e){e.preventDefault(),Ne(!1),console.log("\ud604\uc7ac\uac12\uc740",B)},ot=function(){var e=0;void 0==localStorage.getItem("drawNum")?localStorage.setItem("drawNum",parseInt(0)):e=localStorage.getItem("drawNum"),localStorage.setItem("drawNum",parseInt(e)+1),ce(parseInt(e)+1),localStorage.setItem("lastdrawtime",parseInt(Date.now())),Fe.current=he;var a=M.current.getSaveData(),n=M.current.getDataURL();M.current.clear(),m.collection("Csubmit").add({text:a,createdAt:Date.now(),creatorId:t.uid,drawingTime:he-60*xe-De,heart:0,dataUrl:n,refPinUrl:X[te]}),u("")},ct=function(e){e.preventDefault(),ot(),fe("")},it=function(e){e.preventDefault(),function(e,t){var a=new Image;a.onload=function(){var e=document.createElement("canvas");e.width=a.width,e.height=a.height;var n=e.getContext("2d");n.drawImage(a,0,0);for(var r=n.getImageData(0,0,e.width,e.height),l=r.data,o=0;o<l.length;o+=4)l[o+3]=Math.floor(.2*l[o+3]);n.putImageData(r,0,0);var c=e.toDataURL("image/png");t(c)},a.src=e}(M.current.getDataURL(),function(e){fe(e)}),ot(),M.current.clear()},ut=function(e){e.preventDefault(),K(Z+1),ae(te+1),Fe.current=he},st=function(){B.includes("-2")?m.doc("RefDB/refStrings2").update(Object(Je.a)({},B.slice(0,-2),i.a.firestore.FieldValue.arrayRemove(X[te]))):m.doc("RefDB/refStrings").update(Object(Je.a)({},B,i.a.firestore.FieldValue.arrayRemove(X[te])));K(Z+1),ae(te+1)},mt=function(){window.confirm("wanna clear this?")&&(M.current.clear(),fe(""))},dt=function(){M.current.undo()},ft=function(){We("erase")},gt=function(){We("#444")},pt=function(){We("shadow")};function ht(e){var t=e%10,a=e%100;return 1==t&&11!=a?e+"st":2==t&&12!=a?e+"nd":3==t&&13!=a?e+"rd":e+"th"}function bt(e){return e<=9?"0"+e:e}var vt=function(e){A(w[e.target.value].list),localStorage.setItem("specdraw2",parseInt(e.target.value));var t=at(Object.values(w[e.target.value].url));Y(t),I(t)},Et=function(e){0==P?(Y(x),console.log("rand on",x.length),z(!0)):(Y(D),console.log("rand off",D.length),z(!1))},yt=function(){var e=Object(v.a)(b.a.mark(function e(t){return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),Ot(B,Ye),Ge([]);case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),wt=function(){var e=Object(v.a)(b.a.mark(function e(t,a){var n;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==a){e.next=2;break}return e.abrupt("return","");case 2:return e.prev=2,e.next=5,d.ref("/".concat(t,"/").concat(a.name)).put(a);case 5:return n=e.sent,e.abrupt("return",n.ref.getDownloadURL().then(function(e){return e}));case 9:e.prev=9,e.t0=e.catch(2),console.log(e.t0);case 12:case"end":return e.stop()}},e,null,[[2,9]])}));return function(t,a){return e.apply(this,arguments)}}(),Ot=function(){var e=Object(v.a)(b.a.mark(function e(t,a){var n,r,l,o,c,u,s,d,f,g,p,h,v,E,y;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==a.length){e.next=2;break}return e.abrupt("return",[]);case 2:if(!t.includes("-2")){e.next=21;break}n=m.doc("RefDB/refStrings2"),r=0;case 5:if(!(r<a.length)){e.next=19;break}return l=a[r],e.next=9,wt(t,l);case 9:o=e.sent,u=(c=o).indexOf("pot.com/o/"),s=c.indexOf("&token="),d=c.slice(u,s),n.update(Object(Je.a)({},t.slice(0,-2),i.a.firestore.FieldValue.arrayUnion(d))),console.log("complete : ",r+1,"/",a.length," ",o);case 16:r++,e.next=5;break;case 19:e.next=37;break;case 21:f=m.doc("RefDB/refStrings"),r=0;case 23:if(!(r<a.length)){e.next=37;break}return g=a[r],e.next=27,wt(t,g);case 27:p=e.sent,v=(h=p).indexOf("pot.com/o/"),E=h.indexOf("&token="),y=h.slice(v,E),f.update(Object(Je.a)({},t,i.a.firestore.FieldValue.arrayUnion(y))),console.log("complete : ",r+1,"/",a.length," ",p);case 34:r++,e.next=23;break;case 37:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,r.a.createElement(oe.a,{keyName:"ctrl+z,c,x",onKeyDown:function(e,t,a){"ctrl+z"==e&&dt(),"c"==e&&("erase"!=_e?ft():"erase"==_e&&gt()),"x"==e&&("shadow"!=_e?pt():"shadow"==_e&&gt())}}),r.a.createElement("div",null,a?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{float:"right"}},r.a.createElement("button",{onClick:Et},P?"off":"ran"),Me?r.a.createElement(r.a.Fragment,null,r.a.createElement("form",{onSubmit:lt},r.a.createElement("input",{value:he,onChange:rt,type:"number",placeholder:"Input Croquis Time"}),r.a.createElement("input",{type:"submit",value:"Set Time"})),r.a.createElement("button",{onClick:st},"Delete Pin"),r.a.createElement("button",{onClick:function(e){0==we?(Oe(3),localStorage.setItem("penType",parseInt(3))):3==we&&(Oe(0),localStorage.setItem("penType",parseInt(0)))}},ve[we])):r.a.createElement(r.a.Fragment,null,ht(le+1),r.a.createElement("button",{onClick:function(e){Ne(!0)}},"Set Time")),Me&&r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:et},"Setting")))):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{width:"1000px"}},r.a.createElement("div",{style:{float:"right"}},Me?r.a.createElement(r.a.Fragment,null,r.a.createElement("form",{onSubmit:lt},r.a.createElement("input",{value:he,onChange:rt,type:"number",placeholder:"Input Croquis Time"}),r.a.createElement("input",{type:"submit",value:"Set Time"})),r.a.createElement("button",{onClick:st},"Delete Pin"),r.a.createElement("button",{onClick:function(e){0==we?(Oe(3),localStorage.setItem("penType",parseInt(3))):3==we&&(Oe(0),localStorage.setItem("penType",parseInt(0)))}},ve[we])):r.a.createElement(r.a.Fragment,null,ht(le+1),r.a.createElement("button",{onClick:function(e){Ne(!0)}},"Set Time")),Me&&r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:et},"Setting"))))),a?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,r.a.createElement("select",{defaultValue:-1,onChange:vt},w.map(function(e,t){return r.a.createElement("option",{key:e.list,value:t,selected:localStorage.getItem("specdraw2")?t===parseInt(localStorage.getItem("specdraw2")):0===t},e.list)}))),r.a.createElement("div",{style:{float:"left"}},"string"==typeof X[te]&&X[te].startsWith("pot.com/o/")?r.a.createElement(r.a.Fragment,null,r.a.createElement("img",{key:Z,src:X[te].replace("pot.com/o/","https://firebasestorage.googleapis.com/v0/b/croquistool.appspot.com/o/"),height:450,frameBorder:0,scrolling:"no"})):r.a.createElement(r.a.Fragment,null,"string"==typeof X[te]&&X[te].includes("firebasestorage.googleapis.com")?r.a.createElement(r.a.Fragment,null,r.a.createElement("img",{key:Z,src:X[te],height:450,frameBorder:0,scrolling:"no"})):r.a.createElement(r.a.Fragment,null,r.a.createElement("iframe",{key:Z,src:"https://assets.pinterest.com/ext/embed.html?id="+X[te],height:450,frameBorder:0,scrolling:"no"}))))):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{float:"right"}},r.a.createElement("button",{onClick:mt},"Clear Canvas")),r.a.createElement("div",{style:{float:"right"}},r.a.createElement("button",{onClick:ct},"Up&Re")),r.a.createElement("div",{style:{float:"right"}},r.a.createElement("button",{onClick:it},"Review")),r.a.createElement("div",{style:{float:"right"}},r.a.createElement("button",{onClick:nt},"Upload")),r.a.createElement("div",{style:{float:"right"}},r.a.createElement("button",{onClick:ut},"Next")),r.a.createElement("div",{style:{float:"left"}},r.a.createElement("button",{onClick:function(e){400==Qe?$e(600):600==Qe&&$e(400)}},"ex"),r.a.createElement("button",{onClick:Et},P?"off":"ran")),r.a.createElement("div",{style:{position:"absolute",left:"30%",transform:"translateX(-50%)",width:"70px",textAlign:"center",background:"linear-gradient(to left,#FFC365 "+100*(60*xe+De)/he+"%,#E8E8E8 "+100*(60*xe+De)/he+"%)"}},xe,": ",bt(De)),r.a.createElement("div",null,r.a.createElement("form",{onSubmit:function(e){if(e.preventDefault(),B.includes("-2"))if(V.match(",")){var t=m.doc("RefDB/refStrings2");V.split(",").forEach(function(e){t.update(Object(Je.a)({},B.slice(0,-2),i.a.firestore.FieldValue.arrayUnion(e)))})}else V.length>1&&m.doc("RefDB/refStrings2").update(Object(Je.a)({},B.slice(0,-2),i.a.firestore.FieldValue.arrayUnion(V)));else if(V.match(",")){var a=m.doc("RefDB/refStrings");V.split(",").forEach(function(e){a.update(Object(Je.a)({},B,i.a.firestore.FieldValue.arrayUnion(e)))})}else V.length>1&&m.doc("RefDB/refStrings").update(Object(Je.a)({},B,i.a.firestore.FieldValue.arrayUnion(V)));_("")}},r.a.createElement("select",{defaultValue:2,onChange:vt},w.map(function(e,t){return r.a.createElement("option",{key:e.list,value:t,selected:localStorage.getItem("specdraw2")?t===parseInt(localStorage.getItem("specdraw2")):0===t},e.list)})),r.a.createElement("input",{value:V,onChange:function(e){var t=e.target.value;_(t)},type:"text",placeholder:"You Can Upload Pinterst Pin By Url Number"}),r.a.createElement("input",{type:"submit",value:"Upload Pin"}))),r.a.createElement("div",{style:{float:"left"}},"string"==typeof X[te]&&X[te].startsWith("pot.com/o/")?r.a.createElement(r.a.Fragment,null,r.a.createElement("img",{key:Z,src:X[te].replace("pot.com/o/","https://firebasestorage.googleapis.com/v0/b/croquistool.appspot.com/o/"),width:Qe,frameBorder:0,scrolling:"no"})):r.a.createElement(r.a.Fragment,null,"string"==typeof X[te]&&X[te].includes("firebasestorage.googleapis.com")?r.a.createElement(r.a.Fragment,null,r.a.createElement("img",{key:Z,src:X[te],width:Qe,frameBorder:0,scrolling:"no"})):r.a.createElement(r.a.Fragment,null,r.a.createElement("iframe",{key:Z,src:"https://assets.pinterest.com/ext/embed.html?id="+X[te],height:Qe+370,width:Qe,frameBorder:0,scrolling:"no"}))))),r.a.createElement("div",{style:{float:"left"}},r.a.createElement("div",null,a?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{float:"right"}},r.a.createElement("button",{onClick:mt},"Clear")),r.a.createElement("div",{style:{float:"right"}},r.a.createElement("button",{onClick:ct},"UpRe"),r.a.createElement("button",{onClick:it},"Rev")),r.a.createElement("div",{style:{float:"right"}},r.a.createElement("button",{onClick:nt},"Up")),r.a.createElement("div",{style:{float:"right"}},r.a.createElement("button",{onClick:ut},"Next")),r.a.createElement("div",{style:{float:"right"}},xe,": ",bt(De))):r.a.createElement(r.a.Fragment,null),r.a.createElement("div",{style:{float:"right"}},r.a.createElement("label",null,"Lazy:"),r.a.createElement("input",{type:"number",min:"0",max:"100",style:{width:"30px"},value:Ue.lazyRadius,onChange:function(e){return Le(function(t){return Object(p.a)({},t,{lazyRadius:e.target.value})})}})),r.a.createElement("div",{style:{float:"right"}},"erase"==_e?r.a.createElement(r.a.Fragment,null,r.a.createElement("label",null,"Er:"),r.a.createElement("input",{type:"number",min:"1",max:"100",style:{width:"30px"},value:Ue.eraseRadius,onChange:function(e){return Le(function(t){return Object(p.a)({},t,{eraseRadius:e.target.value})})}})):r.a.createElement(r.a.Fragment,null,r.a.createElement("label",null,"Br:"),r.a.createElement("input",{type:"number",min:"1",max:"100",style:{width:"30px"},value:Ue.brushRadius,onChange:function(e){return Le(function(t){return Object(p.a)({},t,{brushRadius:e.target.value})})}}))),r.a.createElement("div",{style:{float:"left"}},a?r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{style:{paddingLeft:"15px"},onClick:dt},"\u25c0")):r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:dt},"\u25c0"))),r.a.createElement("div",{style:{float:"left"}},"erase"==_e?r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:gt},"brush")):r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:ft},"erase"))),r.a.createElement("div",{style:{float:"left"}},"shadow"==_e?r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:gt},"brush")):r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:pt},"shadow")),_e)),r.a.createElement("div",{style:{float:"right"}},r.a.createElement(Q,{canvasWidth:600,canvasHeight:600,brushRadius:"erase"==_e?Ue.eraseRadius:Ue.brushRadius,lazyRadius:Ue.lazyRadius,ref:M,brushColor:_e,imgSrc:de,allowOnlyPointerType:ve[we]}))),Me&&r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:function(e){var t=at(X);Y(t)}},"random!")),Me&&r.a.createElement(r.a.Fragment,null," ",r.a.createElement("form",{onSubmit:yt},r.a.createElement("input",{type:"file",accept:"image/*",onChange:function(e){var t=e.target.files;t[0];Ge(t),console.log(t)},multiple:!0}),r.a.createElement("input",{type:"submit",value:"Upload Croquis Images"})))))},vt=function(e){var t=e.isLoggedIn,a=e.userObj,n=e.isAndroid;return r.a.createElement(g.a,null,t&&r.a.createElement(ie,{isAndroid:n}),r.a.createElement(f.d,null,t?r.a.createElement(r.a.Fragment,null,r.a.createElement(f.b,{exact:!0,path:"/"},r.a.createElement(ce,{userObj:a,isAndroid:n})),r.a.createElement(f.b,{exact:!0,path:"/profile"},r.a.createElement(re,{userObj:a,isAndroid:n})),r.a.createElement(f.b,{exact:!0,path:"/doProko"},r.a.createElement(ue,{userObj:a,isAndroid:n})),r.a.createElement(f.b,{exact:!0,path:"/doSoty"},r.a.createElement(qe,{userObj:a,isAndroid:n})),r.a.createElement(f.b,{exact:!0,path:"/doManga"},r.a.createElement(ht,{userObj:a,isAndroid:n})),r.a.createElement(f.b,{exact:!0,path:"/doSakugaBooru"},r.a.createElement(Ye,{userObj:a,isAndroid:n})),r.a.createElement(f.b,{exact:!0,path:"/special"},r.a.createElement(Ge,{userObj:a,isAndroid:n})),r.a.createElement(f.b,{exact:!0,path:"/special2"},r.a.createElement(bt,{userObj:a,isAndroid:n})),r.a.createElement(f.b,{exact:!0,path:"/specialcopy"},r.a.createElement(Ze,{userObj:a,isAndroid:n})),r.a.createElement(f.b,{exact:!0,path:"/adorka"},r.a.createElement(Ke,{userObj:a,isAndroid:n})),r.a.createElement(f.b,{exact:!0,path:"/lineofaction"},r.a.createElement($e,{userObj:a,isAndroid:n})),r.a.createElement(f.b,{exact:!0,path:"/twitter"},r.a.createElement(et,{userObj:a,isAndroid:n})),r.a.createElement(f.b,{exact:!0,path:"/chadesign"},r.a.createElement(ut,{userObj:a,isAndroid:n})),r.a.createElement(f.b,{exact:!0,path:"/chadesigndraw"},r.a.createElement(mt,{userObj:a,isAndroid:n})),r.a.createElement(f.b,{exact:!0,path:"/360"},r.a.createElement(ft,{userObj:a,isAndroid:n})),r.a.createElement(f.a,{from:"*",to:"/"})):r.a.createElement(r.a.Fragment,null,r.a.createElement(f.b,{exact:!0,path:"/"},r.a.createElement(le,null)),r.a.createElement(f.a,{from:"*",to:"/"}))))};var Et=function(){var e=Object(n.useState)(!1),t=Object(c.a)(e,2),a=t[0],l=t[1],o=Object(n.useState)(!1),i=Object(c.a)(o,2),u=i[0],m=i[1],d=Object(n.useState)(!1),f=Object(c.a)(d,2),g=f[0],p=f[1],h=Object(n.useState)(null),b=Object(c.a)(h,2),v=b[0],E=b[1],y=Object(n.useState)(0),w=Object(c.a)(y,2),O=w[0],j=w[1];return Object(n.useEffect)(function(){var e=window.navigator.userAgent.toLowerCase();console.log(e),e.indexOf("android")>-1&&(p(!0),console.log("android")),void 0==localStorage.getItem("penType")?localStorage.setItem("penType",parseInt(3)):j(parseInt(localStorage.getItem("penType"))),s.onAuthStateChanged(function(e){e?(m(!0),E(e)):m(!1),l(!0)})},[]),r.a.createElement(r.a.Fragment,null,a?r.a.createElement(vt,{isLoggedIn:u,userObj:v,isAndroid:g,penType:O}):"Inisializing..")};console.log(u),o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(Et,null)),document.getElementById("root"))},78:function(e,t,a){},90:function(e,t,a){e.exports=a.p+"static/media/soche.eef324de.png"},91:function(e,t,a){e.exports=a.p+"static/media/soche2.be9f6d7c.png"},92:function(e,t,a){e.exports=a.p+"static/media/myfile.54f3a8a7.csv"},97:function(e,t,a){e.exports=a.p+"static/media/soche3.81ca3da4.png"},99:function(e,t,a){e.exports=a(143)}},[[99,1,2]]]);
//# sourceMappingURL=main.4c3c3322.chunk.js.map